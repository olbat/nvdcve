{
  "id": "CVE-2015-5361",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-02-28T23:15:11.103",
  "lastModified": "2024-11-21T02:32:52.517",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Background For regular, unencrypted FTP traffic, the FTP ALG can inspect the unencrypted control channel and open related sessions for the FTP data channel. These related sessions (gates) are specific to source and destination IPs and ports of client and server. The design intent of the ftps-extensions option (which is disabled by default) is to provide similar functionality when the SRX secures the FTP/FTPS client. As the control channel is encrypted, the FTP ALG cannot inspect the port specific information and will open a wider TCP data channel (gate) from client IP to server IP on all destination TCP ports. In FTP/FTPS client environments to an enterprise network or the Internet, this is the desired behavior as it allows firewall policy to be written to FTP/FTPS servers on well-known control ports without using a policy with destination IP ANY and destination port ANY. Issue The ftps-extensions option is not intended or recommended where the SRX secures the FTPS server, as the wide data channel session (gate) will allow the FTPS client temporary access to all TCP ports on the FTPS server. The data session is associated to the control channel and will be closed when the control channel session closes. Depending on the configuration of the FTPS server, supporting load-balancer, and SRX inactivity-timeout values, the server/load-balancer and SRX may keep the control channel open for an extended period of time, allowing an FTPS client access for an equal duration.​ Note that the ftps-extensions option is not enabled by default."
    },
    {
      "lang": "es",
      "value": "Background por lo regular en, el trafico FTP no cifrado, el ALG FTP puede inspeccionar el canal de control no cifrado y abrir sesiones relacionadas para el canal de datos FTP. Estas sesiones relacionadas (gates) son específicas para las IPs de origen y destino y los puertos del cliente y del servidor. La intención del diseño de la opción ftps-extensions (que está desactivada por defecto) es proporcionar una funcionalidad similar cuando el SRX asegura el cliente FTP/FTPS. Como el canal de control está cifrado, el ALG de FTP no puede inspeccionar la información específica del puerto y abrirá un canal de datos TCP más amplio (puerta) desde la IP del cliente a la IP del servidor en todos los puertos TCP de destino. En entornos de clientes FTP/FTPS a una red empresarial o a Internet, este es el comportamiento deseado, ya que permite escribir la política del cortafuegos a los servidores FTP/FTPS en puertos de control conocidos sin utilizar una política con IP de destino ANY y puerto de destino ANY. Problema La opción ftps-extensions no está pensada ni recomendada cuando el SRX protege el servidor FTPS, ya que la sesión de canal de datos amplio (puerta) permitirá al cliente FTPS acceder temporalmente a todos los puertos TCP del servidor FTPS. La sesión de datos está asociada al canal de control y se cerrará cuando se cierre la sesión del canal de control. Dependiendo de la configuración del servidor FTPS, del balanceador de carga que lo soporta y de los valores de tiempo de espera de inactividad del SRX, el servidor/balanceador de carga y el SRX pueden mantener el canal de control abierto durante un periodo de tiempo prolongado, permitiendo el acceso de un cliente FTPS durante un periodo igual. Nota la opción ftps-extensions no está habilitada por defecto"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve@mitre.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 2.5
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 2.5
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
          "baseScore": 5.8,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-326"
        }
      ]
    }
  ],
  "configurations": [
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:-:*:*:*:*:*:*",
              "matchCriteriaId": "86141A33-344E-4152-8B76-2DB383954F02"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d10:*:*:*:*:*:*",
              "matchCriteriaId": "AC405A12-112D-4C9D-90DA-6ED484109793"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d15:*:*:*:*:*:*",
              "matchCriteriaId": "3FC42F2D-7593-4DBE-AE89-A6B78E7F9089"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d20:*:*:*:*:*:*",
              "matchCriteriaId": "731A6469-3DE0-491A-BCC5-7642FB347ACE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d25:*:*:*:*:*:*",
              "matchCriteriaId": "D12A8119-3E59-4062-9A04-1F6EA48B78E9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d30:*:*:*:*:*:*",
              "matchCriteriaId": "E8B33B80-3189-4412-BFE0-359E755AB07A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d35:*:*:*:*:*:*",
              "matchCriteriaId": "C0E8F87E-DEB2-4849-ABB5-75A67CFD2D39"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d40:*:*:*:*:*:*",
              "matchCriteriaId": "BDE231CE-0D93-4293-8720-4CCEE2EA651E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d45:*:*:*:*:*:*",
              "matchCriteriaId": "74253C79-C13F-4FBD-B173-8E87A62845DD"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x44:d50:*:*:*:*:*:*",
              "matchCriteriaId": "96831D1B-881B-4B18-A330-9E32A0D21148"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:-:*:*:*:*:*:*",
              "matchCriteriaId": "92F31F7F-02E0-4E63-A600-DF8AB4E3BAA3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d10:*:*:*:*:*:*",
              "matchCriteriaId": "A71742CF-50B1-44BB-AB7B-27E5DCC9CF70"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d15:*:*:*:*:*:*",
              "matchCriteriaId": "4FD4237A-C257-4D8A-ABC4-9B2160530A4E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d20:*:*:*:*:*:*",
              "matchCriteriaId": "5A449C87-C5C3-48FE-9E46-64ED5DD5F193"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d25:*:*:*:*:*:*",
              "matchCriteriaId": "F4B6215F-76BF-473F-B325-0975B0EB101E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d30:*:*:*:*:*:*",
              "matchCriteriaId": "A1C4A10C-49A3-4103-9E56-F881113BC5D7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46:d35:*:*:*:*:*:*",
              "matchCriteriaId": "50E7FD07-A309-48EC-A520-C7F0FA35865C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x46-d10:*:*:*:*:*:*:*",
              "matchCriteriaId": "A6390879-1AB9-4B11-A8A8-6B914F52EB83"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x47:-:*:*:*:*:*:*",
              "matchCriteriaId": "ABBEDB3F-5FD1-4290-A80A-7EAD9B9C38C4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x47:d10:*:*:*:*:*:*",
              "matchCriteriaId": "181C0D30-4476-48EE-A4A4-3B2461F4AC20"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x47:d15:*:*:*:*:*:*",
              "matchCriteriaId": "63F559A2-2744-4771-9420-C70AA87496A2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.1x47:d20:*:*:*:*:*:*",
              "matchCriteriaId": "040A6307-236E-4FAA-9A74-676F1DB0CF17"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.3x48:-:*:*:*:*:*:*",
              "matchCriteriaId": "AC1FED64-8725-4978-9EBF-E3CD8EF338E4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.3x48:d10:*:*:*:*:*:*",
              "matchCriteriaId": "4B7066A4-CD05-4E1A-89E8-71B4CB92CFF3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:12.3x48:d15:*:*:*:*:*:*",
              "matchCriteriaId": "A4AC2E1E-74FB-4DA3-8292-B2079F83FF54"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:15.1x49:-:*:*:*:*:*:*",
              "matchCriteriaId": "27A6BF09-ABBF-4126-ADD6-B174937F8554"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx100:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "561C1113-3D59-4DD9-ADA7-3C9ECC4632EC"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx110:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "78C6D8A0-92D3-4FD3-BCC1-CC7C87B76317"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx1400:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "927EAB8B-EC3B-4B12-85B9-5517EBA49A30"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx1500:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "2CEBF85C-736A-4E7D-956A-3E8210D4F70B"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx210:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "CD647C15-A686-4C8F-A766-BC29404C0FED"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx220:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "45AB1622-1AED-4CD7-98F1-67779CDFC321"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx240:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "89276D88-3B8D-4168-A2CD-0920297485F2"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx240h2:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "E020556B-693F-4963-BA43-3164AB50FA49"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx300:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "BB5AB24B-2B43-43DD-AE10-F758B4B19F2A"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx320:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "80F9DC32-5ADF-4430-B1A6-357D0B29DB78"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx340:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "8B82D4C4-7A65-409A-926F-33C054DCBFBA"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx3400:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "746C3882-2A5B-4215-B259-EB1FD60C513D"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx345:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "CE535749-F4CE-4FFA-B23D-BF09C92481E5"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx3600:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "DDE64EC0-7E42-43AF-A8FA-1A233BD3E3BC"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx380:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "2305DA9D-E6BA-48F4-80CF-9E2DE7661B2F"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx4000:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "06A03463-6B1D-4DBA-9E89-CAD5E899B98B"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx4100:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "3AA8999C-8AE4-416F-BA2A-B1A21F33B4D7"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx4200:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "CCC5F6F5-4347-49D3-909A-27A3A96D36C9"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx4600:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "56BA6B86-D3F4-4496-AE46-AC513C6560FA"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx5000:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "5ABA347C-3EF3-4F75-B4D1-54590A57C2BC"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx5400:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "2FDDC897-747F-44DD-9599-7266F9B5B7B1"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx550:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "62FC145A-D477-4C86-89E7-F70F52773801"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx550_hm:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "06685D0E-A075-49A5-9EF4-34F0F795C8C6"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx550m:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "52F0B735-8C49-4B08-950A-296C9CDE43CA"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx5600:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "68CA098D-CBE4-4E62-9EC0-43E1B6098710"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx5800:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "66F474D4-79B6-4525-983C-9A9011BD958B"
            },
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:juniper:srx650:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "8AA424D4-4DBF-4E8C-96B8-E37741B5403E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://kb.juniper.net/JSA10706",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://kb.juniper.net/JSA10706",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}