{
  "id": "CVE-2022-31122",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-10-18T10:15:10.547",
  "lastModified": "2024-11-21T07:03:56.460",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Wire is an encrypted communication and collaboration platform. Versions prior to 2022-07-12/Chart 4.19.0 are subject to Token Recipient Confusion. If an attacker has certain details of SAML IdP metadata, and configures their own SAML on the same backend, the attacker can delete all SAML authenticated accounts of a targeted team, Authenticate as a user of the attacked team and create arbitrary accounts in the context of the team if it is not managed by SCIM. This issue is fixed in wire-server 2022-07-12 and is already deployed on all Wire managed services. On-premise instances of wire-server need to be updated to 2022-07-12/Chart 4.19.0, so that their backends are no longer affected. As a workaround, the risk of an attack can be reduced by disabling SAML configuration for teams (galley.config.settings.featureFlags.sso). Helm overrides are located in `values/wire-server/values.yaml` Note that the ability to configure SAML SSO as a team is disabled by default for on-premise installations."
    },
    {
      "lang": "es",
      "value": "Wire es una plataforma de comunicación y colaboración cifrada. Las versiones anteriores a 2022-07-12/Chart 4.19.0 están sujetas a una confusión del destinatario del token. Si un atacante presenta determinados detalles de los metadatos de SAML IdP, y configura su propio SAML en el mismo backend, el atacante puede eliminar todas las cuentas autenticadas por SAML de un equipo objetivo, autenticarse como usuario del equipo atacado y crear cuentas arbitrarias en el contexto del equipo si no está gestionado por SCIM. Este problema ha sido corregido en wire-server 2022-07-12 y ya está implantado en todos los servicios administrados por Wire. Las instancias locales de wire-server deben actualizarse a 2022-07-12/Chart 4.19.0, de modo que sus backends ya no estén afectados. Como mitigación, puede reducirse el riesgo de ataque al deshabilitar la configuración de SAML para los equipos (galley.config.settings.featureFlags.sso). Las anulaciones de Helm son encontradas en \"values/wire-server/values.yaml\" Tenga en cuenta que la capacidad de configurar SAML SSO como equipo está deshabilitada por defecto para las instalaciones locales"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        },
        {
          "lang": "en",
          "value": "CWE-1270"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wire:wire_server:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2022-07-12",
              "matchCriteriaId": "E79DDF1F-A8D2-4BDC-BD5A-DC17E0217D2B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/wireapp/wire-server/security/advisories/GHSA-gq27-gmgq-fmxw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-server/security/advisories/GHSA-gq27-gmgq-fmxw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}