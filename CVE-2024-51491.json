{
  "id": "CVE-2024-51491",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2025-01-13T22:15:13.843",
  "lastModified": "2025-09-05T15:42:25.137",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "notion-go is a collection of libraries for supporting sign and verify OCI artifacts. Based on Notary Project specifications. The issue was identified during Quarkslab's security audit on the Certificate Revocation List (CRL) based revocation check feature.\nAfter retrieving the CRL, notation-go attempts to update the CRL cache using the os.Rename method. However, this operation may fail due to operating system-specific limitations, particularly when the source and destination paths are on different mount points. This failure could lead to an unexpected program termination. In method `crl.(*FileCache).Set`, a temporary file is created in the OS dedicated area (like /tmp for, usually, Linux/Unix). The file is written and then it is tried to move it to the dedicated `notation` cache directory thanks `os.Rename`. As specified in Go documentation, OS specific restriction may apply. When used with Linux OS, it is relying on rename syscall from the libc and as per the documentation, moving a file to a different mountpoint raises an EXDEV error, interpreted as Cross device link not permitted error. Some Linux distribution, like RedHat use a dedicated filesystem (tmpfs), mounted on a specific mountpoint (usually /tmp) for temporary files. When using such OS, revocation check based on CRL will repeatedly crash notation. As a result the signature verification process is aborted as process crashes. This issue has been addressed in version 1.3.0-rc.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "notion-go es una colección de Librerías para respaldar la firma y verificación de artefactos OCI. Basado en las especificaciones del Proyecto Notary. El problema se identificó durante la auditoría de seguridad de Quarkslab sobre la función de verificación de revocación basada en la Lista de revocación de certificados (CRL). Después de recuperar la CRL, notation-go intenta actualizar la caché de CRL utilizando el método os.Rename. Sin embargo, esta operación puede fallar debido a limitaciones específicas de sistema operativo, en particular cuando las rutas de origen y destino están en diferentes puntos de montaje. Este fallo podría provocar una finalización inesperada del programa. En el método `crl.(*FileCache).Set`, se crea un archivo temporal en el área dedicada del SO (como /tmp para, por lo general, Linux/Unix). El archivo se escribe y luego se intenta moverlo al directorio de caché dedicado de `notation` gracias a `os.Rename`. Como se especifica en la documentación de Go, pueden aplicarse restricciones específicas del SO. Cuando se utiliza con el sistema operativo Linux, se basa en la llamada al sistema de cambio de nombre de la libc y, según la documentación, mover un archivo a un punto de montaje diferente genera un error EXDEV, que se interpreta como un error de vínculo entre dispositivos no permitido. Algunas distribuciones de Linux, como RedHat, utilizan un sistema de archivos dedicado (tmpfs), montado en un punto de montaje específico (normalmente /tmp) para archivos temporales. Cuando se utiliza dicho sistema operativo, la comprobación de revocación basada en CRL bloqueará repetidamente la notación. Como resultado, el proceso de verificación de firma se cancela a medida que el proceso se bloquea. Este problema se ha solucionado en la versión 1.3.0-rc.2 y se recomienda a todos los usuarios que actualicen. No se conocen Workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L",
          "baseScore": 3.3,
          "baseSeverity": "LOW",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-703"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:notaryproject:notation-go:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.3.0",
              "matchCriteriaId": "CDC85969-B9CC-4ADC-BBAD-26CE0ACD4205"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:notaryproject:notation-go:1.3.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "D33ED917-52DC-4DAD-A91A-94B496A0036D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/notaryproject/notation-go/commit/3c3302258ad510fbca2f8a73731569d91f07d196",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/notaryproject/notation-go/security/advisories/GHSA-qjh3-4j3h-vmwp",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://man7.org/linux/man-pages/man2/rename.2.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/notaryproject/notation-go/security/advisories/GHSA-qjh3-4j3h-vmwp",
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}