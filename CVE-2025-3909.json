{
  "id": "CVE-2025-3909",
  "sourceIdentifier": "security@mozilla.org",
  "published": "2025-05-14T17:15:48.660",
  "lastModified": "2025-06-05T14:26:42.720",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Thunderbird's handling of the X-Mozilla-External-Attachment-URL header can be exploited to execute JavaScript in the file:/// context. By crafting a nested email attachment (message/rfc822) and setting its content type to application/pdf, Thunderbird may incorrectly render it as HTML when opened, allowing the embedded JavaScript to run without requiring a file download. This behavior relies on Thunderbird auto-saving the attachment to /tmp and linking to it via the file:/// protocol, potentially enabling JavaScript execution as part of the HTML. This vulnerability affects Thunderbird < 128.10.1 and Thunderbird < 138.0.1."
    },
    {
      "lang": "es",
      "value": "La gestión que Thunderbird hace del encabezado X-Mozilla-External-Attachment-URL puede explotarse para ejecutar JavaScript en el contexto file:///. Al manipular un archivo adjunto de correo electrónico anidado (message/rfc822) y configurar su tipo de contenido como application/pdf, Thunderbird puede representarlo incorrectamente como HTML al abrirlo, lo que permite que el JavaScript incrustado se ejecute sin necesidad de descargar el archivo. Este comportamiento se basa en que Thunderbird guarda automáticamente el archivo adjunto en /tmp y lo enlaza mediante el protocolo file:///, lo que podría permitir la ejecución de JavaScript como parte del HTML. Esta vulnerabilidad afecta a Thunderbird versiones anteriores a la 128.10.1 y a la 138.0.1."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 2.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-290"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mozilla:thunderbird:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "128.10.1",
              "matchCriteriaId": "82B93B43-AAD0-4F6F-8022-9842E39D73D6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mozilla:thunderbird:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "129.0",
              "versionEndExcluding": "138.0.1",
              "matchCriteriaId": "4AFE1A41-57DD-4532-9F3F-D3E9705868BA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1958376",
      "source": "security@mozilla.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://www.mozilla.org/security/advisories/mfsa2025-34/",
      "source": "security@mozilla.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.mozilla.org/security/advisories/mfsa2025-35/",
      "source": "security@mozilla.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}