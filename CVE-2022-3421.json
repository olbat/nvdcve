{
  "id": "CVE-2022-3421",
  "sourceIdentifier": "cve-coordination@google.com",
  "published": "2022-10-17T20:15:09.853",
  "lastModified": "2024-11-21T07:19:28.817",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "An attacker can pre-create the `/Applications/Google\\ Drive.app/Contents/MacOS` directory which is expected to be owned by root to be owned by a non-root user. When the Drive for Desktop installer is run for the first time, it will place a binary in that directory with execute permissions and set its setuid bit. Since the attacker owns the directory, the attacker can replace the binary with a symlink, causing the installer to set the setuid bit on the symlink. When the symlink is executed, it will run with root permissions. We recommend upgrading past version 64.0"
    },
    {
      "lang": "es",
      "value": "Un atacante puede pre crear el directorio \"/Applications/Google\\ Drive.app/Contents/MacOS\" que es esperado que sea propiedad de root para que sea propiedad de un usuario no root. Cuando el instalador de Drive for Desktop sea ejecutado por primera vez, colocará un binario en ese directorio con permisos de ejecución y establecerá su bit setuid. Dado que el atacante es el propietario del directorio, puede sustituir el binario por un enlace simbólico, causando que el instalador establezca el bit setuid en el enlace simbólico. Cuando el enlace simbólico sea ejecutado, lo hará con permisos de root. Recomendamos actualizar la versión anterior 64.0"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve-coordination@google.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:L",
          "baseScore": 5.6,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 1.3,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 7.3,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.3,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve-coordination@google.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-264"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    }
  ],
  "configurations": [
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:google:drive:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "64.0",
              "matchCriteriaId": "00B95F29-09A2-491E-921D-4E93A03D84E0"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:apple:macos:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "387021A0-AF36-463C-A605-32EA7DAC172E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://support.google.com/a/answer/7577057?hl=en",
      "source": "cve-coordination@google.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://support.google.com/a/answer/7577057?hl=en",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ]
}