{
  "id": "CVE-2024-45308",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-09-02T18:15:37.150",
  "lastModified": "2025-09-22T17:27:13.330",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`."
    },
    {
      "lang": "es",
      "value": "HedgeDoc es una aplicación de notas de código abierto, en tiempo real, colaborativa y con formato Markdown. Al utilizar HedgeDoc 1 con MySQL o MariaDB, es posible crear notas con un alias que coincida con el ID de las notas existentes. A partir de ese momento, ya no se puede acceder a la nota existente afectada y la nueva la oculta de manera efectiva. Cuando se habilita la función freeURL (estableciendo la opción de configuración `allowFreeURL` o la variable de entorno `CMD_ALLOW_FREEURL` en `true`), cualquier usuario con los permisos adecuados puede crear una nota con un alias arbitrario, por ejemplo, accediendo a ella en el navegador. Cuando se utiliza MySQL o MariaDB, es posible crear una nueva nota con un alias que coincida con el ID en minúsculas de una nota diferente. Luego, HedgeDoc siempre presenta la nueva nota a los usuarios, ya que estas bases de datos realizan una comparación sin distinguir entre mayúsculas y minúsculas y el alias en minúsculas se encuentra primero. Este problema solo afecta a las instancias de HedgeDoc que utilizan MySQL o MariaDB. Según la configuración de permisos de la instancia de HedgeDoc, el problema puede ser explotado solo por usuarios que hayan iniciado sesión o por todos los usuarios (incluidos los que no hayan iniciado sesión). El exploit requiere el conocimiento del ID de la nota de destino. Los atacantes podrían usar este problema para presentar una copia manipulada de la nota original al usuario, por ejemplo, reemplazando los enlaces con enlaces maliciosos. Los atacantes también pueden usar este problema para evitar el acceso a la nota original, lo que provoca una denegación de servicio. No se pierden datos, ya que el contenido original de las notas afectadas aún está presente en la base de datos. Se recomienda a los usuarios que actualicen a la versión 1.10.0 que soluciona este problema. Los usuarios que no puedan actualizar pueden desactivar el modo freeURL que evita la explotación de este problema. El impacto también se puede limitar restringiendo la creación de notas freeURL a usuarios confiables que hayan iniciado sesión habilitando `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:L",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:L",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 4.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-1289"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.10.0",
              "matchCriteriaId": "ADF5DD13-F127-4915-9A39-5C5D0137DBA7"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/hedgedoc/hedgedoc/commit/380587b7fd65bc1eb71eef51a3aab324f9877650",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-pjf2-269h-cx7p",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory",
        "Mitigation"
      ]
    }
  ]
}