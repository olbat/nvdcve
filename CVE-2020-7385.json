{
  "id": "CVE-2020-7385",
  "sourceIdentifier": "cve@rapid7.com",
  "published": "2021-04-23T16:15:08.440",
  "lastModified": "2024-11-21T05:37:08.730",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "By launching the drb_remote_codeexec exploit, a Metasploit Framework user will inadvertently expose Metasploit to the same deserialization issue that is exploited by that module, due to the reliance on the vulnerable Distributed Ruby class functions. Since Metasploit Framework typically runs with elevated privileges, this can lead to a system compromise on the Metasploit workstation. Note that an attacker would have to lie in wait and entice the Metasploit user to run the affected module against a malicious endpoint in a \"hack-back\" type of attack. Metasploit is only vulnerable when the drb_remote_codeexec module is running. In most cases, this cannot happen automatically."
    },
    {
      "lang": "es",
      "value": "Al lanzar el exploit drb_remote_codeexec, un usuario de Metasploit Framework expondrá inadvertidamente un Metasploit al mismo problema de deserialización que explota ese módulo, debido a la dependencia de las funciones vulnerables de la clase Distributed Ruby.&#xa0;Dado que Metasploit Framework generalmente se ejecuta con privilegios elevados, esto puede conllevar a un compromiso del sistema en la estación de trabajo Metasploit.&#xa0;Tome en cuenta a un atacante tendría que esperar y convencer al usuario de Metasploit para que ejecute el módulo afectado contra un endpoint malicioso en un tipo de ataque de \"hack-back\".&#xa0;Metasploit solo es vulnerable cuando se está ejecutando el módulo drb_remote_codeexec.&#xa0;En la mayoría de los casos, esto no puede suceder automáticamente"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve@rapid7.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
          "baseScore": 6.8,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve@rapid7.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-502"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-502"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:rapid7:metasploit:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "4.19.0",
              "matchCriteriaId": "EFF91D8C-A041-42A6-9732-7A03C7DD14B8"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/rapid7/metasploit-framework/pull/14300",
      "source": "cve@rapid7.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rapid7/metasploit-framework/pull/14335",
      "source": "cve@rapid7.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://help.rapid7.com/metasploit/release-notes/archive/2020/10/",
      "source": "cve@rapid7.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/rapid7/metasploit-framework/pull/14300",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rapid7/metasploit-framework/pull/14335",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://help.rapid7.com/metasploit/release-notes/archive/2020/10/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ]
}