{
  "id": "CVE-2017-5218",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-02-02T07:59:00.130",
  "lastModified": "2025-04-20T01:37:25.860",
  "vulnStatus": "Deferred",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A SQL Injection issue was discovered in SageCRM 7.x before 7.3 SP3. The AP_DocumentUI.asp web resource includes Utilityfuncs.js when the file is opened or viewed. This file crafts a SQL statement to identify the database that is to be in use with the current user's session. The database variable can be populated from the URL, and when supplied non-expected characters, can be manipulated to obtain access to the underlying database. The /CRM/CustomPages/ACCPAC/AP_DocumentUI.asp?SID=<VALID-SID>&database=1';WAITFOR DELAY '0:0:5'-- URI is a Proof of Concept."
    },
    {
      "lang": "es",
      "value": "Se descubri贸 un problema de inyecci贸n de SQL en SageCRM 7.x en versiones anteriores a 7.3 SP3. El recurso Web AP_DocumentUI.asp incluye Utilityfuncs.js cuando se abre o se ve el archivo. Este archivo crea una instrucci贸n SQL para identificar la base de datos que se va a utilizar con la sesi贸n del usuario actual. La variable de base de datos se puede rellenar desde la URL y, cuando se proporcionan caracteres no esperados, se pueden manipular para obtener acceso a la base de datos subyacente. El /CRM/CustomPages/ACCPAC/AP_DocumentUI.asp?SID=&database=1';WAITFOR DELAY '0: 0: 5' - URI es una prueba de concepto."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "baseScore": 6.5,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "D07474DA-DDB9-4CC8-BF2D-256C6DD86C56"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "56402F12-04E0-407F-9DED-AEE6AA148756"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "5E13E266-B6F9-476A-8728-C97AB4493703"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "6DCCCD34-465A-4D2A-AB74-07E368CF98DC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:sp1:*:*:*:*:*:*",
              "matchCriteriaId": "D50B7DB0-52AB-46EC-AD32-375A5CCE3416"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:sp2:*:*:*:*:*:*",
              "matchCriteriaId": "85CD71BD-9F51-4FE3-8C66-706967996C54"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://research.aurainfosec.io/disclosures/sagecrm-CVE-2017-5219-CVE-2017-5218/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95968",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://research.aurainfosec.io/disclosures/sagecrm-CVE-2017-5219-CVE-2017-5218/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95968",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ]
}