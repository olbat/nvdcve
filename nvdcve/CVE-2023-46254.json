{
  "id": "CVE-2023-46254",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-11-06T19:15:09.230",
  "lastModified": "2024-11-21T08:28:10.743",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "capsule-proxy is a reverse proxy for Capsule kubernetes multi-tenancy framework. A bug in the RoleBinding reflector used by `capsule-proxy` gives ServiceAccount tenant owners the right to list Namespaces of other tenants backed by the same owner kind and name. For example consider two tenants `solar` and `wind`. Tenant `solar`, owned by a ServiceAccount named `tenant-owner` in the Namespace `solar`. Tenant `wind`, owned by a ServiceAccount named `tenant-owner` in the Namespace `wind`. The Tenant owner `solar` would be able to list the namespaces of the Tenant `wind` and vice-versa, although this is not correct. The bug introduces an exfiltration vulnerability since allows the listing of Namespace resources of other Tenants, although just in some specific conditions: 1. `capsule-proxy` runs with the `--disable-caching=false` (default value: `false`) and 2. Tenant owners are ServiceAccount, with the same resource name, but in different Namespaces. This vulnerability doesn't allow any privilege escalation on the outer tenant Namespace-scoped resources, since the Kubernetes RBAC is enforcing this. This issue has been addressed in version 0.4.5. Users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Capsule-proxy es un proxy inverso para el framework multi-tenancy de Capsule Kubernetes. Un bug en el reflector RoleBinding utilizado por `capsule-proxy` otorga a los propietarios de tenants de ServiceAccount el derecho de enumerar espacios de nombres de otros tenants respaldados por el mismo tipo y nombre de propietario. Por ejemplo, considere dos tenant \"\"\"\"solar\"\"\"\" y \"\"\"\"wind\"\"\"\". El tenant \"\"\"\"solar\"\"\"\", propiedad de una cuenta de servicio denominada \"\"\"\"tenant-owner\"\"\"\" en el espacio de nombres \"\"\"\"solar\"\"\"\". El tenant \"\"\"\"wind\"\"\"\", propiedad de una cuenta de servicio denominada \"\"\"\"tenant-owner\"\"\"\" en el espacio de nombres \"\"\"\"wind\"\"\"\". El propietario del inquilino \"\"\"\"solar\"\"\"\" podría enumerar los espacios de nombres del inquilino \"\"\"\"wind\"\"\"\" y viceversa, aunque esto no es correcto. El error introduce una vulnerabilidad de exfiltración ya que permite enumerar los recursos del espacio de nombres de otros tenant, aunque solo en algunas condiciones específicas:\n1. `capsule-proxy` se ejecuta con `--disable-caching=false` (valor predeterminado: `false` ) y \n2. Los propietarios de los tenant son ServiceAccount, con el mismo nombre de recurso, pero en diferentes espacios de nombres.\nEsta vulnerabilidad no permite ninguna escalada de privilegios en los recursos con ámbito de espacio de nombres del inquilino externo, ya que Kubernetes RBAC lo está aplicando. \nEste problema se solucionó en la versión 0.4.5. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clastix:capsule:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.4.5",
              "matchCriteriaId": "0A4C4DC0-2E0E-4FA7-92DA-30E31FC51CC9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clastix:capsule-proxy:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.4.5",
              "matchCriteriaId": "ECFAD73A-15CD-473C-8D55-645E5E5E395F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}