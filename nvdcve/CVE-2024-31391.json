{
  "id": "CVE-2024-31391",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-04-12T15:15:26.157",
  "lastModified": "2025-06-17T20:58:50.363",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Insertion of Sensitive Information into Log File vulnerability in the Apache Solr Operator.\n\nThis issue affects all versions of the Apache Solr Operator from 0.3.0 through 0.8.0.\n\nWhen asked to bootstrap Solr security, the operator will enable basic authentication and create several accounts for accessing Solr: including the \"solr\" and \"admin\" accounts for use by end-users, and a \"k8s-oper\" account which the operator uses for its own requests to Solr.\nOne common source of these operator requests is healthchecks: liveness, readiness, and startup probes are all used to determine Solr's health and ability to receive traffic.\nBy default, the operator configures the Solr APIs used for these probes to be exempt from authentication, but users may specifically request that authentication be required on probe endpoints as well.\nWhenever one of these probes would fail, if authentication was in use, the Solr Operator would create a Kubernetes \"event\" containing the username and password of the \"k8s-oper\" account.\n\nWithin the affected version range, this vulnerability affects any solrcloud resource which (1) bootstrapped security through use of the `.solrOptions.security.authenticationType=basic` option, and (2) required authentication be used on probes by setting `.solrOptions.security.probesRequireAuth=true`.\n\nUsers are recommended to upgrade to Solr Operator version 0.8.1, which fixes this issue by ensuring that probes no longer print the credentials used for Solr requests.  Users may also mitigate the vulnerability by disabling authentication on their healthcheck probes using the setting `.solrOptions.security.probesRequireAuth=false`."
    },
    {
      "lang": "es",
      "value": "Vulnerabilidad de inserción de información confidencial en un archivo de registro en el operador Apache Solr. Este problema afecta a todas las versiones del operador Apache Solr desde la 0.3.0 hasta la 0.8.0. Cuando se le solicite iniciar la seguridad de Solr, el operador habilitará la autenticación básica y creará varias cuentas para acceder a Solr: incluidas las cuentas \"solr\" y \"admin\" para uso de los usuarios finales, y una cuenta \"k8s-oper\" que utiliza el operador. para sus propias solicitudes a Solr. Una fuente común de estas solicitudes de operadores son las comprobaciones de estado: las sondas de actividad, preparación y arranque se utilizan para determinar el estado de Solr y su capacidad para recibir tráfico. De forma predeterminada, el operador configura las API de Solr utilizadas para estas sondas para que estén exentas de autenticación, pero los usuarios pueden solicitar específicamente que también se requiera autenticación en los endpoints de las sondas. Cada vez que una de estas sondas fallaba, si se estaba utilizando la autenticación, el operador Solr crearía un \"evento\" de Kubernetes que contenía el nombre de usuario y la contraseña de la cuenta \"k8s-oper\". Dentro del rango de versiones afectadas, esta vulnerabilidad afecta a cualquier recurso de solrcloud que (1) haya iniciado la seguridad mediante el uso de la opción `.solrOptions.security.authenticationType=basic` y (2) requiera que se use autenticación en las sondas configurando `.solrOptions. seguridad.probesRequireAuth=true`. Se recomienda a los usuarios actualizar a Solr Operador versión 0.8.1, que soluciona este problema al garantizar que las sondas ya no impriman las credenciales utilizadas para las solicitudes de Solr. Los usuarios también pueden mitigar la vulnerabilidad deshabilitando la autenticación en sus sondas de verificación de estado usando la configuración `.solrOptions.security.probesRequireAuth=false`."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-532"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:solr_operator:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.3.0",
              "versionEndExcluding": "0.8.1",
              "matchCriteriaId": "09C3A433-6776-4F77-B921-94454D521A7E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/12/7",
      "source": "security@apache.org",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/w7011s78lzywzwyszvy4d8zm99ybt8c7",
      "source": "security@apache.org",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/12/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/w7011s78lzywzwyszvy4d8zm99ybt8c7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    }
  ]
}