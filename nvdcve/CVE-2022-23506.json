{
  "id": "CVE-2022-23506",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-01-03T21:15:11.393",
  "lastModified": "2024-11-21T06:48:42.373",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Spinnaker is an open source, multi-cloud continuous delivery platform for releasing software changes, and Spinnaker's Rosco microservice produces machine images. Rosco prior to versions 1.29.2, 1.28.4, and 1.27.3 does not property mask secrets generated via packer builds.  This can lead to exposure of sensitive AWS credentials in packer log files. Versions 1.29.2, 1.28.4, and 1.27.3 of Rosco contain fixes for this issue.\n\nA workaround is available. It's recommended to use short lived credentials via role assumption and IAM profiles. Additionally, credentials can be set in `/home/spinnaker/.aws/credentials` and `/home/spinnaker/.aws/config` as a volume mount for Rosco pods vs. setting credentials in roscos bake config properties. Last even with those it's recommend to use IAM Roles vs. long lived credentials. This drastically mitigates the risk of credentials exposure. If users have used static credentials, it's recommended to purge any bake logs for AWS, evaluate whether AWS_ACCESS_KEY, SECRET_KEY and/or other sensitive data has been introduced in log files and bake job logs. Then, rotate these credentials and evaluate potential improper use of those credentials."
    },
    {
      "lang": "es",
      "value": "Spinnaker es una plataforma de entrega continua multicloud de código abierto para publicar cambios de software, y el microservicio Rosco de Spinnaker produce imágenes de máquinas. Rosco anterior a las versiones 1.29.2, 1.28.4 y 1.27.3 no enmascara las propiedades de los secretos generados a través de compilaciones de empaquetadores. Esto puede provocar la exposición de credenciales confidenciales de AWS en los archivos de registro de empaquetadores. Las versiones 1.29.2, 1.28.4 y 1.27.3 de Rosco contienen correcciones para este problema. Hay un workaround disponible. Se recomienda usar credenciales de corta duración a través de la asunción de roles y perfiles de IAM. Además, las credenciales se pueden configurar en `/home/spinnaker/.aws/credentials` y `/home/spinnaker/.aws/config` como un montaje de volumen para pods de Rosco en lugar de configurar las credenciales en las propiedades de configuración de horneado de Rosco. Por último, incluso con eso, se recomienda usar roles de IAM en lugar de credenciales de larga duración. Esto mitiga drásticamente el riesgo de exposición de credenciales. Si los usuarios han utilizado credenciales estáticas, se recomienda eliminar todos los registros de Bake para AWS, evaluar si se han introducido AWS_ACCESS_KEY, SECRET_KEY u otros datos confidenciales en los archivos de registro y los registros de trabajos de Bake. Luego, rotar estas credenciales y evaluar el posible uso indebido de esas credenciales."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-532"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:spinnaker:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.27.3",
              "matchCriteriaId": "11A4C584-749D-493E-9041-38A81618EDFA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:spinnaker:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.28.0",
              "versionEndExcluding": "1.28.4",
              "matchCriteriaId": "296E0693-5B68-40A5-9BFE-1055BAFD6369"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:spinnaker:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.29.0",
              "versionEndExcluding": "1.29.2",
              "matchCriteriaId": "0D93FCCE-98CC-4439-A0F7-2475764FE515"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/spinnaker/rosco/commit/e80cfaa1abfb3a0e9026d45d6027291bfb815daf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/spinnaker/spinnaker/security/advisories/GHSA-2233-cqj8-j2q5",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/spinnaker/rosco/commit/e80cfaa1abfb3a0e9026d45d6027291bfb815daf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/spinnaker/spinnaker/security/advisories/GHSA-2233-cqj8-j2q5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}