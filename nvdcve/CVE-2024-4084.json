{
  "id": "CVE-2024-4084",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-06-05T00:15:09.840",
  "lastModified": "2024-11-21T09:42:09.817",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A Server-Side Request Forgery (SSRF) vulnerability exists in the latest version of mintplex-labs/anything-llm, allowing attackers to bypass the official fix intended to restrict access to intranet IP addresses and protocols. Despite efforts to filter out intranet IP addresses starting with 192, 172, 10, and 127 through regular expressions and limit access protocols to HTTP and HTTPS, attackers can still bypass these restrictions using alternative representations of IP addresses and accessing other ports running on localhost. This vulnerability enables attackers to access any asset on the internal network, attack web services on the internal network, scan hosts on the internal network, and potentially access AWS metadata endpoints. The vulnerability is due to insufficient validation of user-supplied URLs, which can be exploited to perform SSRF attacks."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de server-side request forgery (SSRF) en la última versión de mintplex-labs/anything-llm, lo que permite a los atacantes eludir la solución oficial destinada a restringir el acceso a las direcciones IP y protocolos de la intranet. A pesar de los esfuerzos por filtrar las direcciones IP de la intranet que comienzan con 192, 172, 10 y 127 mediante expresiones regulares y limitar los protocolos de acceso a HTTP y HTTPS, los atacantes aún pueden eludir estas restricciones utilizando representaciones alternativas de direcciones IP y accediendo a otros puertos que se ejecutan en localhost. Esta vulnerabilidad permite a los atacantes acceder a cualquier activo en la red interna, atacar servicios web en la red interna, escanear hosts en la red interna y potencialmente acceder a puntos finales de metadatos de AWS. La vulnerabilidad se debe a una validación insuficiente de las URL proporcionadas por el usuario, que pueden explotarse para realizar ataques SSRF."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "baseScore": 7.7,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mintplexlabs:anythingllm:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.5.4",
              "matchCriteriaId": "2150524B-91AA-4171-B8B0-B8207DB9C243"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://huntr.com/bounties/bf44517e-a07d-4f54-89b4-3b05fca2a008",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.com/bounties/bf44517e-a07d-4f54-89b4-3b05fca2a008",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}