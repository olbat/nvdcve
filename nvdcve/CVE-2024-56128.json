{
  "id": "CVE-2024-56128",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-12-18T14:15:23.277",
  "lastModified": "2025-06-20T18:13:13.550",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Incorrect Implementation of Authentication Algorithm in Apache Kafka's SCRAM implementation.\n\nIssue Summary:\nApache Kafka's implementation of the Salted Challenge Response Authentication Mechanism (SCRAM) did not fully adhere to the requirements of RFC 5802 [1].\nSpecifically, as per RFC 5802, the server must verify that the nonce sent by the client in the second message matches the nonce sent by the server in its first message.\nHowever, Kafka's SCRAM implementation did not perform this validation.\n\nImpact:\nThis vulnerability is exploitable only when an attacker has plaintext access to the SCRAM authentication exchange. However, the usage of SCRAM over plaintext is strongly\ndiscouraged as it is considered an insecure practice [2]. Apache Kafka recommends deploying SCRAM exclusively with TLS encryption to protect SCRAM exchanges from interception [3].\nDeployments using SCRAM with TLS are not affected by this issue.\n\nHow to Detect If You Are Impacted:\nIf your deployment uses SCRAM authentication over plaintext communication channels (without TLS encryption), you are likely impacted.\nTo check if TLS is enabled, review your server.properties configuration file for listeners property. If you have SASL_PLAINTEXT in the listeners, then you are likely impacted.\n\nFix Details:\nThe issue has been addressed by introducing nonce verification in the final message of the SCRAM authentication exchange to ensure compliance with RFC 5802.\n\nAffected Versions:\nApache Kafka versions 0.10.2.0 through 3.9.0, excluding the fixed versions below.\n\nFixed Versions:\n3.9.0\n3.8.1\n3.7.2\n\nUsers are advised to upgrade to 3.7.2 or later to mitigate this issue.\n\nRecommendations for Mitigation:\nUsers unable to upgrade to the fixed versions can mitigate the issue by:\n- Using TLS with SCRAM Authentication:\nAlways deploy SCRAM over TLS to encrypt authentication exchanges and protect against interception.\n- Considering Alternative Authentication Mechanisms:\nEvaluate alternative authentication mechanisms, such as PLAIN, Kerberos or OAuth with TLS, which provide additional layers of security."
    },
    {
      "lang": "es",
      "value": "Implementación incorrecta del algoritmo de autenticación en la implementación SCRAM de Apache Kafka. Resumen del problema: La implementación de Apache Kafka del mecanismo de autenticación de respuesta a desafío con sal (SCRAM) no se adhirió completamente a los requisitos de RFC 5802 [1]. Específicamente, según RFC 5802, el servidor debe verificar que el nonce enviado por el cliente en el segundo mensaje coincida con el nonce enviado por el servidor en su primer mensaje. Sin embargo, la implementación SCRAM de Kafka no realizó esta validación. Impacto: Esta vulnerabilidad es explotable solo cuando un atacante tiene acceso de texto simple al intercambio de autenticación SCRAM. Sin embargo, el uso de SCRAM sobre texto simple se desaconseja enfáticamente ya que se considera una práctica insegura [2]. Apache Kafka recomienda implementar SCRAM exclusivamente con cifrado TLS para proteger los intercambios SCRAM de la intercepción [3]. Las implementaciones que utilizan SCRAM con TLS no se ven afectadas por este problema. Cómo detectar si está afectado: si su implementación utiliza autenticación SCRAM sobre canales de comunicación de texto plano (sin cifrado TLS), es probable que esté afectado. Para verificar si TLS está habilitado, revise su archivo de configuración server.properties para la propiedad listeners. Si tiene SASL_PLAINTEXT en los listeners, es probable que esté afectado. Detalles de la solución: el problema se ha solucionado introduciendo la verificación de nonce en el mensaje final del intercambio de autenticación SCRAM para garantizar el cumplimiento de RFC 5802. Versiones afectadas: Apache Kafka versiones 0.10.2.0 a 3.9.0, excluidas las versiones corregidas a continuación. Versiones corregidas: 3.9.0 3.8.1 3.7.2 Se recomienda a los usuarios que actualicen a 3.7.2 o posterior para mitigar este problema. Recomendaciones para la mitigación: los usuarios que no puedan actualizar a las versiones corregidas pueden mitigar el problema mediante lo siguiente: - Uso de TLS con autenticación SCRAM: siempre implemente SCRAM sobre TLS para cifrar los intercambios de autenticación y protegerse contra la interceptación. - Consideración de mecanismos de autenticación alternativos: evaluar mecanismos de autenticación alternativos, como PLAIN, Kerberos u OAuth con TLS, que proporcionan capas adicionales de seguridad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-303"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-Other"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:kafka:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.10.2.0",
              "versionEndExcluding": "3.7.2",
              "matchCriteriaId": "7358B30A-00B4-4357-9A54-A169438B685D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:kafka:3.8.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "EF7C474D-9CB2-441B-9B30-782031AC1576"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://datatracker.ietf.org/doc/html/rfc5802",
      "source": "security@apache.org",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://datatracker.ietf.org/doc/html/rfc5802#section-9",
      "source": "security@apache.org",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://kafka.apache.org/documentation/#security_sasl_scram_security",
      "source": "security@apache.org",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/84dh4so32lwn7wr6c5s9mwh381vx9wkw",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/12/18/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ]
}