{
  "id": "CVE-2024-29041",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-03-25T21:15:46.847",
  "lastModified": "2024-11-21T09:07:26.023",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3."
    },
    {
      "lang": "es",
      "value": "El framework web minimalista Express.js para node. Las versiones de Express.js anteriores a 4.19.0 y todas las versiones alfa y beta preliminares de 5.0 se ven afectadas por una vulnerabilidad de redireccionamiento abierto que utiliza URL con formato incorrecto. Cuando un usuario de Express realiza una redirección utilizando una URL proporcionada por el usuario, Express realiza una codificación [usando `encodeurl`](https://github.com/pillarjs/encodeurl) en el contenido antes de pasarlo al encabezado de `ubicación`. Esto puede hacer que las URL con formato incorrecto se evalúen de maneras inesperadas mediante implementaciones de listas permitidas de redireccionamiento común en aplicaciones Express, lo que lleva a una redirección abierta al omitir una lista permitida implementada correctamente. El método principal afectado es `res.location()` pero también se llama desde `res.redirect()`. La vulnerabilidad se solucionó en 4.19.2 y 5.0.0-beta.3."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-601"
        },
        {
          "lang": "en",
          "value": "CWE-1286"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://expressjs.com/en/4x/api.html#res.location",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/expressjs/express/pull/5539",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/koajs/koa/issues/1800",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://expressjs.com/en/4x/api.html#res.location",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/expressjs/express/pull/5539",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/koajs/koa/issues/1800",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}