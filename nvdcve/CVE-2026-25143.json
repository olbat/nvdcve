{
  "id": "CVE-2026-25143",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2026-02-04T20:16:06.227",
  "lastModified": "2026-02-18T15:55:19.757",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "melange allows users to build apk packages using declarative pipelines. From version 0.10.0 to before 0.40.3, an attacker who can influence inputs to the patch pipeline could execute arbitrary shell commands on the build host. The patch pipeline in pkg/build/pipelines/patch.yaml embeds input-derived values (series paths, patch filenames, and numeric parameters) into shell scripts without proper quoting or validation, allowing shell metacharacters to break out of their intended context. The vulnerability affects the built-in patch pipeline which can be invoked through melange build and melange license-check operations. An attacker who can control patch-related inputs (e.g., through pull request-driven CI, build-as-a-service, or by influencing melange configurations) can inject shell metacharacters such as backticks, command substitutions $(…), semicolons, pipes, or redirections to execute arbitrary commands with the privileges of the melange build process. This issue has been patched in version 0.40.3."
    },
    {
      "lang": "es",
      "value": "melange permite a los usuarios construir paquetes apk usando pipelines declarativos. Desde la versión 0.10.0 hasta antes de la 0.40.3, un atacante que pueda influir en las entradas del pipeline de parche podría ejecutar comandos de shell arbitrarios en el host de compilación. El pipeline de parche en pkg/build/pipelines/patch.yaml incrusta valores derivados de la entrada (rutas de series, nombres de archivo de parche y parámetros numéricos) en scripts de shell sin la debida entrecomillado o validación, permitiendo que los metacaracteres de shell salgan de su contexto previsto. La vulnerabilidad afecta al pipeline de parche incorporado que puede ser invocado a través de las operaciones melange build y melange license-check. Un atacante que pueda controlar las entradas relacionadas con el parche (por ejemplo, a través de CI impulsado por solicitudes de extracción, build-as-a-service, o influyendo en las configuraciones de melange) puede inyectar metacaracteres de shell como backticks, sustituciones de comandos $(…), puntos y coma, pipes o redirecciones para ejecutar comandos arbitrarios con los privilegios del proceso de compilación de melange. Este problema ha sido parcheado en la versión 0.40.3."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-78"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:chainguard:melange:*:*:*:*:*:go:*:*",
              "versionStartIncluding": "0.10.0",
              "versionEndExcluding": "0.40.5",
              "matchCriteriaId": "7C431FC1-D406-4CF1-969D-9228F4FE6B89"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/chainguard-dev/melange/commit/bd132535cd9f57d4bd39d9ead0633598941af030",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/chainguard-dev/melange/security/advisories/GHSA-rf4g-89h5-crcr",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}