{
  "id": "CVE-2024-47070",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-09-27T16:15:05.413",
  "lastModified": "2025-08-21T19:28:44.253",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue."
    },
    {
      "lang": "es",
      "value": "authentik es un proveedor de identidad de código abierto. Una vulnerabilidad que existe en versiones anteriores a 2024.8.3 y 2024.6.5 permite omitir el inicio de sesión con contraseña agregando el encabezado X-Forwarded-For con una dirección IP que no se puede analizar, por ejemplo, `a`. Esto genera la posibilidad de iniciar sesión en cualquier cuenta con un nombre de usuario o una dirección de correo electrónico conocidos. La vulnerabilidad requiere que la instancia de authentik confíe en el encabezado X-Forwarded-For proporcionado por el atacante, por lo que no es reproducible desde hosts externos en un entorno configurado correctamente. El problema ocurre debido a que la etapa de contraseña tiene una política vinculada a ella, que omite la etapa de contraseña si la etapa de identificación está configurada para contener también una etapa de contraseña. Debido al encabezado X-Forwarded-For no válido, que no se valida como una dirección IP con la suficiente anticipación, la excepción ocurre más tarde y la política falla. El modelo predeterminado no establece correctamente `failure_result` en `True` en el enlace de política, lo que significa que debido a esta excepción, la política devuelve falso y se omite la etapa de contraseña. Las versiones 2024.8.3 y 2024.6.5 solucionan este problema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 9.0,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2024.6.5",
              "matchCriteriaId": "64784B4C-46C6-4F7A-947B-167A29072B70"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2024.8.0",
              "versionEndExcluding": "2024.8.3",
              "matchCriteriaId": "424378D1-E5DB-446E-AC2A-05BF49F0EF44"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/goauthentik/authentik/commit/78f7b04d5a62b2a9d4316282a713c2c7857dbe29",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/commit/dd8f809161e738b25765797eb2a5c77a7d3fc2cf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-7jxf-mmg9-9hg7",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}