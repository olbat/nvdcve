{
  "id": "CVE-2021-39155",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-08-24T23:15:07.093",
  "lastModified": "2024-11-21T06:18:44.323",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Istio is an open source platform for providing a uniform way to integrate microservices, manage traffic flow across microservices, enforce policies and aggregate telemetry data. According to [RFC 4343](https://datatracker.ietf.org/doc/html/rfc4343), Istio authorization policy should compare the hostname in the HTTP Host header in a case insensitive way, but currently the comparison is case sensitive. The proxy will route the request hostname in a case-insensitive way which means the authorization policy could be bypassed. As an example, the user may have an authorization policy that rejects request with hostname \"httpbin.foo\" for some source IPs, but the attacker can bypass this by sending the request with hostname \"Httpbin.Foo\". Patches are available in Istio 1.11.1, Istio 1.10.4 and Istio 1.9.8. As a work around a Lua filter may be written to normalize Host header before the authorization check. This is similar to the Path normalization presented in the [Security Best Practices](https://istio.io/latest/docs/ops/best-practices/security/#case-normalization) guide."
    },
    {
      "lang": "es",
      "value": "Istio es una plataforma de código abierto que proporciona una forma uniforme de integrar microservicios, administrar el flujo de tráfico entre microservicios, aplicar políticas y agregar datos de telemetría. Según [RFC 4343](https://datatracker.ietf.org/doc/html/rfc4343), la política de autorización de Istio debería comparar el nombre de host en el encabezado HTTP Host de forma no sensible a mayúsculas y minúsculas, pero actualmente la comparación es sensible a mayúsculas y minúsculas. El proxy enrutará el nombre de host de la petición de forma no sensible a mayúsculas y minúsculas, lo que significa que la política de autorización podría ser omitida. Por ejemplo, el usuario puede tener una política de autorización que rechace peticiones con el nombre de host \"httpbin.foo\" para algunas IPs de origen, pero el atacante puede omitir esto mediante el envío de la petición con el nombre de host \"Httpbin.Foo\". Los parches están disponibles en Istio versión 1.11.1, Istio versión 1.10.4 e Istio versión 1.9.8. Como solución, puede escribirse un filtro Lua para normalizar el encabezado Host antes de la comprobación de la autorización. Esto es similar a la normalización de la Ruta presentada en la guía [Security Best Practices](https://istio.io/latest/docs/ops/best-practices/security/#case-normalization)."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L",
          "baseScore": 8.3,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.5
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "baseScore": 5.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-178"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-178"
        },
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.9.8",
              "matchCriteriaId": "2FBF48C6-1E39-4692-A652-27E7DCDC81BC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.10.0",
              "versionEndExcluding": "1.10.4",
              "matchCriteriaId": "59BD6BCF-15CE-49D9-B487-EEA603D3D5CC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.11.0",
              "versionEndExcluding": "1.11.1",
              "matchCriteriaId": "886DF572-26C9-4BC9-875F-F043D445C346"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://datatracker.ietf.org/doc/html/rfc4343",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-7774-7vr3-cc8j",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://datatracker.ietf.org/doc/html/rfc4343",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-7774-7vr3-cc8j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}