{
  "id": "CVE-2024-20506",
  "sourceIdentifier": "psirt@cisco.com",
  "published": "2024-09-04T22:15:04.083",
  "lastModified": "2025-03-25T17:15:47.027",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A vulnerability in the ClamD service module of Clam AntiVirus (ClamAV) versions 1.4.0, 1.3.2 and prior versions, all 1.2.x versions, 1.0.6 and prior versions, all 0.105.x versions, all 0.104.x versions, and 0.103.11 and all prior versions could allow an authenticated, local attacker to corrupt critical system files.\r\n\r\nThe vulnerability is due to allowing the ClamD process to write to its log file while privileged without checking if the logfile has been replaced with a symbolic link. An attacker could exploit this vulnerability if they replace the ClamD log file with a symlink to a critical system file and then find a way to restart the ClamD process. An exploit could allow the attacker to corrupt a critical system file by appending ClamD log messages after restart."
    },
    {
      "lang": "es",
      "value": "Una vulnerabilidad en el módulo de servicio ClamD de Clam AntiVirus (ClamAV) versiones 1.4.0, 1.3.2 y anteriores, todas las versiones 1.2.x, 1.0.6 y anteriores, todas las versiones 0.105.x, todas las versiones 0.104.x y 0.103.11 y anteriores podría permitir que un atacante local autenticado corrompa archivos críticos del sistema. La vulnerabilidad se debe a que permite que el proceso ClamD escriba en su archivo de registro mientras tiene privilegios sin comprobar si el archivo de registro ha sido reemplazado por un enlace simbólico. Un atacante podría aprovechar esta vulnerabilidad si reemplaza el archivo de registro de ClamD por un enlace simbólico a un archivo crítico del sistema y luego encuentra una forma de reiniciar el proceso ClamD. Una vulnerabilidad podría permitir que el atacante corrompa un archivo crítico del sistema añadiendo mensajes de registro de ClamD después del reinicio."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "psirt@cisco.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 4.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-754"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-754"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.103.12",
              "matchCriteriaId": "C21D8C4B-CEBE-422C-A103-B516EBCC34B6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.104.0",
              "versionEndExcluding": "1.0.7",
              "matchCriteriaId": "8D3AF611-42CD-4EC8-9A2A-89AEC62A3D6E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.2.0",
              "versionEndExcluding": "1.3.2",
              "matchCriteriaId": "DD0EA13B-FFC9-4385-8691-38A90DCE774F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:1.4.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "9D7F43F7-EF41-4CB7-A013-6A8F274F973D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://blog.clamav.net/2024/09/clamav-141-132-107-and-010312-security.html",
      "source": "psirt@cisco.com",
      "tags": [
        "Release Notes"
      ]
    }
  ]
}