{
  "id": "CVE-2022-46163",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-01-10T21:15:12.740",
  "lastModified": "2024-11-21T07:30:14.233",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Travel support program is a rails app to support the travel support program of openSUSE (TSP). Sensitive user data (bank account details, password Hash) can be extracted via Ransack query injection. Every deployment of travel-support-program below the patched version is affected. The travel-support-program uses the Ransack library to implement search functionality. In its default configuration, Ransack will allow for query conditions based on properties of associated database objects [1]. The `*_start`, `*_end` or `*_cont` search matchers [2] can then be abused to exfiltrate sensitive string values of associated database objects via character-by-character brute-force (A match is indicated by the returned JSON not being empty). A single bank account number can be extracted with <200 requests, a password hash can be extracted with ~1200 requests, all within a few minutes. The problem has been patched in commit d22916275c51500b4004933ff1b0a69bc807b2b7. In order to work around this issue, you can also cherry pick that patch, however it will not work without the Rails 5.0 migration that was done in #150, which in turn had quite a few pull requests it depended on."
    },
    {
      "lang": "es",
      "value": "El programa de soporte para viajes es una aplicación de rails para respaldar el programa de soporte para viajes de openSUSE (TSP). Los datos confidenciales del usuario (detalles de la cuenta bancaria, hash de contraseña) se pueden extraer mediante la inyección de consultas Ransack. Todas las implementaciones del programa de soporte para viajes inferiores a la versión parcheada se ven afectadas. El programa de soporte para viajes utiliza la librería Ransack para implementar la función de búsqueda. En su configuración predeterminada, Ransack permitirá condiciones de consulta basadas en propiedades de los objetos de la base de datos asociados [1]. Luego se puede abusar de los comparadores de búsqueda `*_start`, `*_end` o `*_cont` [2] para filtrar valores de cadenas confidenciales de objetos de bases de datos asociados mediante fuerza bruta carácter por carácter (Una coincidencia se indica porque el JSON devuelto no está vacío). Se puede extraer un único número de cuenta bancaria con &lt;200 solicitudes, y un hash de contraseña con ~1200 solicitudes, todo en unos pocos minutos. El problema se solucionó en el commit d22916275c51500b4004933ff1b0a69bc807b2b7. Para solucionar este problema, también puede elegir ese parche; sin embargo, no funcionará sin la migración de Rails 5.0 que se realizó en el n.° 150, que a su vez tenía bastantes solicitudes de extracción de las que dependía."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:opensuse:travel_support_program:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2022-11-29",
              "matchCriteriaId": "69AF7833-9415-4F9C-906C-C944FAA50EE7"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openSUSE/travel-support-program/pull/158",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openSUSE/travel-support-program/pull/158",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}