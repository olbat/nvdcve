{
  "id": "CVE-2022-23653",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-02-23T23:15:07.900",
  "lastModified": "2024-11-21T06:49:01.667",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "B2 Command Line Tool is the official command line tool for the backblaze cloud storage service. Linux and Mac releases of the B2 command-line tool version 3.2.0 and below contain a key disclosure vulnerability that, in certain conditions, can be exploited by local attackers through a time-of-check-time-of-use (TOCTOU) race condition. The command line tool saves API keys (and bucket name-to-id mapping) in a local database file (`$XDG_CONFIG_HOME/b2/account_info`, `~/.b2_account_info` or a user-defined path) when `b2 authorize-account` is first run. This happens regardless of whether a valid key is provided or not. When first created, the file is world readable and is (typically a few milliseconds) later altered to be private to the user. If the directory is readable by a local attacker and the user did not yet run `b2 authorize-account` then during the brief period between file creation and permission modification, a local attacker can race to open the file and maintain a handle to it. This allows the local attacker to read the contents after the file after the sensitive information has been saved to it. Users that have not yet run `b2 authorize-account` should upgrade to B2 Command-Line Tool v3.2.1 before running it. Users that have run `b2 authorize-account` are safe if at the time of the file creation no other local users had read access to the local configuration file. Users that have run `b2 authorize-account` where the designated path could be opened by another local user should upgrade to B2 Command-Line Tool v3.2.1 and remove the database and regenerate all application keys. Note that `b2 clear-account` does not remove the database file and it should not be used to ensure that all open handles to the file are invalidated. If B2 Command-Line Tool cannot be upgraded to v3.2.1 due to a dependency conflict, a binary release can be used instead. Alternatively a new version could be installed within a virtualenv, or the permissions can be changed to prevent local users from opening the database file."
    },
    {
      "lang": "es",
      "value": "B2 Command Line Tool es la herramienta oficial de línea de comandos para el servicio de almacenamiento en la nube de Backblaze. Las versiones para Linux y Mac de la herramienta de línea de comandos B2, versión 3.2.0 y anteriores, contienen una vulnerabilidad de divulgación de claves que, en determinadas condiciones, puede ser explotada por atacantes locales mediante una condición de carrera de tiempo de comprobación de uso (TOCTOU). La herramienta de línea de comandos guarda las claves de la API (y el mapeo de nombres de cubos a identificadores) en un archivo de base de datos local (\"$XDG_CONFIG_HOME/b2/account_info\", \"~/.b2_account_info\" o una ruta definida por el usuario) cuando es ejecutado \"b2 authorize-account\" por primera vez. Esto ocurre independientemente de si es proporcionada una clave válida o no. Cuando es creado por primera vez, el archivo es legible para todo el mundo y más tarde (normalmente unos milisegundos) es alterada para que sea privado para el usuario. Si el directorio es legible por un atacante local y el usuario aún no ha ejecutado \"b2 authorize-account\", entonces durante el breve período entre la creación del archivo y la modificación del permiso, un atacante local puede correr para abrir el archivo y mantener un manejo del mismo. Esto permite al atacante local leer el contenido después del archivo una vez que la información confidencial ha sido guardada en él. Los usuarios que aún no hayan ejecutado \"b2 authorize-account\" deberían actualizar a B2 Command Line Tool versión v3.2.1 antes de ejecutarla. Los usuarios que han ejecutado \"b2 authorize-account\" están seguros si en el momento de la creación del archivo ningún otro usuario local tenía acceso de lectura al archivo de configuración local. Los usuarios que hayan ejecutado \"b2 authorize-account\" cuando la ruta designada pueda ser abierta por otro usuario local deben actualizar a B2 Command-Line Tool versión v3.2.1 y eliminar la base de datos y regenerar todas las claves de aplicación. Tenga en cuenta que \"b2 clear-account\" no elimina el archivo de la base de datos y no debe usarse para asegurar que todos los manejadores abiertos al archivo sean invalidados. Si la herramienta de línea de comandos B2 no puede actualizarse a versión 3.2.1 debido a un conflicto de dependencias, puede usarse una versión binaria en su lugar. También puede instalarse una nueva versión dentro de un virtualenv, o pueden cambiarse los permisos para evitar que usuarios locales abran el archivo de la base de datos"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N",
          "baseScore": 1.9,
          "accessVector": "LOCAL",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 3.4,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-367"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:linux:*:*",
              "versionEndIncluding": "3.2.0",
              "matchCriteriaId": "8C0E07A2-B0E4-4CB3-8A51-52A48CA903A7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:mac:*:*",
              "versionEndIncluding": "3.2.0",
              "matchCriteriaId": "D48B24B7-6F45-48AD-BE6D-704C7FEDAE03"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Backblaze/B2_Command_Line_Tool/security/advisories/GHSA-8wr4-2wm6-w3pr",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Backblaze/B2_Command_Line_Tool/security/advisories/GHSA-8wr4-2wm6-w3pr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}