{
  "id": "CVE-2024-43368",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-08-14T22:15:04.497",
  "lastModified": "2024-08-15T13:01:10.150",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "The Trix editor, versions prior to 2.1.4, is vulnerable to XSS when pasting malicious code. This vulnerability is a bypass of the fix put in place for GHSA-qjqp-xr96-cj99. In pull request 1149, sanitation was added for Trix attachments with a `text/html` content type. However, Trix only checks the content type on the paste event's `dataTransfer` object. As long as the `dataTransfer` has a content type of `text/html`, Trix parses its contents and creates an `Attachment` with them, even if the attachment itself doesn't have a `text/html` content type. Trix then uses the attachment content to set the attachment element's `innerHTML`. An attacker could trick a user to copy and paste malicious code that would execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed. This vulnerability was fixed in version 2.1.4."
    },
    {
      "lang": "es",
      "value": "El editor Trix, versiones anteriores a la 2.1.4, es vulnerable a XSS al pegar código malicioso. Esta vulnerabilidad es una omisión de la solución implementada para GHSA-qjqp-xr96-cj99. En la solicitud de extracción 1149, se agregó saneamiento para los archivos adjuntos de Trix con un tipo de contenido \"text/html\". Sin embargo, Trix solo verifica el tipo de contenido en el objeto `dataTransfer` del evento de pegado. Siempre que `dataTransfer` tenga un tipo de contenido `text/html`, Trix analiza su contenido y crea un `Attachment` con ellos, incluso si el archivo adjunto en sí no tiene un tipo de contenido `text/html`. Luego, Trix usa el contenido del archivo adjunto para configurar el `innerHTML` del elemento adjunto. Un atacante podría engañar a un usuario para que copie y pegue código malicioso que ejecutaría código JavaScript arbitrario dentro del contexto de la sesión del usuario, lo que podría provocar la realización de acciones no autorizadas o la divulgación de información confidencial. Esta vulnerabilidad se solucionó en la versión 2.1.4."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/basecamp/trix/commit/7656f578af0d03141a72a9d27cb3692e6947dae6",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/basecamp/trix/pull/1149",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/basecamp/trix/pull/1156",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/basecamp/trix/releases/tag/v2.1.4",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/basecamp/trix/security/advisories/GHSA-qm2q-9f3q-2vcv",
      "source": "security-advisories@github.com"
    }
  ]
}