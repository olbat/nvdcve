{
  "id": "CVE-2018-5731",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2018-03-22T16:29:00.270",
  "lastModified": "2024-11-21T04:09:16.290",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in Heimdal PRO 2.2.190. As part of the scanning feature, a process called md.hs writes an executable called CS1.tmp to C:\\windows\\TEMP. Afterwards the executable is run. It is possible for an attacker to create the file first, let md.hs overwrite it, and then rewrite the file in the window between md.hs closing the file and executing it. This can be exploited via opportunistic locks and a high priority thread. The vulnerability is triggered when a scan starts. NOTE: any affected Heimdal products are completely unrelated to the Heimdal vendor of a Kerberos 5 product on the h5l.org web site."
    },
    {
      "lang": "es",
      "value": "Se ha descubierto un problema en Heimdal PRO 2.2.190. Como parte de la funcionalidad de escaneo, un proceso llamado md.hs escribe un ejecutable llamado CS1.tmp en C:\\windows\\TEMP. Posteriormente, se ejecuta este archivo. Es posible que un atacante cree primero el archivo, deje que md.hs lo sobrescriba y, entonces, reescriba el archivo en la ventana de tiempo entre que md.hs cierra el archivo y lo ejecuta. Esto se puede explotar mediante cierres oportunistas y un hilo de prioridad alta. La vulnerabilidad se desencadena cuando comienza un escáner. NOTA: ningún producto Heimdal afectado tiene relación con el fabricante Heimdal de un producto Kerberos 5 en el sitio web h5l.org."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.0,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
          "baseScore": 4.4,
          "accessVector": "LOCAL",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 3.4,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:heimdalsecurity:heimdal:2.2.190:*:*:*:pro:*:*:*",
              "matchCriteriaId": "A73988CB-F37E-4460-B8FF-BFECB7525BDF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://improsec.com/blog/heimdal-advisory-2",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://improsec.com/blog/heimdal-advisory-2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}