{
  "id": "CVE-2024-1724",
  "sourceIdentifier": "security@ubuntu.com",
  "published": "2024-07-25T19:15:09.913",
  "lastModified": "2024-11-21T08:51:10.117",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In snapd versions prior to 2.62, when using AppArmor for enforcement of \nsandbox permissions, snapd failed to restrict writes to the $HOME/bin\npath. In Ubuntu, when this path exists, it is automatically added to\nthe users PATH. An attacker who could convince a user to install a\nmalicious snap which used the 'home' plug could use this vulnerability\nto install arbitrary scripts into the users PATH which may then be run\nby the user outside of the expected snap sandbox and hence allow them\nto escape confinement."
    },
    {
      "lang": "es",
      "value": "En versiones de snapd anteriores a la 2.62, cuando se usaba AppArmor para hacer cumplir los permisos de la zona de pruebas, snapd no podía restringir las escrituras en la ruta $HOME/bin. En Ubuntu, cuando esta ruta existe, se agrega automáticamente al PATH del usuario. Un atacante que pudiera convencer a un usuario para que instalara un complemento malicioso que usara el complemento \"home\" podría usar esta vulnerabilidad para instalar scripts arbitrarios en el PATH del usuario que luego el usuario podría ejecutar fuera del entorno de pruebas esperado y, por lo tanto, permitirle escapar del encierro."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@ubuntu.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.0,
        "impactScore": 3.7
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
          "baseScore": 8.2,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.5,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@ubuntu.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-732"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-732"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:canonical:snapd:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.62",
              "matchCriteriaId": "A4A95DA5-EB47-48AA-B9C6-EB6D1489E832"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6",
      "source": "security@ubuntu.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/snapcore/snapd/pull/13689",
      "source": "security@ubuntu.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://gld.mcphail.uk/posts/explaining-cve-2024-1724/",
      "source": "security@ubuntu.com",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/snapcore/snapd/pull/13689",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://gld.mcphail.uk/posts/explaining-cve-2024-1724/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    }
  ]
}