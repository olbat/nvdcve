{
  "id": "CVE-2023-38701",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-10-04T19:15:10.127",
  "lastModified": "2024-11-21T08:14:05.150",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Hydra is the layer-two scalability solution for Cardano. Users of the Hydra head protocol send the UTxOs they wish to commit into the Hydra head first to the `commit` validator, where they remain until they are either collected into the `head` validator or the protocol initialisation is aborted and the value in the committed UTxOs is returned to the users who committed them. Prior to version 0.12.0, the `commit` validator contains a flawed check when the `ViaAbort` redeemer is used, which allows any user to spend any UTxO which is at the validator arbitrarily, meaning an attacker can steal the funds that users are trying to commit into the head validator. The intended behavior is that the funds must be returned to the user which committed the funds and can only be performed by a participant of the head. The `initial` validator also is similarly affected as the same flawed check is performed for the `ViaAbort` redeemer. Due to this issue, an attacker can steal any funds that user's try to commit into a Hydra head. Also, an attacker can prevent any Hydra head from being successfully opened. It does not allow an attacker to take funds which have been successfully collected into and currently reside in the `head` validator. Version 0.12.0 contains a fix for this issue."
    },
    {
      "lang": "es",
      "value": "Hydra es la solución de escalabilidad de capa dos para Cardano. Los usuarios del protocolo \"head\" de Hydra envían los UTxOs que desean hacer \"commit\" al \"head\" de Hydra, primero al validador \"commit\", donde permanecen hasta que se recopilan en el validador de \"head\" o se cancela la inicialización del protocolo y el valor de los committed UTxOs se devuelven a los usuarios que hicieron \"commit\". Antes de la versión 0.12.0, el validador del \"commit\" contiene una verificación defectuosa cuando se usa el redeemer \"ViaAbort\", lo que permite a cualquier usuario gastar cualquier UTxO que esté en el validador de forma arbitraria, lo que significa que un atacante puede robar los fondos que los usuarios están tratando de hacer \"commit\" con el validador \"head\". El comportamiento previsto es que los fondos deben devolverse al usuario que comprometió los fondos y solo puede ser realizado por un participante del \"head\". El validador \"initial\" también se ve afectado de manera similar, ya que realiza la misma verificación defectuosa para el redeemer \"ViaAbort\". Debido a este problema, un atacante puede robar cualquier fondo que el usuario intente depositar en el \"head\" de Hydra. Además, un atacante puede impedir que cualquier \"head\" de Hydra se abra con éxito. No permite que un atacante obtenga fondos que se hayan recaudado exitosamente y que actualmente residen en el validador \"head\". La versión 0.12.0 contiene una solución para este problema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:iohk:hydra:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.12.0",
              "matchCriteriaId": "8AF262DB-3B2B-4A60-BF71-10808E4B461F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/CHANGELOG.md#0120---2023-08-18",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Commit.hs#L94-L97",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Util.hs#L32-L42",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/security/advisories/GHSA-6x9v-7x5r-w8w6",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/CHANGELOG.md#0120---2023-08-18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Commit.hs#L94-L97",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Util.hs#L32-L42",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/input-output-hk/hydra/security/advisories/GHSA-6x9v-7x5r-w8w6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}