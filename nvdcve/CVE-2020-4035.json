{
  "id": "CVE-2020-4035",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2020-06-03T17:15:26.153",
  "lastModified": "2024-11-21T05:32:11.750",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In WatermelonDB (NPM package \"@nozbe/watermelondb\") before versions 0.15.1 and 0.16.2, a maliciously crafted record ID can exploit a SQL Injection vulnerability in iOS adapter implementation and cause the app to delete all or selected records from the database, generally causing the app to become unusable. This may happen in apps that don't validate IDs (valid IDs are `/^[a-zA-Z0-9_-.]+$/`) and use Watermelon Sync or low-level `database.adapter.destroyDeletedRecords` method. The integrity risk is low due to the fact that maliciously deleted records won't synchronize, so logout-login will restore all data, although some local changes may be lost if the malicious deletion causes the sync process to fail to proceed to push stage. No way to breach confidentiality with this vulnerability is known. Full exploitation of SQL Injection is mitigated, because it's not possible to nest an insert/update query inside a delete query in SQLite, and it's not possible to pass a semicolon-separated second query. There's also no known practicable way to breach confidentiality by selectively deleting records, because those records will not be synchronized. It's theoretically possible that selective record deletion could cause an app to behave insecurely if lack of a record is used to make security decisions by the app. This is patched in versions 0.15.1, 0.16.2, and 0.16.1-fix"
    },
    {
      "lang": "es",
      "value": "En WatermelonDB (paquete NPM \"@nozbe/watermelondb\") versiones anteriores a 0.15.1 y 0.16.2, un ID de registro diseñado con fines maliciosos puede explotar una vulnerabilidad de inyección SQL en la implementación del adaptador iOS y causar que la aplicación elimine todo o registros seleccionados de la base de datos, por lo general, la aplicación queda inutilizable. Esto puede suceder en aplicaciones que no comprueban los ID (los ID válidos son \"/^[a-zA-Z0-9_-.]+$/\") y usan Watermelon Sync o el método \"database.adapter.destroyDeletedRecords\" de bajo nivel . El riesgo de integridad es bajo debido al hecho de que los registros eliminados maliciosamente no se sincronizarán, por lo que el inicio de sesión cerrará todos los datos, aunque algunos cambios locales pueden perderse si la eliminación maliciosa causa que el proceso de sincronización no avance a la etapa de inserción. No se conoce ninguna manera de violar la confidencialidad con esta vulnerabilidad. Una explotación completa de la inyección SQL se mitiga, porque no es posible anidar una consulta de inserción/actualización dentro de una consulta de eliminación en SQLite, y no es posible pasar una segunda consulta separada por punto y coma. Tampoco se conoce una manera práctica de violar la confidencialidad mediante la eliminación selectiva de registros, porque esos registros no se sincronizarán. Teóricamente es posible que la eliminación de registros selectiva pueda hacer que una aplicación se comporte de forma no segura si la falta de un registro para tomar decisiones de seguridad es usada por la aplicación. Esto está parcheado en las versiones 0.15.1, 0.16.2 y 0.16.1-fix"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 4.2
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:P",
          "baseScore": 5.5,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nozbe:watermelondb:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.15.1",
              "matchCriteriaId": "246C2261-8971-4C09-90AC-15AD5A864A1F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nozbe:watermelondb:0.16.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "E9E2E1B2-B5DA-4010-8635-B555309F84C1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nozbe:watermelondb:0.16.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "2FF01DBC-C248-40CA-BD58-B75E94D99D3D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Nozbe/WatermelonDB/commit/924c7ae2a8d7d6459656751e5b9b1bf91a218025",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nozbe/WatermelonDB/security/advisories/GHSA-38f9-m297-6q9g",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nozbe/WatermelonDB/commit/924c7ae2a8d7d6459656751e5b9b1bf91a218025",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nozbe/WatermelonDB/security/advisories/GHSA-38f9-m297-6q9g",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}