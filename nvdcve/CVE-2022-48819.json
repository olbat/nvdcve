{
  "id": "CVE-2022-48819",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-07-16T12:15:05.883",
  "lastModified": "2024-11-21T07:34:08.837",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntcp: take care of mixed splice()/sendmsg(MSG_ZEROCOPY) case\n\nsyzbot found that mixing sendpage() and sendmsg(MSG_ZEROCOPY)\ncalls over the same TCP socket would again trigger the\ninfamous warning in inet_sock_destruct()\n\n\tWARN_ON(sk_forward_alloc_get(sk));\n\nWhile Talal took into account a mix of regular copied data\nand MSG_ZEROCOPY one in the same skb, the sendpage() path\nhas been forgotten.\n\nWe want the charging to happen for sendpage(), because\npages could be coming from a pipe. What is missing is the\ndowngrading of pure zerocopy status to make sure\nsk_forward_alloc will stay synced.\n\nAdd tcp_downgrade_zcopy_pure() helper so that we can\nuse it from the two callers."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: tcp: cuidado del caso mixto splice()/sendmsg(MSG_ZEROCOPY) syzbot descubrió que mezclar llamadas sendpage() y sendmsg(MSG_ZEROCOPY) en el mismo socket TCP desencadenaría nuevamente el infame advertencia en inet_sock_destruct() WARN_ON(sk_forward_alloc_get(sk)); Si bien Talal tuvo en cuenta una combinación de datos copiados normales y uno MSG_ZEROCOPY en el mismo skb, la ruta sendpage() se olvidó. Queremos que el cobro se realice por sendpage(), porque las páginas podrían provenir de una tubería. Lo que falta es degradar el estado de copia cero pura para garantizar que sk_forward_alloc permanezca sincronizado. Agregue el asistente tcp_downgrade_zcopy_pure() para que podamos usarlo desde las dos personas que llaman."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/47f3860c4931175f112f28dcac66eacca9b1040f",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/f8d9d938514f46c4892aff6bfe32f425e84d81cc",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/47f3860c4931175f112f28dcac66eacca9b1040f",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/f8d9d938514f46c4892aff6bfe32f425e84d81cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}