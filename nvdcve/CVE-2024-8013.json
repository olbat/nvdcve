{
  "id": "CVE-2024-8013",
  "sourceIdentifier": "cna@mongodb.com",
  "published": "2024-10-28T13:15:10.200",
  "lastModified": "2024-10-31T13:33:03.953",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "A bug in query analysis of certain complex self-referential $lookup subpipelines may result in literal values in expressions for encrypted fields to be sent to the server as plaintext instead of ciphertext. Should this occur, no documents would be returned or written. This issue affects mongocryptd binary (v5.0 versions prior to 5.0.29, v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) and mongo_crypt_v1.so shared libraries (v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) released alongside MongoDB Enterprise Server versions."
    },
    {
      "lang": "es",
      "value": "Un error en el análisis de consultas de ciertas subcanalizaciones autorreferenciales complejas de $lookup puede dar como resultado que los valores literales en las expresiones de los campos cifrados se envíen al servidor como texto plano en lugar de texto plano. Si esto ocurriera, no se devolvería ni escribiría ningún documento. Este problema afecta al binario mongocryptd (versiones v5.0 anteriores a 5.0.29, versiones v6.0 anteriores a 6.0.17, versiones v7.0 anteriores a 7.0.12 y versiones v7.3 anteriores a 7.3.4) y a las librerías compartidas mongo_crypt_v1.so (versiones v6.0 anteriores a 6.0.17, versiones v7.0 anteriores a 7.0.12 y versiones v7.3 anteriores a 7.3.4) publicadas junto con las versiones de MongoDB Enterprise Server."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cna@mongodb.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N",
          "baseScore": 2.2,
          "baseSeverity": "LOW",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 0.8,
        "impactScore": 1.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 3.3,
          "baseSeverity": "LOW",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cna@mongodb.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-319"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-319"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongo_crypt_v1.so:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "6.0.0",
              "versionEndExcluding": "6.0.17",
              "matchCriteriaId": "4F0AB171-D947-49C0-9316-7F9E24EA043D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongo_crypt_v1.so:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "7.0.0",
              "versionEndExcluding": "7.0.12",
              "matchCriteriaId": "8212FEB4-CBC2-467F-9481-B5732508F2A1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongo_crypt_v1.so:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "7.3.0",
              "versionEndExcluding": "7.3.4",
              "matchCriteriaId": "F532507C-3BFE-4572-BFF9-231660EF723C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "5.0.0",
              "versionEndExcluding": "5.0.29",
              "matchCriteriaId": "DAEF92CF-08B5-4856-A435-6DB3B55C2CD7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "6.0.0",
              "versionEndExcluding": "6.0.17",
              "matchCriteriaId": "49E86F43-2733-48AB-AA5F-48F52039F01C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "7.0.0",
              "versionEndExcluding": "7.0.12",
              "matchCriteriaId": "E2808417-A762-4018-AF46-699F6F07B9E4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*",
              "versionStartIncluding": "7.3.0",
              "versionEndExcluding": "7.3.4",
              "matchCriteriaId": "AC25FA9D-AC61-4795-8B8C-8578F1DE6B2C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://jira.mongodb.org/browse/SERVER-96254",
      "source": "cna@mongodb.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}