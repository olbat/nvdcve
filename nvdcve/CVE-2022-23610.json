{
  "id": "CVE-2022-23610",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-03-16T18:15:11.617",
  "lastModified": "2024-11-21T06:48:55.640",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "wire-server provides back end services for Wire, an open source messenger. In versions of wire-server prior to the 2022-01-27 release, it was possible to craft DSA Signatures to bypass SAML SSO and impersonate any Wire user with SAML credentials. In teams with SAML, but without SCIM, it was possible to create new accounts with fake SAML credentials. Under certain conditions that can be established by an attacker, an upstream library for parsing, rendering, signing, and validating SAML XML data was accepting public keys as trusted that were provided by the attacker in the signature. As a consequence, the attacker could login as any user in any Wire team with SAML SSO enabled. If SCIM was not enabled, the attacker could also create new users with new SAML NameIDs. In order to exploit this vulnerability, the attacker needs to know the SSO login code (distributed to all team members with SAML credentials and visible in the Team Management app), the SAML EntityID identifying the IdP (a URL not considered sensitive, but usually hard to guess, also visible in Team Management), and the SAML NameID of the user (usually an email address or a nick). The issue has been fixed in wire-server `2022-01-27` and is already deployed on all Wire managed services. On premise instances of wire-server need to be updated to `2022-01-27`, so that their backends are no longer affected. There are currently no known workarounds. More detailed information about how to reproduce the vulnerability and mitigation strategies is available in the GitHub Security Advisory."
    },
    {
      "lang": "es",
      "value": "wire-server proporciona servicios de back-end para Wire, un mensajero de código abierto. En versiones de wire-server anteriores a 27-01-2022, era posible diseñar firmas DSA para omitir el SSO de SAML y suplantar a cualquier usuario de Wire con credenciales SAML. En equipos con SAML, pero sin SCIM, era posible crear nuevas cuentas con credenciales SAML falsas. Bajo determinadas condiciones que pueden ser establecidas por un atacante, una biblioteca upstream para analizar, renderizar, firmar y comprobar datos XML de SAML aceptaba como confiables claves públicas que eran proporcionadas por el atacante en la firma. Como consecuencia, el atacante podía iniciar sesión como cualquier usuario en cualquier equipo de Wire con SAML SSO habilitado. Si SCIM no estaba habilitado, el atacante también podía crear nuevos usuarios con nuevos NameID de SAML. Para explotar esta vulnerabilidad, el atacante necesita conocer el código de inicio de sesión de SSO (distribuido a todos los miembros del equipo con credenciales SAML y visible en la aplicación de administración de equipos), el EntityID de SAML que identifica al IdP (una URL no considerada confidencial, pero normalmente difícil de adivinar, también visible en la administración de equipos) y el NameID de SAML del usuario (normalmente una dirección de correo electrónico o un nick). El problema ha sido solucionado en wire-server \"27-01-2022\" y ya está desplegado en todos los servicios gestionados de Wire. Las instancias locales de wire-server deben ser actualizadas a \"27-01-2022\", para que sus backends no estén afectados. Actualmente no se presentan medidas de mitigación conocidas. Se presenta información más detallada sobre cómo reproducir la vulnerabilidad y las estrategias de mitigación en el aviso de seguridad de GitHub"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:H/Au:N/C:P/I:P/A:P",
          "baseScore": 5.1,
          "accessVector": "NETWORK",
          "accessComplexity": "HIGH",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 4.9,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-347"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wire:wire-server:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.123.0",
              "matchCriteriaId": "5BFE84F1-6855-4EE7-8838-39A8B374C46C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/wireapp/wire-server/releases/tag/v2022-01-27",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-server/security/advisories/GHSA-9jg9-9g37-4424",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-server/releases/tag/v2022-01-27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-server/security/advisories/GHSA-9jg9-9g37-4424",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}