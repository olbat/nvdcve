{
  "id": "CVE-2025-38331",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-07-10T09:15:27.533",
  "lastModified": "2025-07-10T13:17:30.017",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: ethernet: cortina: Use TOE/TSO on all TCP\n\nIt is desireable to push the hardware accelerator to also\nprocess non-segmented TCP frames: we pass the skb->len\nto the \"TOE/TSO\" offloader and it will handle them.\n\nWithout this quirk the driver becomes unstable and lock\nup and and crash.\n\nI do not know exactly why, but it is probably due to the\nTOE (TCP offload engine) feature that is coupled with the\nsegmentation feature - it is not possible to turn one\npart off and not the other, either both TOE and TSO are\nactive, or neither of them.\n\nNot having the TOE part active seems detrimental, as if\nthat hardware feature is not really supposed to be turned\noff.\n\nThe datasheet says:\n\n  \"Based on packet parsing and TCP connection/NAT table\n   lookup results, the NetEngine puts the packets\n   belonging to the same TCP connection to the same queue\n   for the software to process. The NetEngine puts\n   incoming packets to the buffer or series of buffers\n   for a jumbo packet. With this hardware acceleration,\n   IP/TCP header parsing, checksum validation and\n   connection lookup are offloaded from the software\n   processing.\"\n\nAfter numerous tests with the hardware locking up after\nsomething between minutes and hours depending on load\nusing iperf3 I have concluded this is necessary to stabilize\nthe hardware."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: ethernet: cortina: Usar TOE/TSO en todos los protocolos TCP. Es deseable que el acelerador de hardware también procese tramas TCP no segmentadas: pasamos el comando skb-&gt;len al descargador \"TOE/TSO\" y este las gestionará. Sin esta peculiaridad, el controlador se vuelve inestable, se bloquea y se bloquea. No sé exactamente por qué, pero probablemente se deba a la función TOE (motor de descarga TCP) que está acoplada a la función de segmentación: no es posible desactivar una parte y no la otra, ya sea que tanto TOE como TSO estén activos, o ninguno de ellos. No tener activa la función TOE parece perjudicial, como si esa función de hardware no debiera estar desactivada. La hoja de datos indica: \"Con base en el análisis de paquetes y los resultados de la búsqueda de la conexión TCP/tabla NAT, NetEngine coloca los paquetes pertenecientes a la misma conexión TCP en la misma cola para que el software los procese. NetEngine coloca los paquetes entrantes en el búfer o en una serie de búferes para un paquete jumbo. Con esta aceleración de hardware, el análisis de encabezados IP/TCP, la validación de la suma de comprobación y la búsqueda de conexión se descargan del procesamiento del software\". Tras numerosas pruebas con el hardware bloqueándose después de minutos u horas, dependiendo de la carga, utilizando iperf3, he concluido que esto es necesario para estabilizar el hardware."
    }
  ],
  "metrics": {
  },
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/1b503b790109d19710ec83c589c3ee59e95347ec",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/2bd434bb0eeb680c2b3dd6c68ca319b30cb8d47f",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/6a07e3af4973402fa199a80036c10060b922c92c",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/a37888a435b0737128d2d9c6f67b8d608f83df7a",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/ebe12e232f1d58ebb4b53b6d9149962b707bed91",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}