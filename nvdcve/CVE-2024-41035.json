{
  "id": "CVE-2024-41035",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-07-29T15:15:12.077",
  "lastModified": "2024-11-21T09:32:06.580",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: core: Fix duplicate endpoint bug by clearing reserved bits in the descriptor\n\nSyzbot has identified a bug in usbcore (see the Closes: tag below)\ncaused by our assumption that the reserved bits in an endpoint\ndescriptor's bEndpointAddress field will always be 0.  As a result of\nthe bug, the endpoint_is_duplicate() routine in config.c (and possibly\nother routines as well) may believe that two descriptors are for\ndistinct endpoints, even though they have the same direction and\nendpoint number.  This can lead to confusion, including the bug\nidentified by syzbot (two descriptors with matching endpoint numbers\nand directions, where one was interrupt and the other was bulk).\n\nTo fix the bug, we will clear the reserved bits in bEndpointAddress\nwhen we parse the descriptor.  (Note that both the USB-2.0 and USB-3.1\nspecs say these bits are \"Reserved, reset to zero\".)  This requires us\nto make a copy of the descriptor earlier in usb_parse_endpoint() and\nuse the copy instead of the original when checking for duplicates."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: USB: core: corrige el error de endpoint duplicado borrando los bits reservados en el descriptor Syzbot ha identificado un error en usbcore (consulte la etiqueta Closes: a continuación) causado por nuestra suposición de que los bits reservados en el campo bEndpointAddress de un descriptor de endpoint siempre será 0. Como resultado del error, la rutina endpoint_is_duplicate() en config.c (y posiblemente también otras rutinas) puede creer que dos descriptores son para endpoints distintos, aunque tengan la misma dirección y número de endpoint. Esto puede generar confusión, incluido el error identificado por syzbot (dos descriptores con direcciones y números de endpoint coincidentes, donde uno era de interrupción y el otro era masivo). Para corregir el error, borraremos los bits reservados en bEndpointAddress cuando analicemos el descriptor. (Tenga en cuenta que las especificaciones de USB-2.0 y USB-3.1 dicen que estos bits están \"Reservados, restablecidos a cero\"). Esto requiere que hagamos una copia del descriptor anteriormente en usb_parse_endpoint() y usemos la copia en lugar del original cuando buscando duplicados."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/2bd8534a1b83c65702aec3cab164170f8e584188",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/37514a5c1251a8c5c95c323f55050736e7069ac7",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/60abea505b726b38232a0ef410d2bd1994a77f78",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/647d61aef106dbed9c70447bcddbd4968e67ca64",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/9edcf317620d7c6a8354911b69b874cf89716646",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/a368ecde8a5055b627749b09c6218ef793043e47",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/d09dd21bb5215d583ca9a1cb1464dbc77a7e88cf",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/d8418fd083d1b90a6c007cf8dcf81aeae274727b",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/2bd8534a1b83c65702aec3cab164170f8e584188",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/37514a5c1251a8c5c95c323f55050736e7069ac7",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/60abea505b726b38232a0ef410d2bd1994a77f78",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/647d61aef106dbed9c70447bcddbd4968e67ca64",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/9edcf317620d7c6a8354911b69b874cf89716646",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/a368ecde8a5055b627749b09c6218ef793043e47",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/d09dd21bb5215d583ca9a1cb1464dbc77a7e88cf",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/d8418fd083d1b90a6c007cf8dcf81aeae274727b",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}