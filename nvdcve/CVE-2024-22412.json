{
  "id": "CVE-2024-22412",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-03-18T21:15:06.230",
  "lastModified": "2024-11-21T08:56:14.090",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "ClickHouse is an open-source column-oriented database management system. A bug exists in the cloud ClickHouse offering prior to version 24.0.2.54535 and in github.com/clickhouse/clickhouse version 23.1. Query caching bypasses the role based access controls and the policies being enforced on roles. In affected versions, the query cache only respects separate users, however this is not documented and not expected behavior. People relying on ClickHouse roles can have their access control lists bypassed if they are using query caching. Attackers who have control of a role could guess queries and see data they shouldn't have access to. Version 24.1 of ClickHouse and version 24.0.2.54535 of ClickHouse Cloud contain a patch for this issue. Based on the documentation, role based access control should be enforced regardless if query caching is enabled or not."
    },
    {
      "lang": "es",
      "value": "ClickHouse es un sistema de gestión de bases de datos orientado a columnas de código abierto. Existe un error en la oferta de nube de ClickHouse anterior a la versión 24.0.2.54535 y en github.com/clickhouse/clickhouse versión 23.1. El almacenamiento en caché de consultas evita los controles de acceso basados en roles y las políticas que se aplican a los roles. En las versiones afectadas, la caché de consultas solo respeta a usuarios separados; sin embargo, esto no está documentado ni es un comportamiento esperado. Las personas que dependen de roles de ClickHouse pueden evitar sus listas de control de acceso si utilizan el almacenamiento en caché de consultas. Los atacantes que tienen control de una función podrían adivinar consultas y ver datos a los que no deberían tener acceso. La versión 24.1 de ClickHouse y la versión 24.0.2.54535 de ClickHouse Cloud contienen un parche para este problema. Según la documentación, se debe aplicar el control de acceso basado en roles independientemente de si el almacenamiento en caché de consultas está habilitado o no."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 2.4,
          "baseSeverity": "LOW",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 0.9,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/ClickHouse/ClickHouse/blob/bd17ee769e337906c4b1f404861e042ad72fcbfc/src/Interpreters/executeQuery.cpp#L1013-L1015",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/ClickHouse/ClickHouse/pull/58611",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/ClickHouse/ClickHouse/blob/bd17ee769e337906c4b1f404861e042ad72fcbfc/src/Interpreters/executeQuery.cpp#L1013-L1015",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/ClickHouse/ClickHouse/pull/58611",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}