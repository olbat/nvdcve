{
  "id": "CVE-2024-7594",
  "sourceIdentifier": "security@hashicorp.com",
  "published": "2024-09-26T20:15:07.687",
  "lastModified": "2025-08-08T01:47:11.170",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15."
    },
    {
      "lang": "es",
      "value": "El motor de secretos SSH de Vault no requería que la lista valid_principals contuviera un valor de manera predeterminada. Si los campos valid_principals y default_user de la configuración del motor de secretos SSH no están configurados, un certificado SSH solicitado por un usuario autorizado al motor de secretos SSH de Vault podría usarse para autenticarse como cualquier usuario en el host. Se corrigió en Vault Community Edition 1.17.6 y en Vault Enterprise 1.17.6, 1.16.10 y 1.15.15."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@hashicorp.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@hashicorp.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-732"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.7.7",
              "versionEndExcluding": "1.15.15",
              "matchCriteriaId": "249707D4-F472-4111-AD3B-87BB8FBAC1A5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "1.7.7",
              "versionEndExcluding": "1.17.6",
              "matchCriteriaId": "083F9267-6753-4849-91F5-5B07CF366433"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.16.0",
              "versionEndExcluding": "1.16.10",
              "matchCriteriaId": "8E3ED5F4-F345-4626-8073-56C6EDC4E358"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.17.0",
              "versionEndExcluding": "1.17.6",
              "matchCriteriaId": "1AD9A7FA-38F6-48DE-9158-84D4B5AA2F7D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251",
      "source": "security@hashicorp.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20250110-0007/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}