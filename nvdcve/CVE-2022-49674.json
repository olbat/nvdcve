{
  "id": "CVE-2022-49674",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-02-26T07:01:42.320",
  "lastModified": "2025-02-26T07:01:42.320",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm raid: fix accesses beyond end of raid member array\n\nOn dm-raid table load (using raid_ctr), dm-raid allocates an array\nrs->devs[rs->raid_disks] for the raid device members. rs->raid_disks\nis defined by the number of raid metadata and image tupples passed\ninto the target's constructor.\n\nIn the case of RAID layout changes being requested, that number can be\ndifferent from the current number of members for existing raid sets as\ndefined in their superblocks. Example RAID layout changes include:\n- raid1 legs being added/removed\n- raid4/5/6/10 number of stripes changed (stripe reshaping)\n- takeover to higher raid level (e.g. raid5 -> raid6)\n\nWhen accessing array members, rs->raid_disks must be used in control\nloops instead of the potentially larger value in rs->md.raid_disks.\nOtherwise it will cause memory access beyond the end of the rs->devs\narray.\n\nFix this by changing code that is prone to out-of-bounds access.\nAlso fix validate_raid_redundancy() to validate all devices that are\nadded. Also, use braces to help clean up raid_iterate_devices().\n\nThe out-of-bounds memory accesses was discovered using KASAN.\n\nThis commit was verified to pass all LVM2 RAID tests (with KASAN\nenabled)."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: dm raid: se corrigen los accesos más allá del final de la matriz de miembros raid Al cargar la tabla dm-raid (usando raid_ctr), dm-raid asigna una matriz rs-&gt;devs[rs-&gt;raid_disks] para los miembros del dispositivo raid. rs-&gt;raid_disks se define por la cantidad de metadatos raid y tuplas de imágenes pasadas al constructor del objetivo. En el caso de que se soliciten cambios en el diseño RAID, ese número puede ser diferente del número actual de miembros para los conjuntos raid existentes según lo definido en sus superbloques. Los ejemplos de cambios en el diseño RAID incluyen: - patas raid1 que se agregan/eliminan - número de franjas raid4/5/6/10 cambiado (remodelación de franjas) - toma de control a un nivel raid más alto (por ejemplo, raid5 -&gt; raid6) Al acceder a los miembros de la matriz, se debe usar rs-&gt;raid_disks en bucles de control en lugar del valor potencialmente más grande en rs-&gt;md.raid_disks. De lo contrario, se producirá un acceso a la memoria más allá del final de la matriz rs-&gt;devs. Solucione esto modificando el código que es propenso a accesos fuera de los límites. También corrija validation_raid_redundancy() para validar todos los dispositivos que se agregan. Además, use llaves para ayudar a limpiar raid_iterate_devices(). Los accesos a la memoria fuera de los límites se descubrieron utilizando KASAN. Se verificó que esta confirmación pasara todas las pruebas RAID LVM2 (con KASAN habilitado)."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/332bd0778775d0cf105c4b9e03e460b590749916",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/5e161a8826b63c0b8b43e4a7fad1f956780f42ab",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/6352b2f4d8e95ec0ae576d7705435d64cfa29503",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/90de15357504c8097ab29769dc6852e16281e9e8",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/9bf2b0757b04c78dc5d6e3a198acca98457b32a1",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/bcff98500ea3b4e7615ec31d2bdd326bc1ef5134",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/df1a5ab0dd0775f2ea101c71f2addbc4c0ea0f85",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}