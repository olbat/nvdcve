{
  "id": "CVE-2024-5478",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-06-06T19:16:08.933",
  "lastModified": "2024-11-21T09:47:45.637",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "A Cross-site Scripting (XSS) vulnerability exists in the SAML metadata endpoint `/auth/saml/${org?.id}/metadata` of lunary-ai/lunary version 1.2.7. The vulnerability arises due to the application's failure to escape or validate the `orgId` parameter supplied by the user before incorporating it into the generated response. Specifically, the endpoint generates XML responses for SAML metadata, where the `orgId` parameter is directly embedded into the XML structure without proper sanitization or validation. This flaw allows an attacker to inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de Cross-site Scripting (XSS) en el endpoint de metadatos SAML `/auth/saml/${org?.id}/metadata` de lunary-ai/lunary versión 1.2.7. La vulnerabilidad surge debido a que la aplicación no logra escapar o validar el parámetro `orgId` proporcionado por el usuario antes de incorporarlo a la respuesta generada. Específicamente, el endpoint genera respuestas XML para metadatos SAML, donde el parámetro `orgId` está directamente incrustado en la estructura XML sin una sanitización o validación adecuada. Esta falla permite a un atacante inyectar código JavaScript arbitrario en la página de metadatos SAML generada, lo que lleva a un posible robo de cookies o tokens de autenticación del usuario."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      }
    ],
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
          "baseScore": 7.4,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lunary:lunary:1.2.7:*:*:*:*:*:*:*",
              "matchCriteriaId": "2C7BA1F3-A202-4EB0-A119-9DD2B776A50F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ]
}