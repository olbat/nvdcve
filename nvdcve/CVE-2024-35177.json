{
  "id": "CVE-2024-35177",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2025-02-03T22:15:27.600",
  "lastModified": "2025-09-16T17:18:46.207",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Wazuh is a free and open source platform used for threat prevention, detection, and response. It is capable of protecting workloads across on-premises, virtualized, containerized, and cloud-based environments. The wazuh-agent for Windows is vulnerable to a Local Privilege Escalation vulnerability due to improper ACL of the non-default installation directory. A local malicious user could potentially exploit this vulnerability by placing one of the many DLL that are loaded and not present on the system in the installation folder of the agent OR by replacing the service executable binary itself with a malicious one. The root cause is an improper ACL applied on the installation folder when a non-default installation path is specified (e.g,: C:\\wazuh). Many DLLs are loaded from the installation folder and by creating a malicious DLLs that exports the functions of a legit one (and that is not found on the system where the agent is installed, such as rsync.dll) it is possible to escalate privileges from a low-privileged user and obtain code execution under the context of NT AUTHORITY\\SYSTEM. This issue has been addressed in version 4.9.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Wazuh es una plataforma gratuita y de código abierto que se utiliza para la prevención, detección y respuesta ante amenazas. Es capaz de proteger cargas de trabajo en entornos locales, virtualizados, en contenedores y basados ??en la nube. El agente wazuh para Windows es vulnerable a una vulnerabilidad de escalada de privilegios locales debido a una ACL incorrecta del directorio de instalación no predeterminado. Un usuario malintencionado local podría explotar esta vulnerabilidad colocando una de las muchas DLL que están cargadas y no están presentes en sistema en la carpeta de instalación del agente O reemplazando el binario ejecutable del servicio por uno malintencionado. La causa principal es una ACL incorrecta aplicada en la carpeta de instalación cuando se especifica una ruta de instalación no predeterminada (p. ej., C:\\wazuh). Muchas DLL se cargan desde la carpeta de instalación y, al crear una DLL maliciosa que exporta las funciones de una legítima (y que no se encuentra en el directorio sistema donde está instalado el agente, como rsync.dll), es posible escalar privilegios de un usuario con pocos privilegios y obtener la ejecución de código en el contexto de NT AUsistemaY\\SYSTEM. Este problema se ha solucionado en la versión 4.9.0 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-284"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wazuh:wazuh:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.0.0",
              "versionEndExcluding": "4.9.0",
              "matchCriteriaId": "2C44B1C4-5B93-48AA-9FCB-98D99E55D6CD"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/wazuh/wazuh/security/advisories/GHSA-pmr2-2r83-h3cv",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}