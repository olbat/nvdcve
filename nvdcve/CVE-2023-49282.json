{
  "id": "CVE-2023-49282",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-12-05T23:15:07.063",
  "lastModified": "2024-11-21T08:33:10.813",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "msgraph-sdk-php is the Microsoft Graph Library for PHP. The Microsoft Graph PHP SDK published packages which contained test code that enabled the use of the phpInfo() function from any application that could access and execute the file at vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php.  The phpInfo function exposes system information. The vulnerability affects the GetPhpInfo.php script of the PHP SDK which contains a call to the phpinfo() function. This vulnerability requires a misconfiguration of the server to be present so it can be exploited. For example, making the PHP application’s /vendor directory web accessible. The combination of the vulnerability and the server misconfiguration would allow an attacker to craft an HTTP request that executes the phpinfo() method. The attacker would then be able to get access to system information like configuration, modules, and environment variables and later on use the compromised secrets to access additional data. This problem has been patched in versions 1.109.1 and 2.0.0-RC5. If an immediate deployment with the updated vendor package is not available, you can perform the following temporary workarounds: delete the `vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php` file, remove access to the `/vendor` directory, or disable the phpinfo function."
    },
    {
      "lang": "es",
      "value": "msgraph-sdk-php es la librería de Microsoft Graph para PHP. El SDK PHP de Microsoft Graph publicó paquetes que contenían código de prueba que permitía el uso de la función phpInfo() desde cualquier aplicación que pudiera acceder y ejecutar el archivo en proveedor/microsoft/microsoft-graph/tests/GetPhpInfo.php. La función phpInfo expone información del sistema. La vulnerabilidad afecta al script GetPhpInfo.php del SDK de PHP que contiene una llamada a la función phpinfo(). Esta vulnerabilidad requiere que esté presente una mala configuración del servidor para poder explotarla. Por ejemplo, hacer que el directorio web/proveedor de la aplicación PHP sea accesible. La combinación de la vulnerabilidad y la mala configuración del servidor permitiría a un atacante crear una solicitud HTTP que ejecute el método phpinfo(). Luego, el atacante podría obtener acceso a información del sistema, como configuración, módulos y variables de entorno, y luego utilizar los secretos comprometidos para acceder a datos adicionales. Este problema se solucionó en las versiones 1.109.1 y 2.0.0-RC5. Si no está disponible una implementación inmediata con el paquete de proveedor actualizado, puede realizar las siguientes soluciones temporales: eliminar el archivo `vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php`, eliminar el acceso al directorio `/vendor`, o deshabilite la función phpinfo."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.5
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:graph:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.16.0",
              "versionEndExcluding": "1.109.1",
              "matchCriteriaId": "C94B1CEC-103C-4159-8F20-DE2FC607E9D7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:graph:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.0.0",
              "versionEndExcluding": "2.0.1",
              "matchCriteriaId": "E3322A59-46DB-4D0E-B56F-D3F9E14AF180"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/microsoftgraph/msgraph-beta-sdk-php/compare/2.0.0...2.0.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php-core/compare/2.0.1...2.0.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php/compare/1.109.0...1.109.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php/security/advisories/GHSA-cgwq-6prq-8h9q",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-beta-sdk-php/compare/2.0.0...2.0.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php-core/compare/2.0.1...2.0.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php/compare/1.109.0...1.109.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/microsoftgraph/msgraph-sdk-php/security/advisories/GHSA-cgwq-6prq-8h9q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}