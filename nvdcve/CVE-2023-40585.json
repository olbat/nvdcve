{
  "id": "CVE-2023-40585",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-08-25T21:15:09.103",
  "lastModified": "2024-11-21T08:19:46.010",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "ironic-image is a container image to run OpenStack Ironic as part of Metal³. Prior to version capm3-v1.4.3, if Ironic is not deployed with TLS and it does not have API and Conductor split into separate services, access to the API is not protected by any authentication. Ironic API is also listening in host network. In case the node is not behind a firewall, the API could be accessed by anyone via network without authentication. By default, Ironic API in Metal3 is protected by TLS and basic authentication, so this vulnerability requires operator to configure API without TLS for it to be vulnerable. TLS and authentication however should not be coupled as they are in versions prior to capm3-v1.4.3. A patch exists in versions capm3-v1.4.3 and newer. Some workarounds are available. Either configure TLS for Ironic API (`deploy.sh -t ...`, `IRONIC_TLS_SETUP=true`) or split Ironic API and Conductor via configuration change (old implementation, not recommended). With both workarounds, services are configured with httpd front-end, which has proper authentication configuration in place."
    },
    {
      "lang": "es",
      "value": "ironic-image es una imagen de contenedor para ejecutar OpenStack Ironic como parte de Metal³. Antes de la versión capm3-v1.4.3, si Ironic no se despliega con TLS y no tiene API y Conductor divididos en servicios separados, el acceso a la API no está protegido por ninguna autenticación. Ironic API también está a la escucha en la red del host. En caso de que el nodo no esté detrás de un cortafuegos, cualquiera podría acceder a la API a través de la red sin autenticación. Por defecto, la API Ironic en Metal3 está protegida por TLS y autenticación básica, por lo que esta vulnerabilidad requiere que el operador configure la API sin TLS para que sea vulnerable. Sin embargo, TLS y autenticación no deberían estar acoplados tal y como están en versiones anteriores a capm3-v1.4.3. Existe un parche en las versiones capm3-v1.4.3 y posteriores. Algunas soluciones están disponibles. Configure TLS para Ironic API (`deploy.sh -t ...`, `IRONIC_TLS_SETUP=true`) o divida Ironic API y Conductor mediante un cambio en la configuración (implementación antigua, no recomendada). Con ambas soluciones, los servicios se configuran con httpd front-end, que tiene la configuración de autenticación adecuada.\n"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
          "baseScore": 7.3,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-306"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metal3:ironic-image:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.4.3",
              "matchCriteriaId": "27B0C984-15D2-41CB-AA20-456063F11DED"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/metal3-io/ironic-image/commit/f64bb6ce0945bbfb30d9965f98149ea183311de9",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metal3-io/ironic-image/security/advisories/GHSA-jwpr-9fwh-m4g7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/metal3-io/ironic-image/commit/f64bb6ce0945bbfb30d9965f98149ea183311de9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metal3-io/ironic-image/security/advisories/GHSA-jwpr-9fwh-m4g7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}