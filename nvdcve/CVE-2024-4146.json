{
  "id": "CVE-2024-4146",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-06-08T20:15:52.117",
  "lastModified": "2024-11-21T09:42:16.633",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In lunary-ai/lunary version v1.2.13, an incorrect authorization vulnerability exists that allows unauthorized users to access and manipulate projects within an organization they should not have access to. Specifically, the vulnerability is located in the `checkProjectAccess` method within the authorization middleware, which fails to adequately verify if a user has the correct permissions to access a specific project. Instead, it only checks if the user is part of the organization owning the project, overlooking the necessary check against the `account_project` table for explicit project access rights. This flaw enables attackers to gain complete control over all resources within a project, including the ability to create, update, read, and delete any resource, compromising the privacy and security of sensitive information."
    },
    {
      "lang": "es",
      "value": "En lunary-ai/lunary versión v1.2.13, existe una vulnerabilidad de autorización inadecuada que permite a usuarios no autorizados acceder y manipular proyectos dentro de una organización a la que no deberían tener acceso. Específicamente, la vulnerabilidad se ubica en el método `checkProjectAccess` dentro del middleware de autorización, que no logra verificar adecuadamente si un usuario tiene los permisos correctos para acceder a un proyecto específico. En cambio, solo verifica si el usuario es parte de la organización propietaria del proyecto, pasando por alto la verificación necesaria en la tabla `account_project` para obtener derechos de acceso explícitos al proyecto. Esta falla permite a los atacantes obtener control total sobre todos los recursos dentro de un proyecto, incluida la capacidad de crear, actualizar, leer y eliminar cualquier recurso, comprometiendo la privacidad y seguridad de la información confidencial."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lunary:lunary:1.2.13:*:*:*:*:*:*:*",
              "matchCriteriaId": "7223CE59-4E84-4008-9E35-D2B9D25ADD1E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ]
}