{
  "id": "CVE-2024-6468",
  "sourceIdentifier": "security@hashicorp.com",
  "published": "2024-07-11T21:15:12.910",
  "lastModified": "2025-08-13T14:01:26.470",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Vault and Vault Enterprise did not properly handle requests originating from unauthorized IP addresses when the TCP listener option, proxy_protocol_behavior, was set to deny_unauthorized. When receiving a request from a source IP address that was not listed in proxy_protocol_authorized_addrs, the Vault API server would shut down and no longer respond to any HTTP requests, potentially resulting in denial of service.\n\nWhile this bug also affected versions of Vault up to 1.17.1 and 1.16.5, a separate regression in those release series did not allow Vault operators to configure the deny_unauthorized option, thus not allowing the conditions for the denial of service to occur.\n\nFixed in Vault and Vault Enterprise 1.17.2, 1.16.6, and 1.15.12."
    },
    {
      "lang": "es",
      "value": "Vault y Vault Enterprise no manejaron adecuadamente las solicitudes originadas en direcciones IP no autorizadas cuando la opción de escucha TCP, proxy_protocol_behavior, estaba configurada en deny_unauthorized. Al recibir una solicitud de una dirección IP de origen que no figuraba en proxy_protocol_authorized_addrs, el servidor API de Vault se cerraba y ya no respondía a ninguna solicitud HTTP, lo que podría provocar una denegación de servicio. Si bien este error también afectó a las versiones de Vault hasta 1.17.1 y 1.16.5, una regresión separada en esas series de versiones no permitió a los operadores de Vault configurar la opción deny_unauthorized, por lo que no permitió que se cumplieran las condiciones para la denegación de servicio. Corregido en Vault y Vault Enterprise 1.17.2, 1.16.6 y 1.15.12."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@hashicorp.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@hashicorp.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-703"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "1.10.0",
              "versionEndExcluding": "1.15.12",
              "matchCriteriaId": "556F7539-CE03-4690-A690-AC5D705E678D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.10.0",
              "versionEndExcluding": "1.15.12",
              "matchCriteriaId": "E8F51B50-9733-453B-851D-D28049A37E47"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "1.16.0",
              "versionEndExcluding": "1.16.6",
              "matchCriteriaId": "71BB3633-B32C-47DC-8A98-5F3D5500DFB2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.16.0",
              "versionEndExcluding": "1.16.6",
              "matchCriteriaId": "CB481DAE-4459-4FCA-8FDC-52D859C28DE5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "1.17.0",
              "versionEndExcluding": "1.17.2",
              "matchCriteriaId": "77FC87EB-61C9-46B4-8D4F-48FEC97D1287"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.17.0",
              "versionEndExcluding": "1.17.2",
              "matchCriteriaId": "FD67FD87-14B9-4BD9-8187-2E3235ADAD62"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-14-vault-vulnerable-to-denial-of-service-when-setting-a-proxy-protocol-behavior/68518",
      "source": "security@hashicorp.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-14-vault-vulnerable-to-denial-of-service-when-setting-a-proxy-protocol-behavior/68518",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}