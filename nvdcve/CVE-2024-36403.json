{
  "id": "CVE-2024-36403",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2025-01-16T20:15:32.197",
  "lastModified": "2025-08-20T15:19:29.360",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Matrix Media Repo (MMR) is a highly configurable multi-homeserver media repository for Matrix. MMR before version 1.3.5 is vulnerable to unbounded disk consumption, where an unauthenticated adversary can induce it to download and cache large amounts of remote media files. MMR's typical operating environment uses S3-like storage as a backend, with file-backed store as an alternative option. Instances using a file-backed store or those which self-host an S3 storage system are therefore vulnerable to a disk fill attack. Once the disk is full, authenticated users will be unable to upload new media, resulting in denial of service. For instances configured to use a cloud-based S3 storage option, this could result in high service fees instead of a denial of service. MMR 1.3.5 introduces a new default-on \"leaky bucket\" rate limit to reduce the amount of data a user can request at a time. This does not fully address the issue, but does limit an unauthenticated user's ability to request large amounts of data. Operators should note that the leaky bucket implementation introduced in MMR 1.3.5 requires the IP address associated with the request to be forwarded, to avoid mistakenly applying the rate limit to the reverse proxy instead. To avoid this issue, the reverse proxy should populate the X-Forwarded-For header when sending the request to MMR. Operators who cannot update may wish to lower the maximum file size they allow and implement harsh rate limits, though this can still lead to a large amount of data to be downloaded."
    },
    {
      "lang": "es",
      "value": "Matrix Media Repo (MMR) es un repositorio multimedia para múltiples servidores domésticos altamente configurable para Matrix. MMR anterior a la versión 1.3.5 es vulnerable al consumo ilimitado de disco, donde un adversario no autenticado puede inducirlo a descargar y almacenar en caché grandes cantidades de archivos multimedia remotos. El entorno operativo típico de MMR utiliza un almacenamiento similar a S3 como backend, con un almacenamiento respaldado por archivos como una opción alternativa. Las instancias que utilizan un almacenamiento respaldado por archivos o aquellas que alojan por sí mismas un sistema de almacenamiento S3 son, por lo tanto, vulnerables a un ataque de llenado de disco. Una vez que el disco está lleno, los usuarios autenticados no podrán cargar nuevos medios, lo que resultará en una denegación de servicio. Para las instancias configuradas para utilizar una opción de almacenamiento S3 basada en la nube, esto podría resultar en altas tarifas de servicio en lugar de una denegación de servicio. MMR 1.3.5 introduce un nuevo límite de tasa de \"depósito con fugas\" predeterminado para reducir la cantidad de datos que un usuario puede solicitar a la vez. Esto no resuelve el problema por completo, pero limita la capacidad de un usuario no autenticado de solicitar grandes cantidades de datos. Los operadores deben tener en cuenta que la implementación del contenedor con fugas introducida en MMR 1.3.5 requiere que se reenvíe la dirección IP asociada con la solicitud, para evitar aplicar por error el límite de velocidad al proxy inverso. Para evitar este problema, el proxy inverso debe completar el encabezado X-Forwarded-For al enviar la solicitud a MMR. Los operadores que no pueden actualizar pueden desear reducir el tamaño máximo de archivo que permiten e implementar límites de velocidad estrictos, aunque esto puede dar lugar a que se descargue una gran cantidad de datos."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-770"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:t2bot:matrix-media-repo:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.3.5",
              "matchCriteriaId": "0B2BD7DE-DC40-4CC9-89A7-40F3AEDBE012"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://en.wikipedia.org/wiki/Leaky_bucket#As_a_meter",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/t2bot/matrix-media-repo/security/advisories/GHSA-vc2m-hw89-qjxf",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}