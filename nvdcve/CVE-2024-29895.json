{
  "id": "CVE-2024-29895",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-05-14T15:17:15.593",
  "lastModified": "2024-11-21T09:08:34.137",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Cacti provides an operational monitoring and fault management framework. A command injection vulnerability on the 1.3.x DEV branch allows any unauthenticated user to execute arbitrary command on the server when `register_argc_argv` option of PHP is `On`. In `cmd_realtime.php` line 119, the `$poller_id` used as part of the command execution is sourced from `$_SERVER['argv']`, which can be controlled by URL when `register_argc_argv` option of PHP is `On`. And this option is `On` by default in many environments such as the main PHP Docker image for PHP. Commit 53e8014d1f082034e0646edc6286cde3800c683d contains a patch for the issue, but this commit was reverted in commit 99633903cad0de5ace636249de16f77e57a3c8fc."
    },
    {
      "lang": "es",
      "value": "Cacti proporciona un framework de monitoreo operativo y gestión de fallas. Una vulnerabilidad de inyección de comandos en la rama DEV 1.3.x permite que cualquier usuario no autenticado ejecute comandos arbitrarios en el servidor cuando la opción `register_argc_argv` de PHP está `activada`. En la línea 119 de `cmd_realtime.php`, el `$poller_id` usado como parte de la ejecución del comando proviene de `$_SERVER['argv']`, que puede controlarse mediante URL cuando la opción `register_argc_argv` de PHP está activada. `. Y esta opción está \"activada\" de forma predeterminada en muchos entornos, como la imagen principal de PHP Docker para PHP. el commit 53e8014d1f082034e0646edc6286cde3800c683d contiene un parche para el problema, pero este commit se revirtió en el commit 99633903cad0de5ace636249de16f77e57a3c8fc."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-77"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Cacti/cacti/blob/501712998589763d411a68d35e3cda98fd9cfd18/cmd_realtime.php#L119",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/53e8014d1f082034e0646edc6286cde3800c683d",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/99633903cad0de5ace636249de16f77e57a3c8fc",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cr28-x256-xf5m",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/Cacti/cacti/blob/501712998589763d411a68d35e3cda98fd9cfd18/cmd_realtime.php#L119",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/53e8014d1f082034e0646edc6286cde3800c683d",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/99633903cad0de5ace636249de16f77e57a3c8fc",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cr28-x256-xf5m",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}