{
  "id": "CVE-2024-10978",
  "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
  "published": "2024-11-14T13:15:04.217",
  "lastModified": "2025-02-20T15:41:14.847",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Incorrect privilege assignment in PostgreSQL allows a less-privileged application user to view or change different rows from those intended.  An attack requires the application to use SET ROLE, SET SESSION AUTHORIZATION, or an equivalent feature.  The problem arises when an application query uses parameters from the attacker or conveys query results to the attacker.  If that query reacts to current_setting('role') or the current user ID, it may modify or return data as though the session had not used SET ROLE or SET SESSION AUTHORIZATION.  The attacker does not control which incorrect user ID applies.  Query text from less-privileged sources is not a concern here, because SET ROLE and SET SESSION AUTHORIZATION are not sandboxes for unvetted queries.  Versions before PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21 are affected."
    },
    {
      "lang": "es",
      "value": "La asignación incorrecta de privilegios en PostgreSQL permite que un usuario de la aplicación con menos privilegios vea o cambie filas distintas a las previstas. Un ataque requiere que la aplicación utilice SET ROLE, SET SESSION AUTHORIZATION o una función equivalente. El problema surge cuando una consulta de la aplicación utiliza parámetros del atacante o transmite los resultados de la consulta al atacante. Si esa consulta reacciona a current_setting('role') o al ID de usuario actual, puede modificar o devolver datos como si la sesión no hubiera utilizado SET ROLE o SET SESSION AUTHORIZATION. El atacante no controla qué ID de usuario incorrecto se aplica. El texto de la consulta de fuentes con menos privilegios no es un problema aquí, porque SET ROLE y SET SESSION AUTHORIZATION no son entornos aislados para consultas no verificadas. Las versiones anteriores a PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17 y 12.21 se ven afectadas."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N",
          "baseScore": 4.2,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.5
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N",
          "baseScore": 4.2,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-266"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "12.0",
              "versionEndExcluding": "12.21",
              "matchCriteriaId": "433D59A0-8811-4DDB-A9F7-D85C62F905CC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "13.0",
              "versionEndExcluding": "13.17",
              "matchCriteriaId": "380F8048-FBE5-4606-93A3-915CFD229317"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "14.0",
              "versionEndExcluding": "14.14",
              "matchCriteriaId": "FACF31C7-3B20-4BAE-A596-9C59D67406D8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "15.0",
              "versionEndExcluding": "15.9",
              "matchCriteriaId": "DF12F1A2-3179-4DAC-B728-038B94954DC7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "16.0",
              "versionEndExcluding": "16.5",
              "matchCriteriaId": "353CBD91-FC28-4DA3-B79A-F4F4DC80FA93"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:17.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "554F297F-6688-4242-9618-40A3A017D246"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:17.0:beta1:*:*:*:*:*:*",
              "matchCriteriaId": "2012E2E6-9A7A-4EA8-AE7C-5CB3486CE9DA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:17.0:beta2:*:*:*:*:*:*",
              "matchCriteriaId": "354785D4-62F8-49C6-BFE6-D7AFEF7BE28F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:17.0:beta3:*:*:*:*:*:*",
              "matchCriteriaId": "EB5B99AA-AEDF-4730-824E-3A09D47B19DE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:17.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "9C88EECA-C66E-4FCF-BA4A-7581516B2471"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://www.postgresql.org/support/security/CVE-2024-10978/",
      "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/11/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://www.postgresql.org/message-id/173171334532.1547978.1518068370217143844%40wrigleys.postgresql.org",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    }
  ]
}