{
  "id": "CVE-2025-21870",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-03-27T14:15:48.543",
  "lastModified": "2025-03-27T16:45:12.210",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nASoC: SOF: ipc4-topology: Harden loops for looking up ALH copiers\n\nOther, non DAI copier widgets could have the same  stream name (sname) as\nthe ALH copier and in that case the copier->data is NULL, no alh_data is\nattached, which could lead to NULL pointer dereference.\nWe could check for this NULL pointer in sof_ipc4_prepare_copier_module()\nand avoid the crash, but a similar loop in sof_ipc4_widget_setup_comp_dai()\nwill miscalculate the ALH device count, causing broken audio.\n\nThe correct fix is to harden the matching logic by making sure that the\n1. widget is a DAI widget - so dai = w->private is valid\n2. the dai (and thus the copier) is ALH copier"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ASoC: SOF: ipc4-topology: Bucles reforzados para la búsqueda de copiadores ALH. Otros widgets de copiadores no DAI podrían tener el mismo nombre de flujo (sname) que el copiador ALH y, en ese caso, copier-&gt;data es NULL, sin alh_data adjunto, lo que podría provocar una desreferencia de puntero NULL. Podríamos comprobar este puntero NULL en sof_ipc4_prepare_copier_module() y evitar el fallo, pero un bucle similar en sof_ipc4_widget_setup_comp_dai() calcularía erróneamente el número de dispositivos ALH, lo que provocaría un audio interrumpido. La solución correcta es reforzar la lógica de coincidencia asegurándose de que: 1. el widget sea un widget DAI, por lo que dai = w-&gt;private es válido; 2. el dai (y, por lo tanto, el copiador) sea un copiador ALH."
    }
  ],
  "metrics": {
  },
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/6fd60136d256b3b948333ebdb3835f41a95ab7ef",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/87c8768a96092ce75cd47fe076db5080db7ac515",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/93c6c2e5801aab09ef1ef99f248f3cd323c3f152",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}