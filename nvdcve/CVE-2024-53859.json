{
  "id": "CVE-2024-53859",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-11-27T22:15:05.673",
  "lastModified": "2024-11-27T22:15:05.673",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "go-gh is a Go module for interacting with the `gh` utility and the GitHub API from the command line. A security vulnerability has been identified in `go-gh` that could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace. `go-gh` sources authentication tokens from different environment variables depending on the host involved: 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`, `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost` could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful exploitation could send authentication token to an unintended host. This issue has been addressed in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate authentication tokens and to review their personal security log and any relevant audit logs for actions associated with their account or enterprise."
    },
    {
      "lang": "es",
      "value": "go-gh es un módulo Go para interactuar con la utilidad `gh` y la API de GitHub desde la línea de comandos. Se ha identificado una vulnerabilidad de seguridad en `go-gh` que podría filtrar tokens de autenticación destinados a hosts de GitHub a hosts que no sean de GitHub cuando se está dentro de un espacio de código. `go-gh` obtiene tokens de autenticación de diferentes variables de entorno según el host involucrado: 1. `GITHUB_TOKEN`, `GH_TOKEN` para GitHub.com y ghe.com y 2. `GITHUB_ENTERPRISE_TOKEN`, `GH_ENTERPRISE_TOKEN` para GitHub Enterprise Server. Antes de la versión `2.11.1`, `auth.TokenForHost` podía obtener un token de la variable de entorno `GITHUB_TOKEN` para un host que no fuera GitHub.com o ghe.com cuando se estaba dentro de un espacio de código. En la versión `2.11.1`, `auth.TokenForHost` solo obtendrá un token de la variable de entorno `GITHUB_TOKEN` para los hosts de GitHub.com o ghe.com. Una explotación exitosa podría enviar el token de autenticación a un host no deseado. Este problema se ha solucionado en la versión 2.11.1 y se recomienda a todos los usuarios que actualicen. También se recomienda a los usuarios que vuelvan a generar los tokens de autenticación y que revisen su registro de seguridad personal y cualquier registro de auditoría relevante para las acciones asociadas con su cuenta o empresa."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 5.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh",
      "source": "security-advisories@github.com"
    }
  ]
}