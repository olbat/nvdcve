{
  "id": "CVE-2021-41571",
  "sourceIdentifier": "security@apache.org",
  "published": "2022-02-01T13:15:09.663",
  "lastModified": "2024-11-21T06:26:27.173",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "In Apache Pulsar it is possible to access data from BookKeeper that does not belong to the topics accessible by the authenticated user. The Admin API get-message-by-id requires the user to input a topic and a ledger id. The ledger id is a pointer to the data, and it is supposed to be a valid it for the topic. Authorisation controls are performed against the topic name and there is not proper validation the that ledger id is valid in the context of such ledger. So it may happen that the user is able to read from a ledger that contains data owned by another tenant. This issue affects Apache Pulsar Apache Pulsar version 2.8.0 and prior versions; Apache Pulsar version 2.7.3 and prior versions; Apache Pulsar version 2.6.4 and prior versions."
    },
    {
      "lang": "es",
      "value": "En Apache Pulsar es posible acceder a datos de BookKeeper que no pertenecen a los temas accesibles por el usuario autenticado. La API de administración get-message-by-id requiere que el usuario introduzca un tema y un ledger id. El identificador del libro mayor es un puntero a los datos, y supone que es válido para el tema. Los controles de autorización son llevados a cabo contra el nombre del tema y no se presenta una comprobación apropiada de que el ID del libro mayor sea válido en el contexto de dicho libro mayor. Por lo tanto, puede ocurrir que el usuario sea capaz de leer de un libro mayor que contiene datos que pertenecen a otro inquilino. Este problema afecta a Apache Pulsar versiones 2.8.0 y anteriores; Apache Pulsar versiones 2.7.3 y anteriores; Apache Pulsar versiones 2.6.4 y anteriores"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N",
          "baseScore": 4.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.6.0",
              "versionEndExcluding": "2.6.4",
              "matchCriteriaId": "E7316A0A-1852-4DD2-926A-06FEA7D1D2FA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.7.0",
              "versionEndExcluding": "2.7.3",
              "matchCriteriaId": "66FA9B80-0C01-492B-83B1-728214C6C810"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:2.8.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "D500E36D-2790-4ADB-B635-04223242421B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/apache/pulsar/issues/11814",
      "source": "security@apache.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId",
      "source": "security@apache.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/apache/pulsar/issues/11814",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}