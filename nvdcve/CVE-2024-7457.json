{
  "id": "CVE-2024-7457",
  "sourceIdentifier": "41c37e40-543d-43a2-b660-2fee83ea851a",
  "published": "2025-06-11T00:15:23.740",
  "lastModified": "2025-06-12T16:06:20.180",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "The ws.stash.app.mac.daemon.helper tool contains a vulnerability caused by an incorrect use of macOS’s authorization model. Instead of validating the client's authorization reference, the helper invokes AuthorizationCopyRights() using its own privileged context (root), effectively authorizing itself rather than the client. As a result, it grants the system.preferences.admin right internally, regardless of the requesting client's privileges. This flawed logic allows unprivileged clients to invoke privileged operations via XPC, including unauthorized changes to system-wide network preferences such as SOCKS, HTTP, and HTTPS proxy settings. The absence of proper code-signing checks further enables arbitrary processes to exploit this flaw, leading to man-in-the-middle (MITM) attacks through traffic redirection."
    },
    {
      "lang": "es",
      "value": "La herramienta ws.stash.app.mac.daemon.helper contiene una vulnerabilidad causada por un uso incorrecto del modelo de autorización de macOS. En lugar de validar la referencia de autorización del cliente, el asistente invoca AuthorizationCopyRights() utilizando su propio contexto privilegiado (root), autorizándose a sí mismo en lugar del cliente. Como resultado, otorga el derecho system.preferences.admin internamente, independientemente de los privilegios del cliente solicitante. Esta lógica errónea permite a los clientes sin privilegios invocar operaciones privilegiadas mediante XPC, incluyendo cambios no autorizados en las preferencias de red de todo el sistema, como la configuración de proxy SOCKS, HTTP y HTTPS. La ausencia de comprobaciones adecuadas de firma de código permite además que procesos arbitrarios exploten esta vulnerabilidad, lo que provoca ataques de intermediario (MITM) mediante la redirección del tráfico."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "41c37e40-543d-43a2-b660-2fee83ea851a",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "41c37e40-543d-43a2-b660-2fee83ea851a",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://pentraze.com/",
      "source": "41c37e40-543d-43a2-b660-2fee83ea851a"
    }
  ]
}