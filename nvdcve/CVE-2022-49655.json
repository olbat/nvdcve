{
  "id": "CVE-2022-49655",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-02-26T07:01:40.600",
  "lastModified": "2025-02-26T07:01:40.600",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfscache: Fix invalidation/lookup race\n\nIf an NFS file is opened for writing and closed, fscache_invalidate() will\nbe asked to invalidate the file - however, if the cookie is in the\nLOOKING_UP state (or the CREATING state), then request to invalidate\ndoesn't get recorded for fscache_cookie_state_machine() to do something\nwith.\n\nFix this by making __fscache_invalidate() set a flag if it sees the cookie\nis in the LOOKING_UP state to indicate that we need to go to invalidation.\nNote that this requires a count on the n_accesses counter for the state\nmachine, which that will release when it's done.\n\nfscache_cookie_state_machine() then shifts to the INVALIDATING state if it\nsees the flag.\n\nWithout this, an nfs file can get corrupted if it gets modified locally and\nthen read locally as the cache contents may not get updated."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: fscache: Corregir ejecución de invalidación/búsqueda Si se abre un archivo NFS para escritura y se cierra, se le solicitará a fscache_invalidate() que invalide el archivo; sin embargo, si la cookie está en el estado LOOKING_UP (o el estado CREATING), entonces la solicitud de invalidación no se registra para que fscache_cookie_state_machine() haga algo con ella. Solucione esto haciendo que __fscache_invalidate() establezca una bandera si ve que la cookie está en el estado LOOKING_UP para indicar que debemos ir a la invalidación. Tenga en cuenta que esto requiere un recuento en el contador n_accesses para la máquina de estado, que se liberará cuando haya terminado. fscache_cookie_state_machine() luego cambia al estado INVALIDATING si ve la bandera. Sin esto, un archivo nfs puede dañarse si se modifica localmente y luego se lee localmente, ya que el contenido de la memoria caché podría no actualizarse."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/85e4ea1049c70fb99de5c6057e835d151fb647da",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/b1ae9f617f8a5c848d9205b8e228c6f0d1af754b",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}