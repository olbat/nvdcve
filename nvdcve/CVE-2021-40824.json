{
  "id": "CVE-2021-40824",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2021-09-13T19:15:19.340",
  "lastModified": "2024-11-21T06:24:50.803",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "A logic error in the room key sharing functionality of Element Android before 1.2.2 and matrix-android-sdk2 (aka Matrix SDK for Android) before 1.2.2 allows a malicious Matrix homeserver present in an encrypted room to steal room encryption keys (via crafted Matrix protocol messages) that were originally sent by affected Matrix clients participating in that room. This allows the attacker to decrypt end-to-end encrypted messages sent by affected clients."
    },
    {
      "lang": "es",
      "value": "Un error lógico en la funcionalidad de compartición de claves de sala de Element Android antes de la versión 1.2.2 y matrix-android-sdk2 (también conocido como Matrix SDK para Android) antes de la versión 1.2.2 permite a un servidor doméstico de Matrix malicioso presente en una sala cifrada robar las claves de cifrado de la sala (a través de mensajes de protocolo de Matrix falsificados) que fueron enviados originalmente por los clientes de Matrix afectados que participan en esa sala. Esto permite al atacante descifrar los mensajes cifrados de extremo a extremo enviados por los clientes afectados"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "baseScore": 4.3,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-290"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:matrix:element:*:*:*:*:*:android:*:*",
              "versionEndExcluding": "1.2.2",
              "matchCriteriaId": "D575EEBA-AD7C-404F-965B-16DE5BFAE908"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:matrix:matrix-android-sdk2:*:*:*:*:*:android:*:*",
              "versionEndExcluding": "1.2.2",
              "matchCriteriaId": "A35A1290-9B73-49EB-AB28-41D9AA9587F1"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}