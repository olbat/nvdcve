{
  "id": "CVE-2024-45818",
  "sourceIdentifier": "security@xen.org",
  "published": "2024-12-19T12:15:16.540",
  "lastModified": "2025-05-20T16:28:07.217",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "The hypervisor contains code to accelerate VGA memory accesses for HVM\nguests, when the (virtual) VGA is in \"standard\" mode.  Locking involved\nthere has an unusual discipline, leaving a lock acquired past the\nreturn from the function that acquired it.  This behavior results in a\nproblem when emulating an instruction with two memory accesses, both of\nwhich touch VGA memory (plus some further constraints which aren't\nrelevant here).  When emulating the 2nd access, the lock that is already\nbeing held would be attempted to be re-acquired, resulting in a\ndeadlock.\n\nThis deadlock was already found when the code was first introduced, but\nwas analysed incorrectly and the fix was incomplete.  Analysis in light\nof the new finding cannot find a way to make the existing locking\ndiscipline work.\n\nIn staging, this logic has all been removed because it was discovered\nto be accidentally disabled since Xen 4.7.  Therefore, we are fixing the\nlocking problem by backporting the removal of most of the feature.  Note\nthat even with the feature disabled, the lock would still be acquired\nfor any accesses to the VGA MMIO region."
    },
    {
      "lang": "es",
      "value": "El hipervisor contiene código para acelerar los accesos a la memoria VGA para los invitados HVM, cuando el VGA (virtual) está en modo \"estándar\". El bloqueo involucrado allí tiene una disciplina inusual, dejando un bloqueo adquirido más allá del retorno de la función que lo adquirió. Este comportamiento genera un problema al emular una instrucción con dos accesos a la memoria, ambos de los cuales tocan la memoria VGA (además de algunas restricciones adicionales que no son relevantes aquí). Al emular el segundo acceso, se intentaría volver a adquirir el bloqueo que ya se mantiene, lo que resultaría en un bloqueo. Este bloqueo ya se encontró cuando se introdujo el código por primera vez, pero se analizó incorrectamente y la solución fue incompleta. El análisis a la luz del nuevo hallazgo no puede encontrar una manera de hacer que funcione la disciplina de bloqueo existente. En la etapa de preparación, se eliminó toda esta lógica porque se descubrió que se había deshabilitado accidentalmente desde Xen 4.7. Por lo tanto, estamos solucionando el problema de bloqueo al incorporar la eliminación de la mayor parte de la función. Tenga en cuenta que incluso con la función deshabilitada, el bloqueo aún se adquiriría para cualquier acceso a la región MMIO de VGA."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.0,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-667"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:x86:*",
              "versionStartIncluding": "4.6.0",
              "versionEndExcluding": "4.20.0",
              "matchCriteriaId": "D0B4A3E0-200C-492E-813C-D9EA47E2A66F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://xenbits.xenproject.org/xsa/advisory-463.html",
      "source": "security@xen.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/11/12/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://xenbits.xen.org/xsa/advisory-463.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}