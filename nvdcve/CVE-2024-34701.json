{
  "id": "CVE-2024-34701",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-05-14T15:39:28.940",
  "lastModified": "2024-11-21T09:19:13.540",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "CreateWiki is Miraheze's MediaWiki extension for requesting & creating wikis. It is possible for users to be considered as the requester of a specific wiki request if their local user ID on any wiki in a wiki farm matches the local ID of the requester at the wiki where the wiki request was made. This allows them to go to that request entry's on Special:RequestWikiQueue on the wiki where their local user ID matches and take any actions that the wiki requester is allowed to take from there.\n\nCommit 02e0f298f8d35155c39aa74193cb7b867432c5b8 fixes the issue. Important note about the fix: This vulnerability has been fixed by disabling access to the REST API and special pages outside of the wiki configured as the \"global wiki\" in `$wgCreateWikiGlobalWiki` in a user's MediaWiki settings.\n\nAs a workaround, it is possible to disable the special pages outside of one's own global wiki by doing something similar to `miraheze/mw-config` commit e5664995fbb8644f9a80b450b4326194f20f9ddc that is adapted to one's own setup. As for the REST API, before the fix, there wasn't any REST endpoint that allowed one to make writes. Regardless, it is possible to also disable it outside of the global wiki by using `$wgCreateWikiDisableRESTAPI` and `$wgConf` in the configuration for one's own wiki farm.."
    },
    {
      "lang": "es",
      "value": "CreateWiki es la extensión MediaWiki de Miraheze para solicitar y crear wikis. Es posible que los usuarios sean considerados solicitantes de una solicitud de wiki específica si su ID de usuario local en cualquier wiki de una granja de wiki coincide con la ID local del solicitante en el wiki donde se realizó la solicitud de wiki. Esto les permite ir a la entrada de esa solicitud en Special:RequestWikiQueue en el wiki donde coincide su ID de usuario local y realizar cualquier acción que el solicitante del wiki pueda realizar desde allí. el commit 02e0f298f8d35155c39aa74193cb7b867432c5b8 soluciona el problema. Nota importante sobre la solución: esta vulnerabilidad se solucionó deshabilitando el acceso a la API REST y a páginas especiales fuera del wiki configurado como \"wiki global\" en `$wgCreateWikiGlobalWiki` en la configuración de MediaWiki de un usuario. Como workaround, es posible desactivar las páginas especiales fuera de la propia wiki global haciendo algo similar a `miraheze/mw-config` commit e5664995fbb8644f9a80b450b4326194f20f9ddc que se adapta a la propia configuración. En cuanto a la API REST, antes de la solución, no había ningún endpoint REST que permitiera realizar escrituras. De todos modos, también es posible deshabilitarlo fuera del wiki global usando `$wgCreateWikiDisableRESTAPI` y `$wgConf` en la configuración de la propia granja de wiki."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/1798e53901a202b62edab32f8bcd5c6b9e574191",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/e5664995fbb8644f9a80b450b4326194f20f9ddc",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12011",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12102",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/1798e53901a202b62edab32f8bcd5c6b9e574191",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/e5664995fbb8644f9a80b450b4326194f20f9ddc",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12011",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12102",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}