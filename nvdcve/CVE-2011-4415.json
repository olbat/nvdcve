{
  "id": "CVE-2011-4415",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2011-11-08T11:55:05.850",
  "lastModified": "2025-04-11T00:51:21.963",
  "vulnStatus": "Deferred",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The ap_pregsub function in server/util.c in the Apache HTTP Server 2.0.x through 2.0.64 and 2.2.x through 2.2.21, when the mod_setenvif module is enabled, does not restrict the size of values of environment variables, which allows local users to cause a denial of service (memory consumption or NULL pointer dereference) via a .htaccess file with a crafted SetEnvIf directive, in conjunction with a crafted HTTP request header, related to (1) the \"len +=\" statement and (2) the apr_pcalloc function call, a different vulnerability than CVE-2011-3607."
    },
    {
      "lang": "es",
      "value": "La función ap_pregsub en server/util.c en el servidor HTTP Apache v2.0.x hasta la 2.0.64 y la v2.2.x hasta la v2.2.21, cuando el módulo mod_setenvif está activado, no limita el tamaño de los valores de las variables de entorno, lo que permite a usuarios locales causar una denegación de servicio (consumo de memoria o puntero a NULL) a través de un archivo de tipo .htaccess que incluye una directiva SetEnvIf modificada, junto con un encabezado de solicitud HTTP manipulado, relacionado con (1) la declarción \"len + =\" y (2) con la llamada a la funcion apr_pcalloc, una vulnerabilidad diferente a CVE-2011-3607."
    }
  ],
  "metrics": {
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:H/Au:N/C:N/I:N/A:P",
          "baseScore": 1.2,
          "accessVector": "LOCAL",
          "accessComplexity": "HIGH",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 1.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "163A6EF6-7D3F-4B1F-9E03-A8C86562CC3D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.9:*:*:*:*:*:*:*",
              "matchCriteriaId": "154566FB-0D1A-4DC2-AFE6-49DE93850951"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.28:*:*:*:*:*:*:*",
              "matchCriteriaId": "EB477AFB-EA39-4892-B772-586CF6D2D235"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.28:beta:*:*:*:*:*:*",
              "matchCriteriaId": "5C4962BB-0E61-4788-B582-21F05CD33AD3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.32:*:*:*:*:*:*:*",
              "matchCriteriaId": "B35906CD-038E-4243-8A95-F0A3A43F06F7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.32:beta:*:*:*:*:*:*",
              "matchCriteriaId": "1C3E2656-8071-40DA-9480-AC13010A9D09"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.34:beta:*:*:*:*:*:*",
              "matchCriteriaId": "7C649D2F-A633-456E-899C-6253FDE9A626"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.35:*:*:*:*:*:*:*",
              "matchCriteriaId": "B940BB85-03F5-46D7-8DC9-2E1E228D3D98"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.36:*:*:*:*:*:*:*",
              "matchCriteriaId": "82139FFA-2779-4732-AFA5-4E6E19775899"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.37:*:*:*:*:*:*:*",
              "matchCriteriaId": "B7F717E6-BACD-4C8A-A9C5-516ADA6FEE6C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.38:*:*:*:*:*:*:*",
              "matchCriteriaId": "08AB120B-2FEC-4EB3-9777-135D81E809AA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.39:*:*:*:*:*:*:*",
              "matchCriteriaId": "1C7FF669-12E0-4A73-BBA7-250D109148C5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.40:*:*:*:*:*:*:*",
              "matchCriteriaId": "5AB7B1F1-7202-445D-9F96-135DC0AFB1E9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.41:*:*:*:*:*:*:*",
              "matchCriteriaId": "BCB7EE53-187E-40A9-9865-0F3EDA2B5A4C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.42:*:*:*:*:*:*:*",
              "matchCriteriaId": "9D06AE8A-9BA8-4AA8-ACEA-326CD001E879"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.43:*:*:*:*:*:*:*",
              "matchCriteriaId": "2FC1A04B-0466-48AD-89F3-1F2EF1DEBE6A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.44:*:*:*:*:*:*:*",
              "matchCriteriaId": "19F34D08-430E-4331-A27D-667149425176"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.45:*:*:*:*:*:*:*",
              "matchCriteriaId": "248BDF2C-3E78-49D1-BD9C-60C09A441724"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.46:*:*:*:*:*:*:*",
              "matchCriteriaId": "BB0FDE3D-1509-4375-8703-0D174D70B22E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.47:*:*:*:*:*:*:*",
              "matchCriteriaId": "AFE732B5-00C9-4443-97E0-1DF21475C26B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.48:*:*:*:*:*:*:*",
              "matchCriteriaId": "C79C41D3-6894-4F2D-B8F8-82AB4780A824"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.49:*:*:*:*:*:*:*",
              "matchCriteriaId": "449A5647-CEA6-4314-9DB8-D086F388E1C7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.50:*:*:*:*:*:*:*",
              "matchCriteriaId": "B5A407B7-F432-48F0-916A-A49952F85CA6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.51:*:*:*:*:*:*:*",
              "matchCriteriaId": "6B5AC769-D07D-43C7-B252-A5A812E7D58C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.52:*:*:*:*:*:*:*",
              "matchCriteriaId": "ADF4DBF6-DAF0-47E7-863B-C48DB7149A78"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.53:*:*:*:*:*:*:*",
              "matchCriteriaId": "F2F19D71-0A58-4B03-B351-596EB67ECF80"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.54:*:*:*:*:*:*:*",
              "matchCriteriaId": "5EBB3FF9-CF5A-4E7B-ACE3-A198343AD485"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.55:*:*:*:*:*:*:*",
              "matchCriteriaId": "D721FFB5-D6D3-4F60-8B09-B3AD07EE6D4D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.56:*:*:*:*:*:*:*",
              "matchCriteriaId": "97E8F32E-C2E5-44E3-A920-F09AF919D372"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.57:*:*:*:*:*:*:*",
              "matchCriteriaId": "0CF37A82-49B6-45D4-B91D-FDA2D4463A0C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.58:*:*:*:*:*:*:*",
              "matchCriteriaId": "030D1767-2DF7-48E3-B462-4B49CA751B35"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.59:*:*:*:*:*:*:*",
              "matchCriteriaId": "5236DC61-5557-4C24-8F5B-F48548448588"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.60:*:*:*:*:*:*:*",
              "matchCriteriaId": "8CB9F19A-5DC0-4C44-8BAF-B8FD047DAB56"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.61:*:*:*:*:*:*:*",
              "matchCriteriaId": "3B468F9B-2514-425C-9279-0FCAF73BBD18"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.63:*:*:*:*:*:*:*",
              "matchCriteriaId": "59FAFAD0-6B58-431B-BA90-CAE6C72844E9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.0.64:*:*:*:*:*:*:*",
              "matchCriteriaId": "3FD4780F-A3A0-458E-9F23-13359E42D35E"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "67AD11FB-529C-404E-A13B-284F145322B8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "733D62FE-180A-4AE8-9DBF-DA1DC18C1932"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "CCBBB7FE-35FC-4515-8393-5145339FCE4D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "F519633F-AB68-495A-B85E-FD41F9F752CA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "A894BED6-C97D-4DA4-A13D-9CB2B3306BC5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "34A847D1-5AD5-4EFD-B165-7602AFC1E656"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.8:*:*:*:*:*:*:*",
              "matchCriteriaId": "9AF3A0F5-4E5C-4278-9927-1F94F25CCAFC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.9:*:*:*:*:*:*:*",
              "matchCriteriaId": "AB63EBE5-CF14-491E-ABA5-67116DFE3E5B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.10:*:*:*:*:*:*:*",
              "matchCriteriaId": "8C2A33DE-F55F-4FD8-BB00-9C1E006CA65C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.11:*:*:*:*:*:*:*",
              "matchCriteriaId": "B1CF6394-95D9-42AF-A442-385EFF9CEFE1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.12:*:*:*:*:*:*:*",
              "matchCriteriaId": "02B629FB-88C8-4E85-A137-28770F1E524E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.13:*:*:*:*:*:*:*",
              "matchCriteriaId": "03550EF0-DF89-42FE-BF0E-994514EBD947"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.14:*:*:*:*:*:*:*",
              "matchCriteriaId": "4886CCAB-6D4E-45C7-B177-2E8DBEA15531"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.15:*:*:*:*:*:*:*",
              "matchCriteriaId": "C35631AC-7C35-4F6A-A95A-3B080E5210ED"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.16:*:*:*:*:*:*:*",
              "matchCriteriaId": "6CED2BA6-BE5E-4EF1-88EB-0DADD23D2EEF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.18:*:*:*:*:*:*:*",
              "matchCriteriaId": "B0B8C9DB-401E-42B3-BAED-D09A96DE9A90"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.19:*:*:*:*:*:*:*",
              "matchCriteriaId": "062C20A0-05A0-4164-8330-DF6ADFE607F4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.20:*:*:*:*:*:*:*",
              "matchCriteriaId": "D345BA35-93BB-406F-B5DC-86E49FB29C22"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:http_server:2.2.21:*:*:*:*:*:*:*",
              "matchCriteriaId": "7ED4892F-C829-4BEA-AB82-6A78F6F2426D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03360041",
      "source": "cve@mitre.org"
    },
    {
      "url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03360041",
      "source": "cve@mitre.org"
    },
    {
      "url": "http://www.gossamer-threads.com/lists/apache/dev/403775",
      "source": "cve@mitre.org"
    },
    {
      "url": "http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03360041",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03360041",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "http://www.gossamer-threads.com/lists/apache/dev/403775",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    }
  ]
}