{
  "id": "CVE-2024-42476",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-08-15T19:15:19.753",
  "lastModified": "2024-08-19T13:00:23.117",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the OAuth library for nim prior to version 0.11, the Authorization Code grant and Implicit grant both rely on the `state` parameter to prevent cross-site request forgery (CSRF) attacks where a resource owner might have their session associated with protected resources belonging to an attacker. When this project is compiled with certain compiler flags set, it is possible that the `state` parameter will not be checked at all, creating a CSRF vulnerability. Version 0.11 checks the `state` parameter using a regular `if` statement or `doAssert` instead of relying on a plain `assert`. `doAssert` will achieve the desired behavior even if `-d:danger` or `--assertions:off` is set."
    },
    {
      "lang": "es",
      "value": " En la librería OAuth para nim anterior a la versión 0.11, la concesión del Código de autorización y la concesión implícita dependen del parámetro \"state\" para evitar ataques de Cross-Site Request Forgery (CSRF) en los que el propietario de un recurso podría tener su sesión asociada con recursos protegidos que pertenecen. a un atacante. Cuando este proyecto se compila con ciertos indicadores del compilador configurados, es posible que el parámetro \"state\" no se verifique en absoluto, creando una vulnerabilidad de CSRF. La versión 0.11 verifica el parámetro \"state\" usando una declaración \"if\" normal o \"doAssert\" en lugar de confiar en una simple \"assert\". `doAssert` logrará el comportamiento deseado incluso si `-d:danger` o `--assertions:off` están configurados."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-352"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/CORDEA/oauth/blob/b8c163b0d9cfad6d29ce8c1fb394e5f47182ee1c/src/oauth2.nim#L235",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/CORDEA/oauth/blob/b8c163b0d9cfad6d29ce8c1fb394e5f47182ee1c/src/oauth2.nim#L255",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/CORDEA/oauth/security/advisories/GHSA-pc9j-53g7-5x54",
      "source": "security-advisories@github.com"
    }
  ]
}