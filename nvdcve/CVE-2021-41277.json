{
  "id": "CVE-2021-41277",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-11-17T20:15:10.587",
  "lastModified": "2025-02-18T14:44:41.687",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Metabase is an open source data analytics platform. In affected versions a security issue has been discovered with the custom GeoJSON map (`admin->settings->maps->custom maps->add a map`) support and potential local file inclusion (including environment variables). URLs were not validated prior to being loaded. This issue is fixed in a new maintenance release (0.40.5 and 1.40.5), and any subsequent release after that. If you’re unable to upgrade immediately, you can mitigate this by including rules in your reverse proxy or load balancer or WAF to provide a validation filter before the application."
    },
    {
      "lang": "es",
      "value": "Metabase es una plataforma de análisis de datos de código abierto. En las versiones afectadas se ha detectado un problema de seguridad con el soporte de mapas GeoJSON personalizados (\"admin-&gt;settings-&gt;maps-&gt;custom maps-&gt;add a map\") y la posible inclusión de archivos locales (incluyendo variables de entorno). Las URLs no se comprueban antes de ser cargadas. Este problema se ha corregido en una nueva versión de mantenimiento (0.40.5 y 1.40.5), y en cualquier otra versión posterior. Si no puede actualizar inmediatamente, puede mitigar esto incluyendo reglas en su proxy inverso o balanceador de carga o WAF para proporcionar un filtro de comprobación antes de la aplicación."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "baseScore": 5.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "cisaExploitAdd": "2024-11-12",
  "cisaActionDue": "2024-12-03",
  "cisaRequiredAction": "Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.",
  "cisaVulnerabilityName": "Metabase GeoJSON API Local File Inclusion Vulnerability",
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:0.40.0:-:*:*:-:*:*:*",
              "matchCriteriaId": "AF64F422-9B51-4949-A9B3-459C77B37C8B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:0.40.1:*:*:*:-:*:*:*",
              "matchCriteriaId": "3F3694D1-A2D8-4451-B4E2-498EDF5B93C6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:0.40.2:*:*:*:-:*:*:*",
              "matchCriteriaId": "7BA0D68D-DF27-4726-A893-8D1BCAA39842"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:0.40.3:*:*:*:-:*:*:*",
              "matchCriteriaId": "B2C59AA8-0BA6-4EB1-9121-D84C805E6A9C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:0.40.4:*:*:*:-:*:*:*",
              "matchCriteriaId": "BB23EBC1-F524-416B-99F6-143B97D64B01"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:1.40.0:-:*:*:enterprise:*:*:*",
              "matchCriteriaId": "310FB743-2F8A-415C-AF7B-20BCEF0C464E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:1.40.1:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "511B7873-4908-4B1B-B55B-DC90A3BBE659"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:1.40.2:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "5C9DE222-5F6B-42E3-9B5B-DB9EE05C4FD4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:1.40.3:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "FA1F16C0-63AA-49B5-A28D-D63BA97D07B3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:1.40.4:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "5AA701CB-58B6-4B17-ABCC-B12F2DB9F2A3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/metabase/metabase/commit/042a36e49574c749f944e19cf80360fd3dc322f0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metabase/metabase/security/advisories/GHSA-w73v-6p7p-fpfr",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/metabase/metabase/commit/042a36e49574c749f944e19cf80360fd3dc322f0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metabase/metabase/security/advisories/GHSA-w73v-6p7p-fpfr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}