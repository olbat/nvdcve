{
  "id": "CVE-2019-16097",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2019-09-08T16:15:11.820",
  "lastModified": "2024-11-21T04:30:01.773",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "core/api/user.go in Harbor 1.7.0 through 1.8.2 allows non-admin users to create admin accounts via the POST /api/users API, when Harbor is setup with DB as authentication backend and allow user to do self-registration. Fixed version: v1.7.6 v1.8.3. v.1.9.0. Workaround without applying the fix: configure Harbor to use non-DB authentication backend such as LDAP."
    },
    {
      "lang": "es",
      "value": "core/api/user.go en Harbor versión 1.7.0 hasta la versión 1.8.2 permite a los usuarios que no son administradores crear cuentas de administrador mediante el POST /api/users API, cuando Harbor se configura con DB como back-end de autenticación y permite al usuario realizar el autorregistro. Esto se corrige en la versión 1.7.6, versión 1.8.3. versión 1.9.0. Solución alternativa sin aplicar la corrección: configure Harbor para que utilice el backend de autenticación que no sea de base de datos, como LDAP."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N",
          "baseScore": 4.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-862"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "A821F059-11AC-4F49-A252-5DC473ED6F2E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "6DAC0844-F418-457B-B97B-21B321BEC456"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.0:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "3B0D228F-2398-4727-B25D-9C191A6B5B45"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "C751ACB0-551E-44E3-9BAF-9DD5F51FA873"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "608DB219-F359-4056-8CE8-C360A57DDCE2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "FF3210DE-A99E-458E-AF49-3E8CD284D6AF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "12809349-0DC1-4F4F-BB29-958717FD7C39"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.7.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "5B45EDEE-EC64-474D-9959-6F1EAA1E6876"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "53503E8E-84B4-4CD1-8DDC-3C15BF98CEF9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "096D5DC7-5898-4765-8E71-A89A5CABA54B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.0:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "3726DEC5-21ED-4E3D-9C3E-82D6762669AE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "C54E5105-221B-4911-A1DC-1736C20928B5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.2:-:*:*:*:*:*:*",
              "matchCriteriaId": "08F17BB4-0E84-4C73-B36C-E71D88D34FC9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.2:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "E228C4B2-24DE-4AEA-8485-35F2FFCF153D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.8.2:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "F734320C-329C-4E49-8516-62F5E4B0015F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:harbor:1.9.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "EB9B2E26-AD5F-4B79-A3E1-46355602B4ED"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.vmware.com/security/advisories/VMSA-2019-0015.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/commit/b6db8a8a106259ec9a2c48be8a380cb3b37cf517",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/compare/v1.8.2...v1.9.0-rc1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/releases/tag/v1.7.6",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/releases/tag/v1.8.3",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.vmware.com/security/advisories/VMSA-2019-0015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/commit/b6db8a8a106259ec9a2c48be8a380cb3b37cf517",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/compare/v1.8.2...v1.9.0-rc1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/releases/tag/v1.7.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/goharbor/harbor/releases/tag/v1.8.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}