{
  "id": "CVE-2022-24668",
  "sourceIdentifier": "cve@forums.swift.org",
  "published": "2022-02-09T23:15:20.327",
  "lastModified": "2024-11-21T06:50:49.670",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A program using swift-nio-http2 is vulnerable to a denial of service attack caused by a network peer sending ALTSVC or ORIGIN frames. This attack affects all swift-nio-http2 versions from 1.0.0 to 1.19.1. This vulnerability is caused by a logical error after frame parsing but before frame handling. ORIGIN and ALTSVC frames are not currently supported by swift-nio-http2, and should be ignored. However, one code path that encounters them has a deliberate trap instead. This was left behind from the original development process and was never removed. Sending an ALTSVC or ORIGIN frame does not require any special permission, so any HTTP/2 connection peer may send such a frame. For clients, this means any server to which they connect may launch this attack. For servers, anyone they allow to connect to them may launch such an attack. The attack is low-effort: it takes very little resources to send one of these frames. The impact on availability is high: receiving the frame immediately crashes the server, dropping all in-flight connections and causing the service to need to restart. It is straightforward for an attacker to repeatedly send these frames, so attackers require very few resources to achieve a substantial denial of service. The attack does not have any confidentiality or integrity risks in and of itself. This is a controlled, intentional crash. However, sudden process crashes can lead to violations of invariants in services, so it is possible that this attack can be used to trigger an error condition that has confidentiality or integrity risks. The risk can be mitigated if untrusted peers can be prevented from communicating with the service. This mitigation is not available to many services. The issue is fixed by rewriting the parsing code to correctly handle the condition. The issue was found by automated fuzzing by oss-fuzz."
    },
    {
      "lang": "es",
      "value": "Un programa que usa swift-nio-http2 es vulnerable a un ataque de denegación de servicio causado por un compañero de red que envía tramas ALTSVC u ORIGIN. Este ataque afecta a todas las versiones de swift-nio-http2 desde 1.0.0 hasta 1.19.1. Esta vulnerabilidad es causada por un error lógico después del análisis de la trama, pero antes del manejo de la misma. Las tramas ORIGIN y ALTSVC no son soportadas actualmente por swift-nio-http2, y deben ser ignoradas. Sin embargo, una ruta de código que es encontrada con ellos presenta una trampa deliberada en su lugar. Esto fue dejado atrás desde el proceso de desarrollo original y nunca fue eliminado. El envío de una trama ALTSVC u ORIGIN no requiere ningún permiso especial, por lo que cualquier par de conexión HTTP/2 puede enviar dicha trama. Para los clientes, esto significa que cualquier servidor al que sean conectados puede lanzar este ataque. Para los servidores, cualquier persona a la que permitan conectarse puede lanzar este ataque. El ataque es de bajo esfuerzo: son necesarios muy pocos recursos para enviar una de estas tramas. El impacto en la disponibilidad es elevado: la recepción de la trama bloquea inmediatamente el servidor, cayendo todas las conexiones en curso y causando la necesidad de reiniciar el servicio. Es sencillo para un atacante enviar repetidamente estas tramas, por lo que los atacantes necesitan muy pocos recursos para lograr una denegación de servicio sustancial. El ataque no presenta ningún riesgo de confidencialidad o integridad en sí mismo. Se trata de un bloqueo controlado e intencionado. Sin embargo, los bloqueos repentinos de procesos pueden conllevar a violaciones de invariantes en los servicios, por lo que es posible que este ataque pueda ser usado para desencadenar una condición de error que tenga riesgos de confidencialidad o integridad. El riesgo puede mitigarse si puede evitarse que los compañeros que no son confiables sean comunicados con el servicio. Esta mitigación no está disponible para muchos servicios. El problema es corregido al reescribir el código de análisis para manejar correctamente la condición. El problema se encontró mediante un fuzzing automatizado con oss-fuzz"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "baseScore": 5.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve@forums.swift.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-241"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-Other"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apple:swiftnio_http\\/2:*:*:*:*:*:swift:*:*",
              "versionStartIncluding": "1.0.0",
              "versionEndExcluding": "1.19.2",
              "matchCriteriaId": "DAF5D763-09A3-4427-82F7-EF049316E6E8"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/apple/swift-nio-http2/security/advisories/GHSA-pgfx-g6rc-8cjv",
      "source": "cve@forums.swift.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/apple/swift-nio-http2/security/advisories/GHSA-pgfx-g6rc-8cjv",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}