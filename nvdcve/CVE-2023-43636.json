{
  "id": "CVE-2023-43636",
  "sourceIdentifier": "cve@asrg.io",
  "published": "2023-09-20T15:15:12.063",
  "lastModified": "2024-11-21T08:24:31.020",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "\n\n\nIn EVE OS, the “measured boot” mechanism prevents a compromised device from accessing\nthe encrypted data located in the vault.\n\nAs per the “measured boot” design, the PCR values calculated at different stages of the boot\nprocess will change if any of their respective parts are changed.\n\nThis includes, among other things, the configuration of the bios, grub, the kernel cmdline,\ninitrd, and more.\n\nHowever, this mechanism does not validate the entire rootfs, so an attacker can edit the\nfilesystem and gain control over the system.\n\nAs the default filesystem used by EVE OS is squashfs, this is somewhat harder than an ext4,\nwhich is easily changeable.\n\nThis will not stop an attacker, as an attacker can repackage the squashfs with their changes\nin it and replace the partition altogether.\n\nThis can also be done directly on the device, as the “003-storage-init” container contains the\n“mksquashfs” and “unsquashfs” binaries (with the corresponding libs).\n\n\n\n\n\n\n\nAn attacker can gain full control over the device without changing the PCR values, thus not\ntriggering the “measured boot” mechanism, and having full access to the vault.\n\n\n\nNote:\n\nThis issue was partially fixed in these commits (after disclosure to Zededa), where the config\npartition measurement was added to PCR13:\n\n• aa3501d6c57206ced222c33aea15a9169d629141\n\n• 5fef4d92e75838cc78010edaed5247dfbdae1889.\n\nThis issue was made viable in version 9.0.0 when the calculation was moved to PCR14 but it was not included in the measured boot."
    },
    {
      "lang": "es",
      "value": "En EVE OS, el mecanismo de \"measured boot\" evita que un dispositivo comprometido acceda a los datos cifrados ubicados en la bóveda. Según el diseño de “measured boot”, los valores de PCR calculados en diferentes etapas del proceso de arranque cambiarán si se cambia alguna de sus respectivas partes. Esto incluye, entre otras cosas, la configuración de BIOS, grub, cmdline del kernel, initrd y más. Sin embargo, este mecanismo no valida todos los rootfs, por lo que un atacante puede editar el sistema de archivos y obtener control sobre el sistema. Como el sistema de archivos predeterminado utilizado por EVE OS es squashfs, esto es algo más difícil que un ext4, que se puede cambiar fácilmente. Esto no detendrá a un atacante, ya que un atacante puede volver a empaquetar los squashfs con sus cambios y reemplazar la partición por completo. Esto también se puede hacer directamente en el dispositivo, ya que el contenedor “003-storage-init” contiene los binarios “mksquashfs” y “unsquashfs” (con las bibliotecas correspondientes). Un atacante puede obtener control total sobre el dispositivo sin cambiar los valores de PCR, por lo que no activará el mecanismo de \"measured boot\" y tendrá acceso completo a la bóveda. Nota: Este problema se solucionó parcialmente en estos commits (después de la divulgación a Zededa), donde la medición de la partición de configuración se agregó a PCR13: \n• aa3501d6c57206ced222c33aea15a9169d629141 \n• 5fef4d92e75838cc78010edaed5247dfbdae1889\nEste problema se hizo viable en la versión 9.0.0 cuando el cálculo se trasladó a PCR14, pero no se incluyó en el \"measured boot\"."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve@asrg.io",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.0,
        "impactScore": 6.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.0,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve@asrg.io",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-345"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-345"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linuxfoundation:edge_virtualization_engine:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "8.6.0",
              "matchCriteriaId": "A569C358-B746-494B-A5EE-15D38BD74AB2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linuxfoundation:edge_virtualization_engine:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "9.0.0",
              "versionEndExcluding": "9.5.0",
              "matchCriteriaId": "D19A1245-092C-478C-BB01-23F91A227B3F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://asrg.io/security-advisories/cve-2023-43636/",
      "source": "cve@asrg.io"
    },
    {
      "url": "https://asrg.io/security-advisories/cve-2023-43636/",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}