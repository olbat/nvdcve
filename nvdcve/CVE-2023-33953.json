{
  "id": "CVE-2023-33953",
  "sourceIdentifier": "cve-coordination@google.com",
  "published": "2023-08-09T13:15:09.370",
  "lastModified": "2024-11-21T08:06:17.007",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "gRPC contains a vulnerability that allows hpack table accounting errors could lead to unwanted disconnects between clients and servers in exceptional cases/ Three vectors were found that allow the following DOS attacks:\n\n- Unbounded memory buffering in the HPACK parser\n- Unbounded CPU consumption in the HPACK parser\n\nThe unbounded CPU consumption is down to a copy that occurred per-input-block in the parser, and because that could be unbounded due to the memory copy bug we end up with an O(n^2) parsing loop, with n selected by the client.\n\nThe unbounded memory buffering bugs:\n\n- The header size limit check was behind the string reading code, so we needed to first buffer up to a 4 gigabyte string before rejecting it as longer than 8 or 16kb.\n- HPACK varints have an encoding quirk whereby an infinite number of 0’s can be added at the start of an integer. gRPC’s hpack parser needed to read all of them before concluding a parse.\n- gRPC’s metadata overflow check was performed per frame, so that the following sequence of frames could cause infinite buffering: HEADERS: containing a: 1 CONTINUATION: containing a: 2 CONTINUATION: containing a: 3 etc…"
    },
    {
      "lang": "es",
      "value": "gRPC contiene una vulnerabilidad que permite que los errores de contabilidad de la tabla hpack puedan provocar desconexiones no deseadas entre clientes y servidores en casos excepcionales/ Se han encontrado tres vectores que permiten los siguientes ataques DOS:\n\n- Memoria intermedia ilimitada en el analizador sintáctico HPACK\n- Consumo ilimitado de CPU en el analizador sintáctico HPACK\n\nEl consumo ilimitado de CPU se debe a una copia que se producía por bloque de entrada en el analizador sintáctico, y dado que podría ser ilimitada debido al error de copia de memoria, acabamos con un bucle de análisis sintáctico O(n^2), con n seleccionado por el cliente.\n\nEl error de memoria intermedia no limitada:\n\n- La comprobación del límite de tamaño de la cabecera estaba detrás del código de lectura de cadenas, por lo que necesitábamos primero almacenar en búfer hasta una cadena de 4 gigabytes antes de rechazarla como más larga de 8 o 16kb.\n- Las varints HPACK tienen una peculiaridad de codificación por la que se puede añadir un número infinito de ceros al principio de un entero. El analizador hpack de gRPC necesitaba leerlos todos antes de concluir el análisis.\n- La comprobación de desbordamiento de metadatos de gRPC se realizaba por fotograma, por lo que la siguiente secuencia de fotogramas podía causar un buffering infinito: CABECERAS: contiene un: 1 CONTINUACIÓN: contiene un: 2 CONTINUACIÓN: contiene un: 3 etc?"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve-coordination@google.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve-coordination@google.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-789"
        },
        {
          "lang": "en",
          "value": "CWE-834"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-770"
        },
        {
          "lang": "en",
          "value": "CWE-834"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*",
              "versionEndExcluding": "1.53.2",
              "matchCriteriaId": "5278AD31-21EB-4A2E-89FE-D2E765AC4507"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*",
              "versionStartIncluding": "1.54.0",
              "versionEndExcluding": "1.54.3",
              "matchCriteriaId": "1A6B7840-8878-4F83-977A-1AF53E103F51"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*",
              "versionStartIncluding": "1.55.0",
              "versionEndExcluding": "1.55.2",
              "matchCriteriaId": "12899AA9-F4C9-4E74-B423-8AD74F043758"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*",
              "versionStartIncluding": "1.56.0",
              "versionEndExcluding": "1.56.2",
              "matchCriteriaId": "C4864589-BDBC-4F3D-9175-DA7800480B87"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://cloud.google.com/support/bulletins#gcp-2023-022",
      "source": "cve-coordination@google.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://cloud.google.com/support/bulletins#gcp-2023-022",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}