{
  "id": "CVE-2024-54131",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-12-03T21:15:08.127",
  "lastModified": "2024-12-03T21:15:08.127",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "The Kolide Agent (aka: Launcher) is the lightweight agent designed to work with Kolide's service. An implementation bug in the Kolide Agent (known as `launcher`) allows for local privilege escalation to the SYSTEM user on Windows 10 and 11. The bug was introduced in version 1.5.3 when launcher started storing upgraded binaries in the ProgramData directory. This move to the new directory meant the launcher root directory inherited default permissions that are not as strict as the previous location. These incorrect default permissions in conjunction with an omitted SystemDrive environmental variable (when launcher starts osqueryd), allows a malicious actor with access to the local Windows device to successfully place an arbitrary DLL into the osqueryd process's search path. Under some circumstances, this DLL will be executed when osqueryd performs a WMI query. This combination of events could then allow the attacker to escalate their privileges to SYSTEM. Impacted versions include versions >= 1.5.3 and the fix has been released in 1.12.3."
    },
    {
      "lang": "es",
      "value": "El agente Kolide (también conocido como Launcher) es el agente liviano diseñado para funcionar con el servicio de Kolide. Un error de implementación en el agente Kolide (conocido como `launcher`) permite la escalada de privilegios locales al usuario SYSTEM en Windows 10 y 11. El error se introdujo en la versión 1.5.3 cuando el launcher comenzó a almacenar binarios actualizados en el directorio ProgramData. Este movimiento al nuevo directorio significó que el directorio root del launcher heredó permisos predeterminados que no son tan estrictos como la ubicación anterior. Estos permisos predeterminados incorrectos junto con una variable de entorno SystemDrive omitida (cuando el launcher inicia osqueryd), permiten que un actor malintencionado con acceso al dispositivo local de Windows coloque con éxito una DLL arbitraria en la ruta de búsqueda del proceso osqueryd. En algunas circunstancias, esta DLL se ejecutará cuando osqueryd realice una consulta WMI. Esta combinación de eventos podría permitir al atacante escalar sus privilegios a SYSTEM. Las versiones afectadas incluyen versiones &gt;= 1.5.3 y la solución se lanzó en 1.12.3."
    }
  ],
  "metrics": {
    "cvssMetricV40": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "4.0",
          "vectorString": "CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:L/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
          "baseScore": 7.3,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "attackRequirements": "PRESENT",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "vulnConfidentialityImpact": "HIGH",
          "vulnIntegrityImpact": "HIGH",
          "vulnAvailabilityImpact": "LOW",
          "subConfidentialityImpact": "NONE",
          "subIntegrityImpact": "NONE",
          "subAvailabilityImpact": "NONE",
          "exploitMaturity": "NOT_DEFINED",
          "confidentialityRequirement": "NOT_DEFINED",
          "integrityRequirement": "NOT_DEFINED",
          "availabilityRequirement": "NOT_DEFINED",
          "modifiedAttackVector": "NOT_DEFINED",
          "modifiedAttackComplexity": "NOT_DEFINED",
          "modifiedAttackRequirements": "NOT_DEFINED",
          "modifiedPrivilegesRequired": "NOT_DEFINED",
          "modifiedUserInteraction": "NOT_DEFINED",
          "modifiedVulnConfidentialityImpact": "NOT_DEFINED",
          "modifiedVulnIntegrityImpact": "NOT_DEFINED",
          "modifiedVulnAvailabilityImpact": "NOT_DEFINED",
          "modifiedSubConfidentialityImpact": "NOT_DEFINED",
          "modifiedSubIntegrityImpact": "NOT_DEFINED",
          "modifiedSubAvailabilityImpact": "NOT_DEFINED",
          "Safety": "NOT_DEFINED",
          "Automatable": "NOT_DEFINED",
          "Recovery": "NOT_DEFINED",
          "valueDensity": "NOT_DEFINED",
          "vulnerabilityResponseEffort": "NOT_DEFINED",
          "providerUrgency": "NOT_DEFINED"
        }
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-276"
        },
        {
          "lang": "en",
          "value": "CWE-456"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/kolide/launcher/pull/1510",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/kolide/launcher/security/advisories/GHSA-66q9-2rvx-qfj5",
      "source": "security-advisories@github.com"
    }
  ]
}