{
  "id": "CVE-2022-35508",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-12-04T19:15:09.930",
  "lastModified": "2025-04-24T16:15:20.603",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Proxmox Virtual Environment (PVE) and Proxmox Mail Gateway (PMG) are vulnerable to SSRF when proxying HTTP requests between pve(pmg)proxy and pve(pmg)daemon. An attacker with an unprivileged account can craft an HTTP request to achieve SSRF and file disclosure of any files on the server. Also, in Proxmox Mail Gateway, privilege escalation to the root@pam account is possible if the backup feature has ever been used, because backup files such as pmg-backup_YYYY_MM_DD_*.tgz have 0644 permissions and contain an authkey value. This is fixed in pve-http-server 4.1-3."
    },
    {
      "lang": "es",
      "value": "Proxmox Virtual Environment (PVE) y Proxmox Mail Gateway (PMG) son vulnerables a SSRF cuando envían solicitudes HTTP entre el proxy pve(pmg) y el daemon pve(pmg). Un atacante con una cuenta sin privilegios puede crear una solicitud HTTP para lograr SSRF y revelar cualquier archivo en el servidor. Además, en Proxmox Mail Gateway, la escalada de privilegios a la cuenta root@pam es posible si alguna vez se ha utilizado la función de copia de seguridad, porque los archivos de copia de seguridad como pmg-backup_YYYY_MM_DD_*.tgz tienen permisos 0644 y contienen un valor de clave de autenticación. Esto se solucionó en pve-http-server 4.1-3."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:proxmox:proxmox_mail_gateway:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "F9F113EE-EBBD-4045-A484-A140DFF23481"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:proxmox:pve_http_server:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "4.1-3",
              "matchCriteriaId": "A8D79E9B-8BD2-474C-BA09-16CCE2852818"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:proxmox:virtual_environment:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "27813454-BC59-4D19-B608-A95E754F60EA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=580d540ea907ba15f64379c5bb69ecf1a49a875f",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=c2bd69c7b5e9c775f96021cf8ae53da3dbd9029d",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=e9df8a6e76b2a18f89295a5d92a62177bbf0f762",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://starlabs.sg/blog/2022/12-multiple-vulnerabilites-in-proxmox-ve--proxmox-mail-gateway/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=580d540ea907ba15f64379c5bb69ecf1a49a875f",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=c2bd69c7b5e9c775f96021cf8ae53da3dbd9029d",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=e9df8a6e76b2a18f89295a5d92a62177bbf0f762",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://starlabs.sg/blog/2022/12-multiple-vulnerabilites-in-proxmox-ve--proxmox-mail-gateway/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Technical Description",
        "Third Party Advisory"
      ]
    }
  ]
}