{
  "id": "CVE-2024-52294",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-12-30T17:15:09.467",
  "lastModified": "2024-12-30T17:15:09.467",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Khoj is a self-hostable artificial intelligence app. Prior to version 1.29.10, an Insecure Direct Object Reference (IDOR) vulnerability in the update_subscription endpoint allows any authenticated user to manipulate other users' Stripe subscriptions by simply modifying the email parameter in the request. The vulnerability exists in the subscription endpoint at `/api/subscription`. The endpoint uses an email parameter as a direct reference to user subscriptions without verifying object ownership. While authentication is required, there is no authorization check to verify if the authenticated user owns the referenced subscription. The issue was fixed in version 1.29.10. Support for arbitrarily presenting an email for update has been deprecated."
    },
    {
      "lang": "es",
      "value": "Khoj es una aplicación de inteligencia artificial autoalojada. Antes de la versión 1.29.10, una vulnerabilidad de referencia directa a objetos inseguros (IDOR) en el punto de conexión update_subscription permite que cualquier usuario autenticado manipule las suscripciones de Stripe de otros usuarios simplemente modificando el parámetro de correo electrónico en la solicitud. La vulnerabilidad existe en el punto de conexión de suscripción en `/api/subscription`. El punto de conexión usa un parámetro de correo electrónico como referencia directa a las suscripciones de los usuarios sin verificar la propiedad del objeto. Si bien se requiere autenticación, no hay una verificación de autorización para verificar si el usuario autenticado posee la suscripción a la que se hace referencia. El problema se solucionó en la versión 1.29.10. La compatibilidad con la presentación arbitraria de un correo electrónico para la actualización ha quedado obsoleta."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-639"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/khoj-ai/khoj/commit/47d3c8c23597900af708bdc60aced3ae5d2064c1",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c",
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0"
    }
  ]
}