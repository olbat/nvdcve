{
  "id": "CVE-2020-26896",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-10-21T02:15:12.737",
  "lastModified": "2024-11-21T05:20:26.193",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Prior to 0.11.0-beta, LND (Lightning Network Daemon) had a vulnerability in its invoice database. While claiming on-chain a received HTLC output, it didn't verify that the corresponding outgoing off-chain HTLC was already settled before releasing the preimage. In the case of a hash-and-amount collision with an invoice, the preimage for an expected payment was instead released. A malicious peer could have deliberately intercepted an HTLC intended for the victim node, probed the preimage through a colluding relayed HTLC, and stolen the intercepted HTLC. The impact is a loss of funds in certain situations, and a weakening of the victim's receiver privacy."
    },
    {
      "lang": "es",
      "value": "Antes de la versión 0.11.0-beta, LND (Lightning Network Daemon) tenía una vulnerabilidad en su base de datos de facturas. Mientras reclamaba en cadena una salida HTLC recibida, no verificaba que la correspondiente salida HTLC fuera de cadena ya estaba resuelta antes de liberar la preimagen. En el caso de una colisión de hachís con una factura, la imagen previa para un pago esperado fue liberada. Un par malintencionado podría haber interceptado deliberadamente un HTLC destinado al nodo víctima, sondeado la imagen previa a través de un HTLC retransmitido y robado el HTLC interceptado. El impacto es una pérdida de fondos en ciertas situaciones, y un debilitamiento de la privacidad del receptor de la víctima"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N",
          "baseScore": 8.2,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.2
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
          "baseScore": 5.8,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-354"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.11.0",
              "matchCriteriaId": "BB979325-5104-42AC-88E7-86340DEAABB6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:0.11.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "471DB911-D351-4192-BB35-22F05EF59336"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:0.11.0:beta_rc1:*:*:*:*:*:*",
              "matchCriteriaId": "C3D61839-7705-455E-8B4B-09EA2D546FDA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:0.11.0:beta_rc2:*:*:*:*:*:*",
              "matchCriteriaId": "32789438-5E6E-4B67-B61D-41FD65DF97C7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:0.11.0:beta_rc3:*:*:*:*:*:*",
              "matchCriteriaId": "CFD3719E-B0B0-4F54-8C05-B4F1DD0ED060"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:0.11.0:beta_rc4:*:*:*:*:*:*",
              "matchCriteriaId": "ACA6F2D1-385C-49AA-B1FF-FD406501E0F4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://gist.github.com/ariard/6bdeb995565d1cc292753e1ee4ae402d",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gist.github.com/ariard/6bdeb995565d1cc292753e1ee4ae402d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}