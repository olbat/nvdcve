{
  "id": "CVE-2021-20110",
  "sourceIdentifier": "vulnreport@tenable.com",
  "published": "2021-07-19T15:15:07.703",
  "lastModified": "2024-11-21T05:45:56.523",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Due to Manage Engine Asset Explorer Agent 1.0.34 not validating HTTPS certificates, an attacker on the network can statically configure their IP address to match the Asset Explorer's Server IP address. This will allow an attacker to send a NEWSCAN request to a listening agent on the network as well as receive the agent's HTTP request verifying its authtoken. In httphandler.cpp, the agent reaching out over HTTP is vulnerable to an Integer Overflow, which can be turned into a Heap Overflow allowing for remote code execution as NT AUTHORITY/SYSTEM on the agent machine. The Integer Overflow occurs when receiving POST response from the Manage Engine server, and the agent calling \"HttpQueryInfoW\" in order to get the \"Content-Length\" size from the incoming POST request. This size is taken, but multiplied to a larger amount. If an attacker specifies a Content-Length size of 1073741823 or larger, this integer arithmetic will wrap the value back around to smaller integer, then calls \"calloc\" with this size to allocate memory. The following API \"InternetReadFile\" will copy the POST data into this buffer, which will be too small for the contents, and cause heap overflow."
    },
    {
      "lang": "es",
      "value": "Debido a que Manage Engine Asset Explorer Agent versión 1.0.34,  no comprueba los certificados HTTPS, un atacante en la red puede configurar estáticamente su dirección IP para que coincida con la dirección IP del servidor de Asset Explorer. Esto permitirá a un atacante enviar una petición NEWSCAN a un agente de escucha en la red, así como recibir la petición HTTP del agente comprobando su authtoken. En el archivo httphandler.cpp, el agente que llega a través de HTTP es vulnerable a un Desbordamiento de Enteros, que puede convertirse en un Desbordamiento de Pila que permite la ejecución de código remota como NT AUTHORITY/SYSTEM en la máquina del agente. El Desbordamiento de Enteros ocurre cuando se recibe la respuesta POST del servidor Manage Engine, y el agente llama a \"HttpQueryInfoW\" para obtener el tamaño \"Content-Length\" de la petición POST entrante. Este tamaño es tomado, pero multiplicado a una cantidad mayor. Si un atacante especifica un tamaño de Content-Length de 1073741823 o mayor, esta aritmética de enteros envolverá el valor de vuelta a un entero más pequeño, y luego llama a \"calloc\" con este tamaño para asignar memoria. La siguiente API \"InternetReadFile\" copiará los datos de POST en este búfer, que será demasiado pequeño para el contenido, y causará un desbordamiento de pila"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
          "baseScore": 10.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE"
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-190"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zohocorp:manageengine_assetexplorer:1.0.34:*:*:*:*:*:*:*",
              "matchCriteriaId": "2ED9862E-512A-4A1A-98F7-845ED9A62C44"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://www.tenable.com/security/research/tra-2021-31",
      "source": "vulnreport@tenable.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/security/research/tra-2021-31",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}