{
  "id": "CVE-2023-37470",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-08-04T16:15:09.610",
  "lastModified": "2024-11-21T08:11:46.617",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Metabase is an open-source business intelligence and analytics platform. Prior to versions 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3, and 1.46.6.4, a vulnerability could potentially allow remote code execution on one's Metabase server. The core issue is that one of the supported data warehouses (an embedded in-memory database H2), exposes a number of ways for a connection string to include code that is then executed by the process running the embedded database. Because Metabase allows users to connect to databases, this means that a user supplied string can be used to inject executable code. Metabase allows users to validate their connection string before adding a database (including on setup), and this validation API was the primary vector used as it can be called without validation. Versions 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3, and 1.46.6.4 fix this issue by removing the ability of users to add H2 databases entirely. As a workaround, it is possible to block these vulnerabilities at the network level by blocking the endpoints `POST /api/database`, `PUT /api/database/:id`, and `POST /api/setup/validateuntil`. Those who use H2 as a file-based database should migrate to SQLite."
    },
    {
      "lang": "es",
      "value": "Metabase es una plataforma de análisis e inteligencia empresarial de código abierto. Antes de las versiones 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3 y 1.46.6.4, una vulnerabilidad podía permitir la ejecución remota de código en el servidor Metabase. El problema central es que uno de los almacenes de datos soportados (una base de datos en memoria embebida H2), expone un varias maneras para que una cadena de conexión incluya código que luego es ejecutado por el proceso que ejecuta la base de datos embebida. Debido a que Metabase permite a los usuarios conectarse a bases de datos, esto significa que una cadena suministrada por el usuario puede ser utilizada para inyectar código ejecutable. Metabase permite a los usuarios validar su cadena de conexión antes de añadir una base de datos (incluso en la configuración), y esta API de validación fue el principal vector utilizado, ya que puede ser llamada sin validación. Las versiones 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3 y 1.46.6.4 solucionan este problema eliminando por completo la posibilidad de que los usuarios añadan bases de datos H2. Como solución, es posible bloquear estas vulnerabilidades a nivel de red bloqueando los endpoints `POST /api/database`, `PUT /api/database/:id`, y `POST /api/setup/validateuntil`. Quienes utilicen H2 como base de datos basada en ficheros deberían migrar a SQLite."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*",
              "versionEndExcluding": "0.43.7.3",
              "matchCriteriaId": "AFE116C8-B5B5-48CE-873D-1E508D1A656A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "1.43.7.3",
              "matchCriteriaId": "97C698D2-6F8A-4BD4-BC29-80086F1F87C0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "0.44.0",
              "versionEndExcluding": "0.44.7.3",
              "matchCriteriaId": "36C340AD-358E-478B-B75C-4A0A8F52F6C6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "0.45.0",
              "versionEndExcluding": "0.45.4.3",
              "matchCriteriaId": "A23C9D19-21F7-4529-8CF7-C20DACA524F3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "0.46.0",
              "versionEndExcluding": "0.46.6.4",
              "matchCriteriaId": "87EA14BE-A683-44D4-904D-3DEB8A672958"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.44.0",
              "versionEndExcluding": "1.44.7.3",
              "matchCriteriaId": "A4F52A25-3933-4D5D-A69F-073D31C079D2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.45.0",
              "versionEndExcluding": "1.45.4.3",
              "matchCriteriaId": "0ECC070D-27E2-40A2-A0D4-E818CBAB857D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.46.0",
              "versionEndExcluding": "1.46.6.4",
              "matchCriteriaId": "E025C478-8650-4B5E-B92F-9ACD2AA4C8C2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/metabase/metabase/security/advisories/GHSA-p7w3-9m58-rq83",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/metabase/metabase/security/advisories/GHSA-p7w3-9m58-rq83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}