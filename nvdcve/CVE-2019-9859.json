{
  "id": "CVE-2019-9859",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-03-10T13:15:12.657",
  "lastModified": "2024-11-21T04:52:27.237",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Vesta Control Panel (VestaCP) 0.9.7 through 0.9.8-23 is vulnerable to an authenticated command execution that can result in remote root access on the server. The platform works with PHP as the frontend language and uses shell scripts to execute system actions. PHP executes shell script through the dangerous command exec. This function can be dangerous if arguments passed to it are not filtered. Every user input in VestaCP that is used as an argument is filtered with the escapeshellarg function. This function comes from the PHP library directly and its description is as follows: \"escapeshellarg() adds single quotes around a string and quotes/escapes any existing single quotes allowing you to pass a string directly to a shell function and having it be treated as a single safe argument.\" It means that if you give Username, it will have 'Username' as a replacement. This works well and protects users from exploiting this potentially dangerous exec function. Unfortunately, VestaCP uses this escapeshellarg function incorrectly in several places."
    },
    {
      "lang": "es",
      "value": "Vesta Control Panel (VestaCP) versiones 0.9.7 hasta 0.9.8-23 es vulnerable a una ejecución de comando autenticada que puede resultar en un acceso remoto a la root en el servidor. La plataforma funciona con PHP como lenguaje frontend y usa scripts de shell para ejecutar acciones del sistema. PHP ejecuta script de shell por medio del peligroso comando exec. Esta función puede ser peligrosa si los argumentos pasados no son filtrados. Cada entrada de usuario en VestaCP que se utiliza como argumento es filtrada con la función escapeshellarg. Esta función proviene directamente de la biblioteca PHP y su descripción es la siguiente: \"escapeshellarg() agrega comillas simples alrededor de una cadena y cita/escapa a las comillas simples existentes permitiendo pasar una cadena directamente a una función de shell y hacer que se trate como un único argumento seguro\". Quiere decir, que si le da nombre de usuario, tendrá \"Username\" como reemplazo. Esto opera bien y protege a usuarios de explotar esta función exec peligrosa potencialmente. Desafortunadamente, VestaCP utiliza esta función escapeshellarg incorrectamente en varios lugares."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C",
          "baseScore": 9.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE"
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.0,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-78"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:vestacp:vesta_control_panel:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.9.7-0",
              "versionEndIncluding": "0.9.8-23",
              "matchCriteriaId": "77F99639-43D5-4D4C-B3E1-35543B48566E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://ssd-disclosure.com/?p=3926",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://ssd-disclosure.com/?p=3926",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}