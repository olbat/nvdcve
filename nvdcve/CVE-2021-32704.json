{
  "id": "CVE-2021-32704",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-06-24T16:15:08.553",
  "lastModified": "2024-11-21T06:07:33.983",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "DHIS 2 is an information system for data capture, management, validation, analytics and visualization. A SQL injection security vulnerability has been found in specific versions of DHIS2. This vulnerability affects the /api/trackedEntityInstances API endpoint in DHIS2 versions 2.34.4, 2.35.2, 2.35.3, 2.35.4, and 2.36.0. Earlier versions, such as 2.34.3 and 2.35.1 and all versions 2.33 and older are unaffected. The system is vulnerable to attack only from users that are logged in to DHIS2, and there is no known way of exploiting the vulnerability without first being logged in as a DHIS2 user. A successful exploit of this vulnerability could allow the malicious user to read, edit and delete data in the DHIS2 instance. There are no known exploits of the security vulnerabilities addressed by these patch releases. However, we strongly recommend that all DHIS2 implementations using versions 2.34, 2.35 and 2.36 install these patches as soon as possible. There is no straightforward known workaround for DHIS2 instances using the Tracker functionality other than upgrading the affected DHIS2 server to one of the patches in which this vulnerability has been fixed. For implementations which do NOT use Tracker functionality, it may be possible to block all network access to POST to the /api/trackedEntityInstance endpoint as a temporary workaround while waiting to upgrade."
    },
    {
      "lang": "es",
      "value": "DHIS 2 es un sistema de información para la captura, administración, comprobación, análisis y visualización de datos. Se ha encontrado una vulnerabilidad de seguridad de inyección SQL en versiones específicas de DHIS2. Esta vulnerabilidad afecta al endpoint de la API /api/trackedEntityInstances en las versiones 2.34.4, 2.35.2, 2.35.3, 2.35.4 y 2.36.0 de DHIS2. Las versiones anteriores, como 2.34.3 y 2.35.1 y todas las versiones 2.33 y anteriores no están afectadas. El sistema es vulnerable a los ataques sólo de usuarios que han iniciado sesión en DHIS2, y no hay forma conocida de explotar la vulnerabilidad sin haber iniciado sesión como usuario de DHIS2. Una explotación con éxito de esta vulnerabilidad podría permitir al usuario malicioso leer, editar y borrar datos en la instancia de DHIS2. No se conocen explotaciones de las vulnerabilidades de seguridad abordadas por estos parches. Sin embargo, recomendamos encarecidamente que todas las implementaciones de DHIS2 que usen las versiones 2.34, 2.35 y 2.36 instalen estos parches lo antes posible. No se presenta una solución directa conocida para las instancias de DHIS2 que usan la funcionalidad de Tracker, aparte de actualizar el servidor DHIS2 afectado a uno de los parches en los que se ha corregido esta vulnerabilidad. Para las implementaciones que NO utilizan la funcionalidad Tracker, puede ser posible bloquear todo el acceso de red a POST al endpoint /api/trackedEntityInstance como una solución temporal mientras se espera la actualización"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 8.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 6.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "baseScore": 6.5,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dhis2:dhis_2:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.34.4",
              "versionEndExcluding": "2.34.5",
              "matchCriteriaId": "2E181596-0143-4E55-A1A8-758D717D81C6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dhis2:dhis_2:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.35.2",
              "versionEndExcluding": "2.35.5",
              "matchCriteriaId": "D2EF577E-0738-4727-8483-98FAD4F6AB52"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dhis2:dhis_2:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.36.0",
              "versionEndExcluding": "2.36.1",
              "matchCriteriaId": "BA983C88-7D98-4C63-8A0D-4313F9F896B9"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/dhis2/dhis2-core/security/advisories/GHSA-fj38-585h-hxgj",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/security/advisories/GHSA-fj38-585h-hxgj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}