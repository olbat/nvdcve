{
  "id": "CVE-2022-22209",
  "sourceIdentifier": "sirt@juniper.net",
  "published": "2022-07-20T15:15:08.643",
  "lastModified": "2024-11-21T06:46:23.843",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "A Missing Release of Memory after Effective Lifetime vulnerability in the kernel of Juniper Networks Junos OS allows an unauthenticated network based attacker to cause a Denial of Service (DoS). On all Junos platforms, the Kernel Routing Table (KRT) queue can get stuck due to a memory leak triggered by interface flaps or route churn leading to RIB and PFEs getting out of sync. The memory leak causes RTNEXTHOP/route and next-hop memory pressure issue and the KRT queue will eventually get stuck with the error- 'ENOMEM -- Cannot allocate memory'. The out-of-sync state between RIB and FIB can be seen with the \"show route\" and \"show route forwarding-table\" command. This issue will lead to failures for adding new routes. The KRT queue status can be checked using the CLI command \"show krt queue\": user@host > show krt state High-priority add queue: 1 queued ADD nhtype Router index 0 (31212) error 'ENOMEM -- Cannot allocate memory' kqp '0x8ad5e40' The following messages will be observed in /var/log/messages, which indicate high memory for routes/nexthops: host rpd[16279]: RPD_RT_HWM_NOTICE: New RIB highwatermark for routes: 266 [2022-03-04 05:06:07] host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: Cannot allocate memory host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: Cannot allocate memory host kernel: rts_veto_net_delayed_unref_limit: Route/nexthop memory is severe pressure. User Application to perform recovery actions. O p 8 err 12, rtsm_id 0:-1, msg type 10, veto simulation: 0. host kernel: rts_veto_net_delayed_unref_limit: Memory usage of M_RTNEXTHOP type = (806321208) Max size possible for M_RTNEXTHOP type = (689432176) Current delayed unref = (0), Max delayed unref on this platform = (120000) Current delayed weight unref = (0) Max delayed weight unref on this platform = (400000) curproc = rpd. This issue affects: Juniper Networks Junos OS 21.2 versions prior to 21.2R3; 21.3 versions prior to 21.3R2-S1, 21.3R3; 21.4 versions prior to 21.4R1-S2, 21.4R2; This issue does not affect Juniper Networks Junos OS versions prior to 21.2R1."
    },
    {
      "lang": "es",
      "value": "Una vulnerabilidad de Falta de Liberación de Memoria después del Tiempo de Vida Efectivo en el kernel de Junos OS de Juniper Networks permite a un atacante no autenticado basado en la red causar una Denegación de Servicio (DoS). En todas las plataformas Junos, la cola de la tabla de enrutamiento del núcleo (KRT) puede atascarse debido a una pérdida de memoria desencadenada por las solapas de la interfaz o el cambio de rutas, lo que conlleva a una desincronización de las RIB y las PFE. La fuga de memoria causa un problema de presión de memoria en RTNEXTHOP/ruta y en el siguiente salto y la cola de KRT se atascará finalmente con el error \"ENOMEM -- Cannot allocate memory\". El estado de desincronización entre la RIB y la FIB puede verse con el comando \"show route\" y \"show route forwarding-table\". Este problema conlleva a fallos al añadir nuevas rutas. El estado de la cola KRT puede comprobarse mediante el comando CLI \"show krt queue\": user@host ) show krt state High-priority add queue: 1 queued ADD nhtype Router index 0 (31212) error 'ENOMEM -- Cannot allocate memory' kqp '0x8ad5e40' Serán observados los siguientes mensajes en /var/log/messages, que indican una memoria elevada para las rutas/nexthops: host rpd[16279]: RPD_RT_HWM_NOTICE: Nueva memoria alta RIB para rutas: 266 [2022-03-04 05:06:07] host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: No puede asignarse memoria host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: No puede asignarse memoria al host kernel: rts_veto_net_delayed_unref_limit: La memoria de la ruta/nexthop está sometida a una fuerte presión. Aplicación de usuario para llevar a cabo acciones de recuperación. O p 8 err 12, rtsm_id 0:-1, msg type 10, veto simulation: 0. kernel del host: rts_veto_net_delayed_unref_limit: Uso de la memoria del tipo M_RTNEXTHOP = (806321208) Tamaño máximo posible para el tipo M_RTNEXTHOP = (689432176) Unref retrasado actual = (0), Unref retrasado máximo en esta plataforma = (120000) Unref de peso retrasado actual = (0) Unref de peso retrasado máximo en esta plataforma = (400000) curproc = rpd. Este problema afecta a: Juniper Networks Junos OS 21.2 versiones anteriores a 21.2R3; 21.3 versiones anteriores a 21.3R2-S1, 21.3R3; 21.4 versiones anteriores a 21.4R1-S2, 21.4R2; Este problema no afecta a versiones de Juniper Networks Junos OS anteriores a 21.2R1"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "sirt@juniper.net",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "sirt@juniper.net",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:-:*:*:*:*:*:*",
              "matchCriteriaId": "216E7DDE-453D-481F-92E2-9F8466CDDA3F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r1:*:*:*:*:*:*",
              "matchCriteriaId": "A52AF794-B36B-43A6-82E9-628658624B0A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r1-s1:*:*:*:*:*:*",
              "matchCriteriaId": "3998DC76-F72F-4452-9150-652140B113EB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r1-s2:*:*:*:*:*:*",
              "matchCriteriaId": "36ED4552-2420-45F9-B6E4-6DA2B2B12870"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r2:*:*:*:*:*:*",
              "matchCriteriaId": "C28A14E7-7EA0-4757-9764-E39A27CFDFA5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r2-s1:*:*:*:*:*:*",
              "matchCriteriaId": "4A43752D-A4AF-4B4E-B95B-192E42883A5B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.2:r2-s2:*:*:*:*:*:*",
              "matchCriteriaId": "42986538-E9D0-4C2E-B1C4-A763A4EE451B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.3:-:*:*:*:*:*:*",
              "matchCriteriaId": "2E7D597D-F6B6-44C3-9EBC-4FA0686ACB5C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.3:r1:*:*:*:*:*:*",
              "matchCriteriaId": "CC78A4CB-D617-43FC-BB51-287D2D0C44ED"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.3:r1-s1:*:*:*:*:*:*",
              "matchCriteriaId": "30FF67F8-1E3C-47A8-8859-709B3614BA6E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.3:r1-s2:*:*:*:*:*:*",
              "matchCriteriaId": "0C7C507E-C85E-4BC6-A3B0-549516BAB524"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.3:r2:*:*:*:*:*:*",
              "matchCriteriaId": "6514CDE8-35DC-469F-89A3-078684D18F7A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.4:-:*:*:*:*:*:*",
              "matchCriteriaId": "79ED3CE8-CC57-43AB-9A26-BBC87816062D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.4:r1:*:*:*:*:*:*",
              "matchCriteriaId": "4310D2D9-A8A6-48F8-9384-0A0692A1E1C3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:juniper:junos:21.4:r1-s1:*:*:*:*:*:*",
              "matchCriteriaId": "9962B01C-C57C-4359-9532-676AB81CE8B0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://kb.juniper.net/JSA69713",
      "source": "sirt@juniper.net",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://kb.juniper.net/JSA69713",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}