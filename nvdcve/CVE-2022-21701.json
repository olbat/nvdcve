{
  "id": "CVE-2022-21701",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-01-19T22:15:09.547",
  "lastModified": "2024-11-21T06:45:15.887",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Istio is an open platform to connect, manage, and secure microservices. In versions 1.12.0 and 1.12.1 Istio is vulnerable to a privilege escalation attack. Users who have `CREATE` permission for `gateways.gateway.networking.k8s.io` objects can escalate this privilege to create other resources that they may not have access to, such as `Pod`. This vulnerability impacts only an Alpha level feature, the Kubernetes Gateway API. This is not the same as the Istio Gateway type (gateways.networking.istio.io), which is not vulnerable. Users are advised to upgrade to resolve this issue. Users unable to upgrade should implement any of the following which will prevent this vulnerability: Remove the gateways.gateway.networking.k8s.io CustomResourceDefinition, set PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER=true environment variable in Istiod, or remove CREATE permissions for gateways.gateway.networking.k8s.io objects from untrusted users."
    },
    {
      "lang": "es",
      "value": "Istio es una plataforma abierta para conectar, administrar y asegurar microservicios. En las versiones 1.12.0 y 1.12.1 Istio es vulnerable a un ataque de escalada de privilegios. Los usuarios que presentan permiso \"CREATE\" para los objetos \"gateways.gateway.networking.k8s.io\" pueden escalar este privilegio para crear otros recursos a los que no tienen acceso, como \"Pod\". Esta vulnerabilidad afecta sólo a una característica de nivel Alpha, la API de Kubernetes Gateway. No es lo mismo que el tipo de Gateway de Istio (gateways.networking.istio.io), que no es vulnerable. Se recomienda a los usuarios que actualicen para resolver este problema. Los usuarios que no puedan actualizar deberán implementar alguna de las siguientes medidas que evitarán esta vulnerabilidad: Eliminar el CustomResourceDefinition de gateways.gateway.networking.k8s.io, establecer la variable de entorno PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER=true en Istiod, o eliminar los permisos CREATE para los objetos de gateways.gateway.networking.k8s.io de los usuarios que no sean confiables"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "baseScore": 5.0,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 3.4
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
          "baseScore": 6.0,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 6.8,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "0C5B2B35-67C9-45E7-BD22-D5D0D2ABCF99"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha0:*:*:*:*:*:*",
              "matchCriteriaId": "AD00F2A2-486F-46E2-9BF4-6DE373ED8888"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha1:*:*:*:*:*:*",
              "matchCriteriaId": "BD0099BA-C66D-46F5-8FAA-A0907958C3EF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha5:*:*:*:*:*:*",
              "matchCriteriaId": "8CDAFD18-6EFA-4422-A96A-14EB4AB2C39D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta0:*:*:*:*:*:*",
              "matchCriteriaId": "67888CB0-9E8D-4B00-8EE1-15FCA8CACC99"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta1:*:*:*:*:*:*",
              "matchCriteriaId": "13297C9A-DAC0-4A30-9A12-FA1D97B5B3AB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta2:*:*:*:*:*:*",
              "matchCriteriaId": "211C5259-7CE6-43FD-BFC6-C6F9F814D43F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "2D226294-4A77-46E3-AF12-01DE9ECBC568"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "D13BA0A8-3131-4F15-AB6B-0B4C71885603"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-mq8f-9446-c28r",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/releases/1.12.x/announcing-1.12.2/",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-mq8f-9446-c28r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/releases/1.12.x/announcing-1.12.2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ]
}