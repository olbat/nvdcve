{
  "id": "CVE-2022-21679",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-01-19T22:15:09.397",
  "lastModified": "2024-11-21T06:45:12.923",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Istio is an open platform to connect, manage, and secure microservices. In Istio 1.12.0 and 1.12.1 The authorization policy with hosts and notHosts might be accidentally bypassed for ALLOW action or rejected unexpectedly for DENY action during the upgrade from 1.11 to 1.12.0/1.12.1. Istio 1.12 supports the hosts and notHosts fields in authorization policy with a new Envoy API shipped with the 1.12 data plane. A bug in the 1.12.0 and 1.12.1 incorrectly uses the new Envoy API with the 1.11 data plane. This will cause the hosts and notHosts fields to be always matched regardless of the actual value of the host header when mixing 1.12.0/1.12.1 control plane and 1.11 data plane. Users are advised to upgrade or to not mix the 1.12.0/1.12.1 control plane with 1.11 data plane if using hosts or notHosts field in authorization policy."
    },
    {
      "lang": "es",
      "value": "Istio es una plataforma abierta para conectar, administrar y asegurar microservicios. En Istio versiones 1.12.0 y 1.12.1 la política de autorización con hosts y notHosts podría ser accidentalmente omitida para la acción ALLOW o rechazada inesperadamente para la acción DENY durante la actualización de 1.11 a 1.12.0/1.12.1. Istio 1.12 soporta los campos hosts y notHosts en la política de autorización con una nueva API Envoy enviada con el plano de datos 1.12. Un error en las versiones 1.12.0 y 1.12.1 usa incorrectamente la nueva API de Envoy con el plano de datos 1.11. Esto causará que los campos hosts y notHosts siempre coincidan independientemente del valor real del encabezado del host cuando sean mezclados el plano de control 1.12.0/1.12.1 y el plano de datos 1.11. Se aconseja a usuarios actualizar o no mezclar el plano de control 1.12.0/1.12.1 con el plano de datos 1.11 si son usados los campos hosts o notHosts en la política de autorización"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N",
          "baseScore": 6.8,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "baseScore": 7.5,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-670"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-670"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "0C5B2B35-67C9-45E7-BD22-D5D0D2ABCF99"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha0:*:*:*:*:*:*",
              "matchCriteriaId": "AD00F2A2-486F-46E2-9BF4-6DE373ED8888"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha1:*:*:*:*:*:*",
              "matchCriteriaId": "BD0099BA-C66D-46F5-8FAA-A0907958C3EF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:alpha5:*:*:*:*:*:*",
              "matchCriteriaId": "8CDAFD18-6EFA-4422-A96A-14EB4AB2C39D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta0:*:*:*:*:*:*",
              "matchCriteriaId": "67888CB0-9E8D-4B00-8EE1-15FCA8CACC99"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta1:*:*:*:*:*:*",
              "matchCriteriaId": "13297C9A-DAC0-4A30-9A12-FA1D97B5B3AB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:beta2:*:*:*:*:*:*",
              "matchCriteriaId": "211C5259-7CE6-43FD-BFC6-C6F9F814D43F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "2D226294-4A77-46E3-AF12-01DE9ECBC568"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:1.12.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "D13BA0A8-3131-4F15-AB6B-0B4C71885603"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-rwfr-xrvw-2rvv",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/releases/1.12.x/announcing-1.12.2/",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-rwfr-xrvw-2rvv",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/releases/1.12.x/announcing-1.12.2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ]
}