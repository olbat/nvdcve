{
  "id": "CVE-2024-56331",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-12-20T20:15:24.337",
  "lastModified": "2024-12-20T20:15:24.337",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Uptime Kuma is an open source, self-hosted monitoring tool. An **Improper URL Handling Vulnerability** allows an attacker to access sensitive local files on the server by exploiting the `file:///` protocol. This vulnerability is triggered via the **\"real-browser\"** request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as `file:///etc/passwd`, an attacker can read sensitive data from the server. This vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically: 1. The URL input (`<input data-v-5f5c86d7=\"\" id=\"url\" type=\"url\" class=\"form-control\" pattern=\"https?://.+\" required=\"\">`) allows users to input arbitrary file paths, including those using the `file:///` protocol, without server-side validation. 2. The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the \"real-browser\" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., `file:///etc/passwd`), the browser fetches and captures the file’s content. Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., `file:///etc/passwd`), and the system will capture a screenshot of the file's content, potentially exposing sensitive data. Any **authenticated user** who can submit a URL in \"real-browser\" mode is at risk of exposing sensitive data through screenshots of these files. This issue has been addressed in version 1.23.16 and all users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Uptime Kuma es una herramienta de monitoreo alojada en el servidor y de código abierto. Una **vulnerabilidad de Improper URL Handling** permite a un atacante acceder a archivos locales confidenciales en el servidor mediante la explotación del protocolo `file:///`. Esta vulnerabilidad se activa a través del tipo de solicitud **\"real-browser\"**, que toma una captura de pantalla de la URL proporcionada por el atacante. Al proporcionar rutas de archivos locales, como `file:///etc/passwd`, un atacante puede leer datos confidenciales del servidor. Esta vulnerabilidad surge porque el sistema no valida ni desinfecta correctamente la entrada del usuario para el campo URL. Específicamente: 1. La entrada de URL (``) permite a los usuarios ingresar rutas de archivos arbitrarias, incluidas aquellas que utilizan el protocolo `file:///`, sin validación del lado del servidor. 2. El servidor utiliza la URL proporcionada por el usuario para realizar una solicitud y la pasa a una instancia del navegador que realiza la solicitud de \"navegador real\", que toma una captura de pantalla del contenido en la URL dada. Si se ingresa una ruta de archivo local (por ejemplo, `file:///etc/passwd`), el navegador obtiene y captura el contenido del archivo. Dado que la entrada del usuario no está validada, un atacante puede manipular la URL para solicitar archivos locales (por ejemplo, `file:///etc/passwd`), y el sistema capturará una captura de pantalla del contenido del archivo, lo que podría exponer datos confidenciales. Cualquier **usuario autenticado** que pueda enviar una URL en modo \"navegador real\" corre el riesgo de exponer datos confidenciales a través de capturas de pantalla de estos archivos. Este problema se ha solucionado en la versión 1.23.16 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N",
          "baseScore": 6.8,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h",
      "source": "security-advisories@github.com"
    }
  ]
}