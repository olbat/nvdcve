{
  "id": "CVE-2024-29184",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-03-22T17:15:08.203",
  "lastModified": "2025-01-10T15:06:59.540",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "FreeScout is a self-hosted help desk and shared mailbox. A Stored Cross-Site Scripting (XSS) vulnerability has been identified within the Signature Input Field of the FreeScout Application prior to version 1.8.128. Stored XSS occurs when user input is not properly sanitized and is stored on the server, allowing an attacker to inject malicious scripts that will be executed when other users access the affected page. In this case, the Support Agent User can inject malicious scripts into their signature, which will then be executed when viewed by the Administrator.\n\nThe application protects users against XSS attacks by enforcing a CSP policy, the CSP Policy is:  `script-src 'self' 'nonce-abcd'  `. The CSP policy only allows the inclusion of JS files that are present on the application server and doesn't allow any inline script or script other than nonce-abcd. The CSP policy was bypassed by uploading a JS file to the server by a POST request to /conversation/upload endpoint. After this, a working XSS payload was crafted by including the uploaded JS file link as the src of the script. This bypassed the CSP policy and XSS attacks became possible.\n\nThe impact of this vulnerability is severe as it allows an attacker to compromise the FreeScout Application. By exploiting this vulnerability, the attacker can perform various malicious actions such as forcing the Administrator to execute actions without their knowledge or consent. For instance, the attacker can force the Administrator to add a new administrator controlled by the attacker, thereby giving the attacker full control over the application. Alternatively, the attacker can elevate the privileges of a low-privileged user to Administrator, further compromising the security of the application. Attackers can steal sensitive information such as login credentials, session tokens, personal identifiable information (PII), and financial data. The vulnerability can also lead to defacement of the Application.\n\nVersion 1.8.128 contains a patch for this issue."
    },
    {
      "lang": "es",
      "value": "FreeScout es una mesa de ayuda autohospedada y un buzón de correo compartido. Se identificó una vulnerabilidad de cross-site scripting almacenados (XSS) dentro del campo de entrada de firma de la aplicación FreeScout antes de la versión 1.8.128. El XSS almacenado ocurre cuando la entrada del usuario no se sanitiza adecuadamente y se almacena en el servidor, lo que permite a un atacante inyectar scripts maliciosos que se ejecutarán cuando otros usuarios accedan a la página afectada. En este caso, el usuario del agente de soporte puede inyectar scripts maliciosos en su firma, que luego se ejecutarán cuando los vea el administrador. La aplicación protege a los usuarios contra ataques XSS al aplicar una política de CSP, la política de CSP es: `script-src 'self' 'nonce-abcd' `. La política de CSP solo permite la inclusión de archivos JS que están presentes en el servidor de aplicaciones y no permite ningún script en línea o script que no sea nonce-abcd. La política de CSP se omitió al cargar un archivo JS en el servidor mediante una solicitud POST al endpoint /conversation/upload. Después de esto, se creó un payload XSS funcional incluyendo el enlace del archivo JS cargado como el src del script. Esto eludió la política de CSP y los ataques XSS se hicieron posibles. El impacto de esta vulnerabilidad es grave ya que permite que un atacante comprometa la aplicación FreeScout. Al explotar esta vulnerabilidad, el atacante puede realizar diversas acciones maliciosas, como obligar al administrador a ejecutar acciones sin su conocimiento o consentimiento. Por ejemplo, el atacante puede obligar al administrador a agregar un nuevo administrador controlado por el atacante, dándole así control total sobre la aplicación. Alternativamente, el atacante puede elevar los privilegios de un usuario con pocos privilegios a Administrador, comprometiendo aún más la seguridad de la aplicación. Los atacantes pueden robar información confidencial, como credenciales de inicio de sesión, tokens de sesión, información de identificación personal (PII) y datos financieros. La vulnerabilidad también puede provocar la destrucción de la Aplicación. La versión 1.8.128 contiene un parche para este problema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 8.0,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 8.0,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:freescout:freescout:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.8.128",
              "matchCriteriaId": "C1CDF67D-DA8A-4C38-B082-2A146DD3B03D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/freescout-helpdesk/freescout/security/advisories/GHSA-fffc-phh8-5h4v",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/freescout-helpdesk/freescout/security/advisories/GHSA-fffc-phh8-5h4v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}