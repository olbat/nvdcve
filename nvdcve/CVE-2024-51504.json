{
  "id": "CVE-2024-51504",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-11-07T10:15:08.297",
  "lastModified": "2025-06-24T12:27:49.960",
  "vulnStatus": "Analyzed",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "When using IPAuthenticationProvider in ZooKeeper Admin Server there is a possibility of Authentication Bypass by Spoofing -- this only impacts IP based authentication implemented in ZooKeeper Admin Server. Default configuration of client's IP address detection in IPAuthenticationProvider, which uses HTTP request headers, is weak and allows an attacker to bypass authentication via spoofing client's IP address in request headers. Default configuration honors X-Forwarded-For HTTP header to read client's IP address. X-Forwarded-For request header is mainly used by proxy servers to identify the client and can be easily spoofed by an attacker pretending that the request comes from a different IP address. Admin Server commands, such as snapshot and restore arbitrarily can be executed on successful exploitation which could potentially lead to information leakage or service availability issues. Users are recommended to upgrade to version 3.9.3, which fixes this issue."
    },
    {
      "lang": "es",
      "value": "Al utilizar IPAuthenticationProvider en el servidor de administración de ZooKeeper, existe la posibilidad de omisión de autenticación por suplantación; esto solo afecta a la autenticación basada en IP implementada en el servidor de administración de ZooKeeper. La configuración predeterminada de la detección de la dirección IP del cliente en IPAuthenticationProvider, que utiliza encabezados de solicitud HTTP, es débil y permite a un atacante omitir la autenticación mediante la suplantación de la dirección IP del cliente en los encabezados de solicitud. La configuración predeterminada respeta el encabezado HTTP X-Forwarded-For para leer la dirección IP del cliente. El encabezado de solicitud X-Forwarded-For es utilizado principalmente por servidores proxy para identificar al cliente y puede ser fácilmente suplantado por un atacante que pretenda que la solicitud proviene de una dirección IP diferente. Los comandos del servidor de administración, como instantánea y restauración, se pueden ejecutar arbitrariamente en caso de explotación exitosa, lo que podría provocar fugas de información o problemas de disponibilidad del servicio. Se recomienda a los usuarios que actualicen a la versión 3.9.3, que soluciona este problema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-290"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:zookeeper:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.9.0",
              "versionEndExcluding": "3.9.3",
              "matchCriteriaId": "D6D94E88-B99B-4610-9DDB-4F16EEB88392"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.apache.org/thread/b3qrmpkto5r6989qr61fw9y2x646kqlh",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/11/06/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ]
}