{
  "id": "CVE-2017-5217",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-01-09T08:59:00.247",
  "lastModified": "2025-04-20T01:37:25.860",
  "vulnStatus": "Deferred",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "Installing a zero-permission Android application on certain Samsung Android devices with KK(4.4), L(5.0/5.1), and M(6.0) software can continually crash the system_server process in the Android OS. The zero-permission app will create an active install session for a separate app that it has embedded within it. The active install session of the embedded app is performed using the android.content.pm.PackageInstaller class and its nested classes in the Android API. The active install session will write the embedded APK file to the /data/app directory, but the app will not be installed since third-party applications cannot programmatically install apps. Samsung has modified AOSP in order to accelerate the parsing of APKs by introducing the com.android.server.pm.PackagePrefetcher class and its nested classes. These classes will parse the APKs present in the /data/app directory and other directories, even if the app is not actually installed. The embedded APK that was written to the /data/app directory via the active install session has a very large but valid AndroidManifest.xml file. Specifically, the AndroidManifest.xml file contains a very large string value for the name of a permission-tree that it declares. When system_server tries to parse the APK file of the embedded app from the active install session, it will crash due to an uncaught error (i.e., java.lang.OutOfMemoryError) or an uncaught exception (i.e., std::bad_alloc) because of memory constraints. The Samsung Android device will encounter a soft reboot due to a system_server crash, and this action will keep repeating since parsing the APKs in the /data/app directory as performed by the system_server process is part of the normal boot process. The Samsung ID is SVE-2016-6917."
    },
    {
      "lang": "es",
      "value": "La instalación de una aplicación Android de cero permisos en ciertos dispositivos Samsung con software KK(4.4), L(5.0/5.1) y M(6.0) puede bloquear continuamente el proceso system_server en el SO Android. La aplicación de cero permisos creará una sesión de instalación activa para una aplicación separada que tiene embebida. La sesión de instalación activa de la aplicación embebida se realiza usando la clase android.content.pm.PackageInstaller y sus clases anidadas en la API de Android. La instalación activa escribirá el archivo APK embebido en el directorio /data/app, pero la aplicación no se instalará ya que las aplicaciones de terceros no pueden instalar aplicaciones de forma programada. Samsung ha modificado AOSP para acelerar el análisis de APKs introduciendo la clase com.android.server.pm.PackagePrefetcher y sus clases anidadas. Estas clases analizarán las APKs presentes en el directorio /data/app y otros directorios, incluso si la aplicación no está instalada actualmente. El APK embebido que se escribió en el directorio /data/app a través de la sesión de instalación activada tiene un archivo AndroidManifest.xml muy extenso pero válido. Específicamente, el archivo AndroidManifest.xml contiene un valor de cadena muy grande para el nombre de un árbol de permisos que declara. Cuando system_server intenta analizar el archivo APK de la aplicación embebida de la sesión de instalación activa, se bloqueará debido a un error no detectado (java.lang.OutOfMemoryError) o una excepción no detectada (std::bad_alloc) por restricciones de memoria. El dispositivo Samsung Android se encontrará con un reinicio suave debido a un fallo de system_server, y esta acción se repetirá debido a que el análisis de los APK en el directorio /data/app realizado a través de system_server, es parte del funcionamiento normal. La ID de Samsung es SVE-2016-6917."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:C",
          "baseScore": 7.1,
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "COMPLETE"
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.6,
        "impactScore": 6.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        },
        {
          "lang": "en",
          "value": "CWE-119"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:4.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "68B4FF3D-35CC-4E86-A6EE-D065D654FC4A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "A13E2E2D-41E2-4CF7-A019-6B462A614271"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:5.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "DD99CD57-C55D-4812-8F9C-5ACE7555C086"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:6.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "ABD6EA64-6B65-4487-914F-9EF9CBB78211"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95319",
      "source": "cve@mitre.org"
    },
    {
      "url": "http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95319",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}