{
  "id": "CVE-2023-7080",
  "sourceIdentifier": "cna@cloudflare.com",
  "published": "2023-12-29T12:15:47.970",
  "lastModified": "2024-11-21T08:45:12.610",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The V8 inspector intentionally allows arbitrary code execution within the Workers sandbox for debugging. wrangler dev would previously start an inspector server listening on all network interfaces. This would allow an attacker on the local network to connect to the inspector and run arbitrary code. Additionally, the inspector server did not validate Origin/Host headers, granting an attacker that can trick any user on the local network into opening a malicious website the ability to run code. If wrangler dev --remote was being used, an attacker could access production resources if they were bound to the worker.\n\nThis issue was fixed in wrangler@3.19.0 and wrangler@2.20.2. Whilst wrangler dev's inspector server listens on local interfaces by default as of wrangler@3.16.0, an  SSRF vulnerability in miniflare https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-fwvg-2739-22v7  (CVE-2023-7078) allowed access from the local network until wrangler@3.18.0. wrangler@3.19.0 and wrangler@2.20.2 introduced validation for the Origin/Host headers.\n"
    },
    {
      "lang": "es",
      "value": "V8 inspector permite intencionalmente la ejecución de código arbitrario dentro de la sandbox de Workers para su depuración. wrangler dev previamente iniciaría un servidor inspector escuchando en todas las interfaces de red. Esto permitiría a un atacante en la red local conectarse al inspector y ejecutar código arbitrario. Además, el servidor inspector no validó los encabezados Origin/Host, lo que le otorga a un atacante que puede engañar a cualquier usuario de la red local para que abra un sitio web malicioso la capacidad de ejecutar código. Si se usaba wrangler dev --remote, un atacante podría acceder a los recursos de producción si estuvieran vinculados al trabajador. Este problema se solucionó en wrangler@3.19.0 y wrangler@2.20.2. Si bien el servidor inspector de wrangler dev escucha en las interfaces locales de forma predeterminada a partir de wrangler@3.16.0, se ha detectado una vulnerabilidad SSRF en miniflare https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-fwvg-2739-22v7&#xa0;( CVE-2023-7078) permitía el acceso desde la red local hasta wrangler@3.18.0. wrangler@3.19.0 y wrangler@2.20.2 introdujeron la validación para los encabezados Origen/Host."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cna@cloudflare.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N",
          "baseScore": 8.5,
          "baseSeverity": "HIGH",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 5.8
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "baseScore": 8.0,
          "baseSeverity": "HIGH",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cna@cloudflare.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:cloudflare:wrangler:*:*:*:*:*:node.js:*:*",
              "versionStartIncluding": "2.0.0",
              "versionEndExcluding": "2.20.2",
              "matchCriteriaId": "9BC3CE33-76AB-4812-BCBD-C65F5728471D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:cloudflare:wrangler:*:*:*:*:*:node.js:*:*",
              "versionStartIncluding": "3.0.0",
              "versionEndExcluding": "3.19.0",
              "matchCriteriaId": "4F11F521-F7AC-4E31-9424-4CB968F50E6E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/cloudflare/workers-sdk/issues/4430",
      "source": "cna@cloudflare.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4437",
      "source": "cna@cloudflare.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4535",
      "source": "cna@cloudflare.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4550",
      "source": "cna@cloudflare.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-f8mp-x433-5wpf",
      "source": "cna@cloudflare.com",
      "tags": [
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/issues/4430",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4437",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4535",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/pull/4550",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-f8mp-x433-5wpf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}