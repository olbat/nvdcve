{
  "id": "CVE-2020-28942",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-11-19T17:15:13.310",
  "lastModified": "2024-11-21T05:23:20.577",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue exists in PrimeKey EJBCA before 7.4.3 when enrolling with EST while proxied through an RA over the Peers protocol. As a part of EJBCA's domain security model, the peer connector allows the restriction of client certificates (for the RA, not the end user) to a limited set of allowed CAs, thus restricting the accessibility of that RA to the rights it has within a specific role. While this works for other protocols such as CMP, it was found that the EJBCA enrollment over an EST implementation bypasses this check, allowing enrollment with a valid client certificate through any functioning and authenticated RA connected to the CA. NOTE: an attacker must already have a trusted client certificate and authorization to enroll against the targeted CA."
    },
    {
      "lang": "es",
      "value": "Se presenta un problema en PrimeKey EJBCA versiones anteriores a 7.4.3 cuando se inscribe con EST mientras se realiza un proxy por medio de un RA sobre el protocolo Peers.&#xa0;Como parte del modelo de seguridad de dominio de EJBCA, el conector de peers permite la restricción de certificados de cliente (para el RA, no para el usuario final) a un ajuste limitado de CAs permitidas, restringiendo así la accesibilidad de ese RA a los derechos que presenta dentro de un papel específico.&#xa0;Si bien esto funciona para otros protocolos como CMP, se encontró que la inscripción EJBCA sobre una implementación de EST al omitir esta comprobación, permite la inscripción con un certificado de cliente válido por medio de cualquier RA autenticado y en funcionamiento conectado a la CA.&#xa0;NOTA: un atacante ya debe tener un certificado de cliente confiable y autorización para inscribirse en la CA apuntado"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N",
          "baseScore": 4.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "7.4.3",
              "matchCriteriaId": "1AD6F9F4-0E93-4978-9585-1748B9F3B2F5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://support.primekey.com/news/posts/40",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://support.primekey.com/news/posts/40",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}