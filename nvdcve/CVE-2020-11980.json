{
  "id": "CVE-2020-11980",
  "sourceIdentifier": "security@apache.org",
  "published": "2020-06-12T22:15:11.473",
  "lastModified": "2024-11-21T04:59:02.447",
  "vulnStatus": "Modified",
  "cveTags": [

  ],
  "descriptions": [
    {
      "lang": "en",
      "value": "In Karaf, JMX authentication takes place using JAAS and authorization takes place using ACL files. By default, only an \"admin\" can actually invoke on an MBean. However there is a vulnerability there for someone who is not an admin, but has a \"viewer\" role. In the 'etc/jmx.acl.cfg', such as role can call get*. It's possible to authenticate as a viewer role + invokes on the MLet getMBeansFromURL method, which goes off to a remote server to fetch the desired MBean, which is then registered in Karaf. At this point the attack fails as \"viewer\" doesn't have the permission to invoke on the MBean. Still, it could act as a SSRF style attack and also it essentially allows a \"viewer\" role to pollute the MBean registry, which is a kind of privilege escalation. The vulnerability is low as it's possible to add a ACL to limit access. Users should update to Apache Karaf 4.2.9 or newer."
    },
    {
      "lang": "es",
      "value": "En Karaf, la autenticación JMX se lleva a cabo usando JAAS y la autorización utilizando archivos de ACL. Por defecto, solo un \"admin\" puede invocar actualmente en un MBean. Sin embargo, se presenta una vulnerabilidad para alguien que no es administrador, pero que tiene un rol de \"viewer\". En \"etc/jmx.acl.cfg\", como el role puede llamar a get*. Es posible autenticarse como un rol viewer + invocar en el método MLet getMBeansFromURL, que se envía hacia un servidor remoto para obtener el MBean deseado, que luego se registra en Karaf. En este punto, se presenta un fallo en el ataque ya que el \"viewer\" no tiene permiso para invocar en el MBean. Aún así, podría actuar como un ataque de estilo SSRF y también esencialmente permite que un rol de \"viewer\" contamine el registro MBean, que es un tipo de escalada de privilegios. La vulnerabilidad es baja ya que es posible agregar una ACL para limitar el acceso. Los usuarios deben actualizar a Apache Karaf versiones 4.2.9 o mas recientes"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "baseScore": 6.5,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "4.2.9",
              "matchCriteriaId": "7EA828D5-CB5C-45F1-9522-B5CF5E4C3E5F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://karaf.apache.org/security/cve-2020-11980.txt",
      "source": "security@apache.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://karaf.apache.org/security/cve-2020-11980.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}