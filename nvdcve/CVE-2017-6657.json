{
  "id": "CVE-2017-6657",
  "sourceIdentifier": "psirt@cisco.com",
  "published": "2017-05-16T17:29:00.403",
  "lastModified": "2025-04-20T01:37:25.860",
  "vulnStatus": "Deferred",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Cisco Sourcefire Snort 3.0 before build 233 mishandles Ether Type Validation. Since valid ether type and IP protocol numbers do not overlap, Snort++ stores all protocol decoders in a single array. That makes it possible to craft packets that have IP protocol numbers in the ether type field which will confuse the Snort++ decoder. For example, an eth:llc:snap:icmp6 packet will cause a crash because there is no ip6 header with which to calculate the icmp6 checksum. Affected decoders include gre, llc, trans_bridge, ciscometadata, linux_sll, and token_ring. The fix adds a check in the packet manager to validate the ether type before indexing the decoder array. An out of range ether type will raise 116:473."
    },
    {
      "lang": "es",
      "value": "Sourcefire Snort de Cisco versión 3.0 anterior a build 233, maneja inapropiadamente la comprobación de Ether Type. A partir de un tipo ether válido y números de protocolo IP no superpuestos, Snort++ almacena todos los decodificadores de protocolo en una sola matriz. Eso hace posible diseñar paquetes que tengan números de protocolo IP en el campo ether type que confundirá al decodificador Snort++. Por ejemplo, un paquete eth:llc:snap:icmp6 causará un bloqueo porque no existe encabezado ip6 con que calcular la suma de comprobación icmp6. Los decodificadores afectados incluyen gre, llc, trans_bridge, ciscometadata, linux_sll y token_ring. La corrección agrega una verificación en el administrador de paquetes para comprobar el tipo ether antes de indexar la matriz de decodificador. Un tipo ether fuera de rango elevará a 116:473."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "baseScore": 5.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL"
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:cisco:snort\\+\\+:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "9BF1C707-351E-4432-A14F-C5A73D528290"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://blog.snort.org/2017/05/snort-vulnerabilities-found.html",
      "source": "psirt@cisco.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1038483",
      "source": "psirt@cisco.com"
    },
    {
      "url": "https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170515-snort",
      "source": "nvd@nist.gov",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://blog.snort.org/2017/05/snort-vulnerabilities-found.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1038483",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}