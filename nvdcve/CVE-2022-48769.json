{
  "id": "CVE-2022-48769",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-06-20T12:15:14.870",
  "lastModified": "2024-11-21T07:33:59.150",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nefi: runtime: avoid EFIv2 runtime services on Apple x86 machines\n\nAditya reports [0] that his recent MacbookPro crashes in the firmware\nwhen using the variable services at runtime. The culprit appears to be a\ncall to QueryVariableInfo(), which we did not use to call on Apple x86\nmachines in the past as they only upgraded from EFI v1.10 to EFI v2.40\nfirmware fairly recently, and QueryVariableInfo() (along with\nUpdateCapsule() et al) was added in EFI v2.00.\n\nThe only runtime service introduced in EFI v2.00 that we actually use in\nLinux is QueryVariableInfo(), as the capsule based ones are optional,\ngenerally not used at runtime (all the LVFS/fwupd firmware update\ninfrastructure uses helper EFI programs that invoke capsule update at\nboot time, not runtime), and not implemented by Apple machines in the\nfirst place. QueryVariableInfo() is used to 'safely' set variables,\ni.e., only when there is enough space. This prevents machines with buggy\nfirmwares from corrupting their NVRAMs when they run out of space.\n\nGiven that Apple machines have been using EFI v1.10 services only for\nthe longest time (the EFI v2.0 spec was released in 2006, and Linux\nsupport for the newly introduced runtime services was added in 2011, but\nthe MacbookPro12,1 released in 2015 still claims to be EFI v1.10 only),\nlet's avoid the EFI v2.0 ones on all Apple x86 machines.\n\n[0] https://lore.kernel.org/all/6D757C75-65B1-468B-842D-10410081A8E4@live.com/"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se resolvió la siguiente vulnerabilidad: efi: runtime: evite los servicios de tiempo de ejecución EFIv2 en máquinas Apple x86 Aditya informa [0] que su reciente MacbookPro falla en el firmware cuando usa los servicios variables en tiempo de ejecución. El culpable parece ser una llamada a QueryVariableInfo(), que no utilizamos para llamar a máquinas Apple x86 en el pasado, ya que recientemente se actualizaron del firmware EFI v1.10 al firmware EFI v2.40, y QueryVariableInfo() (junto con con UpdateCapsule() et al) se agregó en EFI v2.00. El único servicio de tiempo de ejecución introducido en EFI v2.00 que realmente usamos en Linux es QueryVariableInfo(), ya que los basados en cápsulas son opcionales y generalmente no se usan en tiempo de ejecución (toda la infraestructura de actualización de firmware LVFS/fwupd utiliza programas EFI auxiliares que invocan la cápsula). actualizar en el momento del arranque, no en el tiempo de ejecución) y, en primer lugar, no lo implementan las máquinas Apple. QueryVariableInfo() se utiliza para establecer variables de forma \"segura\", es decir, sólo cuando hay suficiente espacio. Esto evita que las máquinas con firmwares defectuosos dañen sus NVRAM cuando se quedan sin espacio. Dado que las máquinas Apple han estado usando los servicios EFI v1.10 solo durante más tiempo (la especificación EFI v2.0 se lanzó en 2006 y el soporte de Linux para los servicios de ejecución recientemente introducidos se agregó en 2011, pero el MacbookPro12,1 se lanzó en 2015 todavía afirma ser solo EFI v1.10), evitemos los EFI v2.0 en todas las máquinas Apple x86. [0] https://lore.kernel.org/all/6D757C75-65B1-468B-842D-10410081A8E4@live.com/"
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/3df52448978802ae15dcebf66beba1029df957b4",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/a4085859411c825c321c9b55b8a9dc5a128a6684",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/b0f1cc093bc2493ac259c53766fd2b800e085807",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/f5390cd0b43c2e54c7cf5506c7da4a37c5cef746",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/3df52448978802ae15dcebf66beba1029df957b4",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/a4085859411c825c321c9b55b8a9dc5a128a6684",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/b0f1cc093bc2493ac259c53766fd2b800e085807",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://git.kernel.org/stable/c/f5390cd0b43c2e54c7cf5506c7da4a37c5cef746",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}