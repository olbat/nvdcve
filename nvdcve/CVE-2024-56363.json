{
  "id": "CVE-2024-56363",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-12-23T18:15:07.767",
  "lastModified": "2024-12-23T18:15:07.767",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "APTRS (Automated Penetration Testing Reporting System) is a Python and Django-based automated reporting tool designed for penetration testers and security organizations. In 1.0, there is a vulnerability in the web application's handling of user-supplied input that is incorporated into a Jinja2 template. Specifically, when user input is improperly sanitized or validated, an attacker can inject Jinja2 syntax into the template, causing the server to execute arbitrary code. For example, an attacker might be able to inject expressions like {{ config }}, {{ self.class.mro[1].subclasses() }}, or more dangerous payloads that trigger execution of arbitrary Python code. The vulnerability can be reproduced by submitting crafted input to all the template fields handled by ckeditor, that are passed directly to a Jinja2 template. If the input is rendered without sufficient sanitization, it results in the execution of malicious Jinja2 code on the server."
    },
    {
      "lang": "es",
      "value": "APTRS (Sistema automatizado de informes de pruebas de penetración) es una herramienta de informes automatizada basada en Python y Django manipulada para evaluadores de penetración y organizaciones de seguridad. En 1.0, hay una vulnerabilidad en la gestión por parte de la aplicación web de la entrada proporcionada por el usuario que se incorpora a una plantilla Jinja2. Específicamente, cuando la entrada del usuario se desinfecta o valida incorrectamente, un atacante puede inyectar la sintaxis de Jinja2 en la plantilla, lo que hace que el servidor ejecute código arbitrario. Por ejemplo, un atacante podría inyectar expresiones como {{ config }}, {{ self.class.mro[1].subclasses() }} o payloads más peligrosos que desencadenan la ejecución de código Python arbitrario. La vulnerabilidad se puede reproducir enviando entradas manipuladas a todos los campos de plantilla manejados por ckeditor, que se pasan directamente a una plantilla Jinja2. Si la entrada se procesa sin una desinfección suficiente, se produce la ejecución de código Jinja2 malicioso en el servidor."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-97"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/APTRS/APTRS/commit/9f6b6e4a56a9119eb12126a4909441e83b6d7c11",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/APTRS/APTRS/security/advisories/GHSA-h4w2-hvcg-938j",
      "source": "security-advisories@github.com"
    }
  ]
}