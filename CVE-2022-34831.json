{
  "id": "CVE-2022-34831",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-09-14T03:15:08.050",
  "lastModified": "2024-11-21T07:10:16.473",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in Keyfactor PrimeKey EJBCA before 7.9.0, related to possible inconsistencies in DNS identifiers submitted in an ACME order and the corresponding CSR submitted during finalization. During the ACME enrollment process, an order is submitted containing an identifier for one or multiple dnsNames. These are validated properly in the ACME challenge. However, if the validation passes, a non-compliant client can include additional dnsNames the CSR sent to the finalize endpoint, resulting in EJBCA issuing a certificate including the identifiers that were not validated. This occurs even if the certificate profile is configured to not allow a DN override by the CSR."
    },
    {
      "lang": "es",
      "value": "Se ha detectado un problema en Keyfactor PrimeKey EJBCA versiones anteriores a 7.9.0, relacionado con posibles incoherencias en los identificadores DNS enviados en un pedido ACME y el correspondiente CSR enviado durante la finalización. Durante el proceso de inscripción en ACME, es enviada una orden que contiene un identificador para uno o varios dnsNames. Estos son comprobados apropiadamente en la impugnación de ACME. Sin embargo, si la comprobación es superada, un cliente no conforme puede incluir dnsNames adicionales en la CSR enviada al endpoint de finalización, resultando en que EJBCA emita un certificado que incluya los identificadores que no fueron comprobados. Esto ocurre incluso si el perfil de certificado está configurado para no permitir una anulación de DN por el CSR"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "7.9.0",
              "matchCriteriaId": "1C4A9E1E-3709-4B52-AE01-A8556FED5660"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://support.keyfactor.com/s/detail/a6x1Q000000CwC5QAK",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.primekey.com/products/ejbca-enterprise/",
      "source": "cve@mitre.org",
      "tags": [
        "Product",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://support.keyfactor.com/s/detail/a6x1Q000000CwC5QAK",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.primekey.com/products/ejbca-enterprise/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Vendor Advisory"
      ]
    }
  ]
}