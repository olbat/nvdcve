{
  "id": "CVE-2025-5352",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2025-08-23T07:15:32.300",
  "lastModified": "2025-08-25T20:24:45.327",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A critical stored Cross-Site Scripting (XSS) vulnerability exists in the Analytics component of lunary-ai/lunary versions up to 1.9.23, where the NEXT_PUBLIC_CUSTOM_SCRIPT environment variable is directly injected into the DOM using dangerouslySetInnerHTML without any sanitization or validation. This allows arbitrary JavaScript execution in all users' browsers if an attacker can control the environment variable during deployment or through server compromise. The vulnerability can lead to complete account takeover, data exfiltration, malware distribution, and persistent attacks affecting all users until the environment variable is cleaned. The issue is fixed in version 1.9.25."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad crítica de cross-site scripting (XSS) almacenado en el componente Analytics de las versiones de lunary-ai/lunary hasta la 1.9.23. En esta vulnerabilidad, la variable de entorno NEXT_PUBLIC_CUSTOM_SCRIPT se inyecta directamente en el DOM mediante dangerouslySetInnerHTML sin ninguna validación ni depuración. Esto permite la ejecución arbitraria de JavaScript en los navegadores de todos los usuarios si un atacante puede controlar la variable de entorno durante la implementación o mediante la vulneración del servidor. Esta vulnerabilidad puede provocar la apropiación total de cuentas, la exfiltración de datos, la distribución de malware y ataques persistentes que afectan a todos los usuarios hasta que se limpie la variable de entorno. El problema se ha corregido en la versión 1.9.25."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/lunary-ai/lunary/commit/e2e43e88cecf742bacb639ab880507bbfdfd065c",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://huntr.com/bounties/f1d3dbce-3c3e-480e-b81e-0e8afa05c491",
      "source": "security@huntr.dev"
    }
  ]
}