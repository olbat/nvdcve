{
  "id": "CVE-2024-7589",
  "sourceIdentifier": "secteam@freebsd.org",
  "published": "2024-08-12T13:38:44.203",
  "lastModified": "2024-11-21T09:51:46.310",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A signal handler in sshd(8) may call a logging function that is not async-signal-safe.  The signal handler is invoked when a client does not authenticate within the LoginGraceTime seconds (120 by default).  This signal handler executes in the context of the sshd(8)'s privileged code, which is not sandboxed and runs with full root privileges.\n\nThis issue is another instance of the problem in CVE-2024-6387 addressed by FreeBSD-SA-24:04.openssh.  The faulty code in this case is from the integration of blacklistd in OpenSSH in FreeBSD.\n\nAs a result of calling functions that are not async-signal-safe in the privileged sshd(8) context, a race condition exists that a determined attacker may be able to exploit to allow an unauthenticated remote code execution as root."
    },
    {
      "lang": "es",
      "value": "Un manejador de señales en sshd(8) puede llamar a una función de registro que no es segura para señales asíncronas. El controlador de señales se invoca cuando un cliente no se autentica dentro de los segundos de LoginGraceTime (120 de forma predeterminada). Este controlador de señales se ejecuta en el contexto del código privilegiado de sshd(8), que no está protegido y se ejecuta con privilegios de root completos. Este problema es otro ejemplo del problema en CVE-2024-6387 solucionado por FreeBSD-SA-24:04.openssh. El código defectuoso en este caso proviene de la integración de blacklistd en OpenSSH en FreeBSD. Como resultado de llamar a funciones que no son seguras para señales asíncronas en el contexto privilegiado sshd(8), existe una condición de ejecución que un atacante determinado puede aprovechar para permitir la ejecución remota de código no autenticado como root."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      },
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-362"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-364"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "13.0",
              "matchCriteriaId": "18A4E85D-70A5-4382-AAB7-4A531615613D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "13.1",
              "versionEndExcluding": "13.3",
              "matchCriteriaId": "FEC367A5-24D1-414E-BC77-07968E787D01"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p1:*:*:*:*:*:*",
              "matchCriteriaId": "ABEA48EC-24EA-4106-9465-CE66B938635F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p2:*:*:*:*:*:*",
              "matchCriteriaId": "8DFB5BD0-E777-4CAA-B2E0-3F3357D06D01"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p3:*:*:*:*:*:*",
              "matchCriteriaId": "BC8C769C-A23E-4F61-AC42-4DA64421B096"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p4:*:*:*:*:*:*",
              "matchCriteriaId": "45B0589E-2E7D-4516-A8A0-88F30038EAB0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:beta5:*:*:*:*:*:*",
              "matchCriteriaId": "DB7B021E-F4AD-44AC-96AB-8ACAF8AB1B88"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p1:*:*:*:*:*:*",
              "matchCriteriaId": "69A72B5A-2189-4700-8E8B-1E5E7CA86C40"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p2:*:*:*:*:*:*",
              "matchCriteriaId": "5771F187-281B-4680-B562-EFC7441A8F88"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p3:*:*:*:*:*:*",
              "matchCriteriaId": "0A4437F5-9DDA-4769-974E-23BFA085E0DB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p4:*:*:*:*:*:*",
              "matchCriteriaId": "A9C3A3D4-C9F4-41EB-B532-821AF83470B1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p5:*:*:*:*:*:*",
              "matchCriteriaId": "878A1F0A-087F-47D7-9CA5-A54BB8D6676A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p6:*:*:*:*:*:*",
              "matchCriteriaId": "CE73CDC3-B5A7-4921-89C6-8F9DC426CB3E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p7:*:*:*:*:*:*",
              "matchCriteriaId": "50A5E650-31FB-45BE-8827-641B58A83E45"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p8:*:*:*:*:*:*",
              "matchCriteriaId": "D59CFDD3-AEC3-43F1-A620-0B1F0BAD9048"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc3:*:*:*:*:*:*",
              "matchCriteriaId": "038E5B85-7F60-4D71-8D3F-EDBF6E036CE0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc4-p1:*:*:*:*:*:*",
              "matchCriteriaId": "BF309824-D379-4749-A1FA-BCB2987DD671"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p1:*:*:*:*:*:*",
              "matchCriteriaId": "AA813990-8C8F-4EE8-9F2B-9F73C510A7B2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p2:*:*:*:*:*:*",
              "matchCriteriaId": "D4DFA201-27D5-4C01-B90F-E24778943C3B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://security.freebsd.org/advisories/FreeBSD-SA-24:08.openssh.asc",
      "source": "secteam@freebsd.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.cve.org/CVERecord?id=CVE-2006-5051",
      "source": "secteam@freebsd.org",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://www.cve.org/CVERecord?id=CVE-2024-6387",
      "source": "secteam@freebsd.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240816-0002/",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}