{
  "id": "CVE-2024-31214",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-04-10T18:15:07.350",
  "lastModified": "2025-01-09T16:14:43.407",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Traccar is an open source GPS tracking system. Traccar versions 5.1 through 5.12 allow arbitrary files to be uploaded through the device image upload API. Attackers have full control over the file contents, full control over the directory where the file is stored, full control over the file extension, and partial control over the file name. While it's not  for an attacker to overwrite an existing file, an attacker can create new files with certain names and attacker-controlled extensions anywhere on the file system. This can potentially lead to remote code execution, XSS, DOS, etc. The default install of Traccar makes this vulnerability more severe. Self-registration is enabled by default, allowing anyone to create an account to exploit this vulnerability. Traccar also runs by default with root/system privileges, allowing files to be placed anywhere on the file system. Version 6.0 contains a fix for the issue. One may also turn off self-registration by default, as that would make most vulnerabilities in the application much harder to exploit by default and reduce the severity considerably.\n"
    },
    {
      "lang": "es",
      "value": "Traccar es un sistema de rastreo GPS de código abierto. Las versiones 5.1 a 5.12 de Traccar permiten cargar archivos arbitrarios a través de la API de carga de imágenes del dispositivo. Los atacantes tienen control total sobre el contenido del archivo, control total sobre el directorio donde se almacena el archivo, control total sobre la extensión del archivo y control parcial sobre el nombre del archivo. Si bien no le corresponde a un atacante sobrescribir un archivo existente, un atacante puede crear nuevos archivos con ciertos nombres y extensiones controladas por el atacante en cualquier parte del sistema de archivos. Esto puede conducir potencialmente a la ejecución remota de código, XSS, DOS, etc. La instalación predeterminada de Traccar hace que esta vulnerabilidad sea más grave. El autorregistro está habilitado de forma predeterminada, lo que permite que cualquiera cree una cuenta para explotar esta vulnerabilidad. Traccar también se ejecuta de forma predeterminada con privilegios de root/sistema, lo que permite colocar archivos en cualquier parte del sistema de archivos. La versión 6.0 contiene una solución para el problema. También se puede desactivar el autorregistro de forma predeterminada, ya que eso haría que la mayoría de las vulnerabilidades de la aplicación sean mucho más difíciles de explotar de forma predeterminada y reduciría considerablemente la gravedad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
          "baseScore": 9.6,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 6.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
          "baseScore": 9.6,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-434"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-434"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:traccar:traccar:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.1",
              "versionEndIncluding": "5.12",
              "matchCriteriaId": "27A24D4B-A938-44B4-8630-B3A2F3B97900"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/traccar/traccar/blob/master/src/main/java/org/traccar/model/Device.java#L56",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/v5.12/src/main/java/org/traccar/api/resource/DeviceResource.java#L191",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/commit/3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-3gxq-f2qj-c8v9",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/master/src/main/java/org/traccar/model/Device.java#L56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/v5.12/src/main/java/org/traccar/api/resource/DeviceResource.java#L191",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/commit/3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-3gxq-f2qj-c8v9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}