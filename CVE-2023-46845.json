{
  "id": "CVE-2023-46845",
  "sourceIdentifier": "vultures@jpcert.or.jp",
  "published": "2023-11-07T08:15:24.257",
  "lastModified": "2024-11-21T08:29:24.673",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "EC-CUBE 3 series (3.0.0 to 3.0.18-p6) and 4 series (4.0.0 to 4.0.6-p3, 4.1.0 to 4.1.2-p2, and 4.2.0 to 4.2.2) contain an arbitrary code execution vulnerability due to improper settings of the template engine Twig included in the product. As a result, arbitrary code may be executed on the server where the product is running by a user with an administrative privilege."
    },
    {
      "lang": "es",
      "value": "EC-CUBE series 3 (3.0.0 a 3.0.18-p6) y 4 (4.0.0 a 4.0.6-p3, 4.1.0 a 4.1.2-p2 y 4.2.0 a 4.2.2) contienen una vulnerabilidad de ejecuci贸n de c贸digo arbitrario debido a una configuraci贸n incorrecta del motor de plantillas Twig incluido en el producto. Como resultado, un usuario con privilegios administrativos puede ejecutar c贸digo arbitrario en el servidor donde se ejecuta el producto."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.2,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.2,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.0.0",
              "versionEndIncluding": "3.0.18",
              "matchCriteriaId": "82CF44DC-7824-4C6E-BA58-1B5C929EA7FF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0.0",
              "versionEndIncluding": "4.0.6",
              "matchCriteriaId": "DD2386CF-AA07-447D-AEA2-7C8202844E3E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.1.0",
              "versionEndIncluding": "4.1.2",
              "matchCriteriaId": "2482369B-5D65-4C5C-BABE-40AE3ADF2DBE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.2.0",
              "versionEndExcluding": "4.2.3",
              "matchCriteriaId": "DADE1F31-F4D6-4324-9FF7-AB4C1110A85C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p1:*:*:*:*:*:*",
              "matchCriteriaId": "10F6D9C1-B4F3-44D8-B266-787DA62228E2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p2:*:*:*:*:*:*",
              "matchCriteriaId": "B10AA450-F786-4AFD-9F26-9B2E2D57C5C2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p3:*:*:*:*:*:*",
              "matchCriteriaId": "8D30A28C-609A-4B6F-B257-7A577133A9FE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p4:*:*:*:*:*:*",
              "matchCriteriaId": "7530D411-D883-48E4-8D3F-6E6AEF7398E8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p5:*:*:*:*:*:*",
              "matchCriteriaId": "EC24B844-49C6-48EB-ADE1-4E8B2FA1B230"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:3.0.18:p6:*:*:*:*:*:*",
              "matchCriteriaId": "173CA606-87CA-4DDE-AD20-3F0D0CC75BF4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:4.0.6:p1:*:*:*:*:*:*",
              "matchCriteriaId": "56A84599-1C39-4B65-8256-CE5DE240CF61"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:4.0.6:p2:*:*:*:*:*:*",
              "matchCriteriaId": "EC0D4970-06C7-49D7-B249-7ECA1FCF770E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:4.0.6:p3:*:*:*:*:*:*",
              "matchCriteriaId": "7C5C8CCA-12BA-4EE3-8B12-C3D82D89C886"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:4.1.2:p1:*:*:*:*:*:*",
              "matchCriteriaId": "77DCDC1E-072D-4859-AD9D-1F1547A5C7BB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ec-cube:ec-cube:4.1.2:p2:*:*:*:*:*:*",
              "matchCriteriaId": "833340A1-0C34-4FE6-9820-CBCA7F3DC96C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://jvn.jp/en/jp/JVN29195731/",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index.php",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index_3.php",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index_40.php",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jvn.jp/en/jp/JVN29195731/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index_3.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.ec-cube.net/info/weakness/20231026/index_40.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}