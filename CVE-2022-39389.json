{
  "id": "CVE-2022-39389",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-11-17T22:15:10.547",
  "lastModified": "2024-11-21T07:18:11.677",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Lightning Network Daemon (lnd) is an implementation of a lightning bitcoin overlay network node. All lnd nodes before version `v0.15.4` are vulnerable to a block parsing bug that can cause a node to enter a degraded state once encountered. In this degraded state, nodes can continue to make payments and forward HTLCs, and close out channels. Opening channels is prohibited, and also on chain transaction events will be undetected. This can cause loss of funds if a CSV expiry is researched during a breach attempt or a CLTV delta expires forgetting the funds in the HTLC. A patch is available in `lnd` version 0.15.4. Users are advised to upgrade. Users unable to upgrade may use the `lncli updatechanpolicy` RPC call to increase their CLTV value to a very high amount or increase their fee policies. This will prevent nodes from routing through your node, meaning that no pending HTLCs can be present."
    },
    {
      "lang": "es",
      "value": "Lightning Network Daemon (lnd) es una implementación de un nodo de red superpuesto de bitcoin relámpago. Todos los nodos lnd anteriores a la versión `v0.15.4` son vulnerables a un error de análisis de bloques que puede hacer que un nodo entre en un estado degradado una vez encontrado. En este estado degradado, los nodos pueden continuar realizando pagos y reenviando HTLC y cerrar canales. Está prohibido abrir canales y tampoco se detectarán eventos de transacciones en cadena. Esto puede provocar la pérdida de fondos si se investiga el vencimiento de un CSV durante un intento de infracción o si un delta de CLTV expira olvidándose de los fondos en el HTLC. Hay un parche disponible en la versión 0.15.4 de `lnd`. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar pueden usar la llamada RPC `lncli updatechanpolicy` para aumentar su valor CLTV a una cantidad muy alta o aumentar sus políticas de tarifas. Esto evitará que los nodos se enruten a través de su nodo, lo que significa que no puede haber ningún HTLC pendiente."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
          "baseScore": 8.2,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 2.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:btcd_project:btcd:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.23.3",
              "matchCriteriaId": "4C76213E-2BE3-4BF3-B5D1-2AA9B6BB0A95"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.15.4",
              "matchCriteriaId": "E4F9DC3C-AC0A-472A-B74E-2966F1B7D3A9"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/lightningnetwork/lnd/issues/7096",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/pull/7098",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/issues/7096",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/pull/7098",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}