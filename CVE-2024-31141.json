{
  "id": "CVE-2024-31141",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-11-19T09:15:03.860",
  "lastModified": "2025-07-15T16:42:34.387",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Files or Directories Accessible to External Parties, Improper Privilege Management vulnerability in Apache Kafka Clients.\n\nApache Kafka Clients accept configuration data for customizing behavior, and includes ConfigProvider plugins in order to manipulate these configurations. Apache Kafka also provides FileConfigProvider, DirectoryConfigProvider, and EnvVarConfigProvider implementations which include the ability to read from disk or environment variables.\nIn applications where Apache Kafka Clients configurations can be specified by an untrusted party, attackers may use these ConfigProviders to read arbitrary contents of the disk and environment variables.\n\nIn particular, this flaw may be used in Apache Kafka Connect to escalate from REST API access to filesystem/environment access, which may be undesirable in certain environments, including SaaS products.\nThis issue affects Apache Kafka Clients: from 2.3.0 through 3.5.2, 3.6.2, 3.7.0.\n\n\nUsers with affected applications are recommended to upgrade kafka-clients to version >=3.8.0, and set the JVM system property \"org.apache.kafka.automatic.config.providers=none\".\nUsers of Kafka Connect with one of the listed ConfigProvider implementations specified in their worker config are also recommended to add appropriate \"allowlist.pattern\" and \"allowed.paths\" to restrict their operation to appropriate bounds.\n\n\nFor users of Kafka Clients or Kafka Connect in environments that trust users with disk and environment variable access, it is not recommended to set the system property.\nFor users of the Kafka Broker, Kafka MirrorMaker 2.0, Kafka Streams, and Kafka command-line tools, it is not recommended to set the system property."
    },
    {
      "lang": "es",
      "value": "Archivos o directorios accesibles para terceros, vulnerabilidad de administración incorrecta de privilegios en clientes Apache Kafka. Los clientes Apache Kafka aceptan datos de configuración para personalizar el comportamiento e incluyen complementos ConfigProvider para manipular estas configuraciones. Apache Kafka también proporciona implementaciones FileConfigProvider, DirectoryConfigProvider y EnvVarConfigProvider que incluyen la capacidad de leer desde el disco o variables de entorno. En aplicaciones donde las configuraciones de los clientes Apache Kafka pueden ser especificadas por un tercero que no es de confianza, los atacantes pueden usar estos ConfigProviders para leer contenido arbitrario del disco y las variables de entorno. En particular, esta falla puede usarse en Apache Kafka Connect para escalar desde el acceso a la API REST al acceso al sistema de archivos/entorno, lo que puede ser indeseable en ciertos entornos, incluidos los productos SaaS. Este problema afecta a los clientes Apache Kafka: desde 2.3.0 hasta 3.5.2, 3.6.2, 3.7.0. Se recomienda a los usuarios con aplicaciones afectadas que actualicen los clientes de Kafka a la versión &gt;=3.8.0 y configuren la propiedad del sistema JVM \"org.apache.kafka.automatic.config.providers=none\". También se recomienda a los usuarios de Kafka Connect con una de las implementaciones de ConfigProvider enumeradas en la configuración de su trabajador que agreguen \"allowlist.pattern\" y \"allowed.paths\" adecuados para restringir su funcionamiento a los límites adecuados. Para los usuarios de Kafka Clients o Kafka Connect en entornos que confían a los usuarios el acceso a discos y variables de entorno, no se recomienda configurar la propiedad del sistema. Para los usuarios de Kafka Broker, Kafka MirrorMaker 2.0, Kafka Streams y las herramientas de línea de comandos de Kafka, no se recomienda configurar la propiedad del sistema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        },
        {
          "lang": "en",
          "value": "CWE-552"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:kafka:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.3.0",
              "versionEndIncluding": "3.5.2",
              "matchCriteriaId": "1447B938-5E30-41D0-B541-E41BBC9D6A1D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:kafka:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.6.0",
              "versionEndIncluding": "3.6.2",
              "matchCriteriaId": "90EFBD89-C965-46CC-BB28-A11EE7C94C9A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:kafka:3.7.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "A3FCE14A-5AAE-4BD0-BF61-6EDFCF3F1723"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.apache.org/thread/9whdzfr0zwdhr364604w5ssnzmg4v2lv",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/11/18/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20250131-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}