{
  "id": "CVE-2021-21480",
  "sourceIdentifier": "cna@sap.com",
  "published": "2021-03-09T15:15:14.617",
  "lastModified": "2025-05-05T17:16:58.420",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code in the request and forward to server. When this dashboard is opened by users having at least SAP_XMII Developer role, malicious content in the dashboard gets executed, leading to remote code execution in the server, which allows privilege escalation. The malicious JSP code can contain certain OS commands, through which an attacker can read sensitive files in the server, modify files or even delete contents in the server thus compromising the confidentiality, integrity and availability of the server hosting the SAP MII application. Also, an attacker authenticated as a developer can use the application to upload and execute a file which will permit them to execute operating systems commands completely compromising the server hosting the application."
    },
    {
      "lang": "es",
      "value": "SAP MII permite a los usuarios crear cuadros de mando y guardarlos como JSP a través del SSCE (Self Service Composition Environment). Un atacante puede interceptar una petición al servidor, inyectar código JSP malicioso en la petición y reenviarlo al servidor. Cuando este tablero es abierto por usuarios que tienen al menos el rol de Desarrollador SAP_XMII, el contenido malicioso en el tablero se ejecuta, llevando a la ejecución remota de código en el servidor, lo que permite la escalada de privilegios. El código JSP malicioso puede contener ciertos comandos del sistema operativo, a través de los cuales un atacante puede leer archivos sensibles en el servidor, modificar archivos o incluso eliminar contenidos en el servidor, comprometiendo así la confidencialidad, integridad y disponibilidad del servidor que aloja la aplicación SAP MII. Además, un atacante autentificado como desarrollador puede utilizar la aplicación para cargar y ejecutar un archivo que le permitirá ejecutar comandos del sistema operativo comprometiendo completamente el servidor que aloja la aplicación"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV30": [
      {
        "source": "cna@sap.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "baseScore": 9.9,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 6.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C",
          "baseScore": 9.0,
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE"
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.0,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "514BCD2F-7F64-4504-80CD-808DC67514FC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "C174EF57-E203-46A0-B3CE-B88B86FA8507"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "8F817C07-FDB1-4331-99CA-AD3B41A49BA3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "35ED3A3F-D139-4E4A-AF1D-550692883CCC"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html",
      "source": "cna@sap.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2021/Jun/30",
      "source": "cna@sap.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://launchpad.support.sap.com/#/notes/3022622",
      "source": "cna@sap.com",
      "tags": [
        "Permissions Required",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107",
      "source": "cna@sap.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html",
      "source": "cna@sap.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2021/Jun/30",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://launchpad.support.sap.com/#/notes/3022622",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}